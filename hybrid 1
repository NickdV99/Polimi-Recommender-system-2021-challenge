{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "88ea0d9b",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:45.941748Z",
     "iopub.status.busy": "2022-01-07T10:10:45.941117Z",
     "iopub.status.idle": "2022-01-07T10:10:49.730404Z",
     "shell.execute_reply": "2022-01-07T10:10:49.731162Z"
    },
    "papermill": {
     "duration": 3.823592,
     "end_time": "2022-01-07T10:10:49.731482",
     "exception": false,
     "start_time": "2022-01-07T10:10:45.907890",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_train.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_ICM_event.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_ICM_subgenre.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/alg_sample_submission.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_ICM_genre.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_target_users_test.csv\n",
      "/kaggle/input/recommender-system-2021-challenge-polimi/data_ICM_channel.csv\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/run_all_algorithms.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra - Cython for KNN similarity.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 5 - Implicit feedback recommender.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 04 - Collaborative Filtering.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 02 - How to build a recommender.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/cython_example_FunkSVD.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 03 - Content Based Filtering.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/.gitignore\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 6 - Using different learning schedules.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Basics-2-Numpy.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/README.md\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 4 - Quickstart LightFM.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 12 - Hybrid recommenders.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 08 - MF IALS.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 8 - XGBoost basics.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Basics-3-Scipy.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/run_hyperparameter_search.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 3 - Hybrid model with LightFM.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/cython_example_SLIM_MSE.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 08b - MF PureSVD NMF.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 09 - Hyperparameter optimization with Skopt.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 05 - Recap - Building an ItemKNN from scratch.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 13 - Collaborative Boosted FW.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/requirements.txt\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 06 - SLIM MSE with Gradient Descent and Cython.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/run_test_recommenders.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 07 - MF FunkSVD with Cython.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 09 - BPR for SLIM and MF.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 14 - Hybrid model with LightFM on ML.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Basics-1-Introduction-to-Python-Programming.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/run_compile_all_cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 2 - SGD based Learning for Factorization Machines.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 09-old - SLIM BPR and SLIM EN.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice 11 - MF with PyTorch.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Practice extra 7 - WARP loss with LightFM.ipynb\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DataSplitter_Holdout.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DataSplitter.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DatasetMapperManager.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/data_consistency_check.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/README.md\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/TagPreprocessing.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DataReader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DataReader_utils.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/IncrementalSparseMatrix.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/run_clean_split_data_files.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Dataset.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/DataSplitter_leave_k_out.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/__init__.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/split_functions/split_train_validation_leave_k_out.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/split_functions/split_train_validation_cold_items.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/split_functions/split_train_validation_random_holdout.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/Movielens10MReader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/Movielens1MReader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/Movielens100KReader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/MovielensHetrec2011Reader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/_utils_movielens_parser.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Data_manager/Movielens/Movielens20MReader.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Utils/seconds_to_biggest_unit.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/20161219_BPR.pptx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/Amazon AWS.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/hu_koren_volinsky.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/2017_MF.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/FM.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/rendle_bpr.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/2017_MF.pptx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/Introduction and Materials for RecSys Practice Sessions.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/List_of_KNN_similarity_heuristics.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/Sparse matrices.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/koren_sdv++.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/slides/FunkSVD - 2006.pdf\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython_SLOW.cpython-36m-x86_64-linux-gnu.so\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython_SLOW.c\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/compileCython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Compute_Similarity_Python.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython.c\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython.cpython-36m-x86_64-linux-gnu.so\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython_SLOW.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Notebooks_utils/Cosine_Similarity_Cython_SLOW.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/CythonCompiler/compile_script.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/CythonCompiler/run_compile_subprocess.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/IR_feature_weighting.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Incremental_Training_Early_Stopping.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/BaseMatrixFactorizationRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/BaseRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/BaseCBFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Recommender_import_list.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/BaseTempFolder.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Recommender_utils.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/NonPersonalizedRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/BaseSimilarityMatrixRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/DataIO.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/PredefinedListRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Compute_similarity_euclidean_test.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Compute_Similarity_Euclidean.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Compute_Similarity_Python.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Compute_Similarity.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Compute_similarity_test.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Similarity/Cython/Compute_Similarity_Cython.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/EASE_R/EASE_R_Recommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/SLIMElasticNetRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/SLIM_BPR_Python.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/Cython/SLIM_BPR_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/Cython/Sparse_Matrix_Tree_CSR.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/Cython/Triangular_Matrix.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/SLIM/Cython/SLIM_BPR_Cython_Epoch.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/GraphBased/RP3betaRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/GraphBased/P3alphaRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FactorizationMachines/LightFMRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/ItemKNNCustomSimilarityRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/ItemKNNCBFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/ItemKNNSimilarityHybridRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/UserKNNCBFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/ItemKNNCFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/UserKNN_CFCBF_Hybrid_Recommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/ItemKNN_CFCBF_Hybrid_Recommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/KNN/UserKNNCFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Neural/architecture_utils.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/Neural/MultVAERecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/CFW_D_Similarity_Linalg.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/CFW_DVV_Similarity_Cython_SGD.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/FBSM_Rating_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/HP3_Similarity_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/CFW_D_Similarity_Cython_SGD.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/CFW_D_Similarity_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/FBSM_Rating_Cython_SGD.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/HP3_Similarity_Cython_SGD.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/FeatureWeighting/Cython/CFW_DVV_Similarity_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/IALSRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/NMFRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/PureSVDRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/SVDFeatureRecommender.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/PyTorch/MF_MSE_PyTorch.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/PyTorch/MF_MSE_PyTorch_model.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/Cython/MatrixFactorization_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/Cython/MatrixFactorizationImpressions_Cython.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/Cython/MatrixFactorizationImpressions_Cython_Epoch.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Recommenders/MatrixFactorization/Cython/MatrixFactorization_Cython_Epoch.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/random_random_everywhere_meme.jpg\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/ive_already_seen_it_meme.png\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/bob_example.jpeg\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/hstack_example.png\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/FactorizationMachine.png\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/ive_evaluated_your_performance_meme.jpg\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/amongus_meme.png\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/toy_story_poster.png\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/images/better_than_average_on_the_first_try_meme.jpg\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/HyperparameterTuning/SearchSingleCase.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/HyperparameterTuning/SearchAbstractClass.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/HyperparameterTuning/run_hyperparameter_search.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/HyperparameterTuning/SearchBayesianSkopt.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime_slow.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/SLIM_MSE_fastest.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime_nochecks.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/SLIM_MSE_slow.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime_nochecks.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/FunkSVD_fastest.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/FunkSVD_slow.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/SLIM_MSE_slow.pyx\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/isPrime_slow.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/SLIM_MSE_fastest.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/FunkSVD_fastest.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Cython_examples/FunkSVD_slow.html\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Evaluation/metrics.py\n",
      "/kaggle/input/recsys/RecSys_Course_AT_PoliMi-master/Evaluation/Evaluator.py\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "!cp -r ../input/recsys/RecSys_Course_AT_PoliMi-master/* ./\n",
    "\n",
    "import os\n",
    "from typing import Tuple, Callable, Dict, Optional, List\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import scipy.sparse as sp\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from skopt.space import Real, Integer, Categorical\n",
    "\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fad81b47",
   "metadata": {
    "papermill": {
     "duration": 0.019313,
     "end_time": "2022-01-07T10:10:49.771853",
     "exception": false,
     "start_time": "2022-01-07T10:10:49.752540",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**PREPARING DATA**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "bec5f079",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:49.818507Z",
     "iopub.status.busy": "2022-01-07T10:10:49.817875Z",
     "iopub.status.idle": "2022-01-07T10:10:51.561557Z",
     "shell.execute_reply": "2022-01-07T10:10:51.560651Z"
    },
    "papermill": {
     "duration": 1.770126,
     "end_time": "2022-01-07T10:10:51.561713",
     "exception": false,
     "start_time": "2022-01-07T10:10:49.791587",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def load_data():\n",
    "  return pd.read_csv(\n",
    "      \"../input/recommender-system-2021-challenge-polimi/data_train.csv\",\n",
    "      sep=\",\",\n",
    "      header=0,\n",
    "      names=[\"user\", \"item\", \"interaction\"],\n",
    "       dtype={\"user\": np.int32,\n",
    "              \"item\": np.int32,\n",
    "              \"interaction\": np.int32}\n",
    "    )\n",
    "\n",
    "ratings = load_data()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d60f486b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:51.622695Z",
     "iopub.status.busy": "2022-01-07T10:10:51.622045Z",
     "iopub.status.idle": "2022-01-07T10:10:53.178106Z",
     "shell.execute_reply": "2022-01-07T10:10:53.177487Z"
    },
    "papermill": {
     "duration": 1.594895,
     "end_time": "2022-01-07T10:10:53.178247",
     "exception": false,
     "start_time": "2022-01-07T10:10:51.583352",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def dataset_split(ratings, num_users, num_items, val_percentage: float):\n",
    "    seed = 42\n",
    "    \n",
    "    (user_ids_training, user_ids_validation,\n",
    "    item_ids_training, item_ids_validation,\n",
    "    ratings_training, ratings_validation) = train_test_split(ratings['user'],\n",
    "                                                            ratings['item'],\n",
    "                                                            ratings['interaction'],\n",
    "                                                            test_size = val_percentage)\n",
    "    \n",
    "    urm_train = sp.csr_matrix((ratings_training,\n",
    "                               (user_ids_training, item_ids_training)),\n",
    "                             shape=(num_users, num_items), dtype=np.double)\n",
    "    \n",
    "    urm_validation = sp.csr_matrix((ratings_validation,\n",
    "                                   (user_ids_validation, item_ids_validation)),\n",
    "                                  shape=(num_users, num_items), dtype=np.double)\n",
    "    \n",
    "    return urm_train, urm_validation\n",
    "\n",
    "num_users = len(np.unique(ratings['user']))\n",
    "num_items = len(np.unique(ratings['item']))\n",
    "urm_train, urm_validation = dataset_split(ratings, num_users, num_items, 0.15)\n",
    "urm_train_validation = urm_train + urm_validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b677e028",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:53.224422Z",
     "iopub.status.busy": "2022-01-07T10:10:53.223802Z",
     "iopub.status.idle": "2022-01-07T10:10:53.243958Z",
     "shell.execute_reply": "2022-01-07T10:10:53.243410Z"
    },
    "papermill": {
     "duration": 0.045791,
     "end_time": "2022-01-07T10:10:53.244104",
     "exception": false,
     "start_time": "2022-01-07T10:10:53.198313",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "genres = pd.read_csv(\n",
    "    \"../input/recommender-system-2021-challenge-polimi/data_ICM_genre.csv\",\n",
    "    sep=\",\",\n",
    "    header=0,\n",
    "    names=[\"item\", \"feature\", \"data\"],\n",
    "    dtype={\"item\": np.int32,\n",
    "           \"feature\": np.int32,\n",
    "           \"data\": np.int32}\n",
    "    )\n",
    "\n",
    "num_features = len(np.unique(genres['feature']))\n",
    "\n",
    "icm_genre = sp.csr_matrix((genres[\"data\"], \n",
    "                          (genres[\"item\"], genres[\"feature\"])), \n",
    "                          shape=(num_items, num_features), dtype=np.double)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4fb98034",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:53.291596Z",
     "iopub.status.busy": "2022-01-07T10:10:53.290883Z",
     "iopub.status.idle": "2022-01-07T10:10:53.310427Z",
     "shell.execute_reply": "2022-01-07T10:10:53.309877Z"
    },
    "papermill": {
     "duration": 0.04588,
     "end_time": "2022-01-07T10:10:53.310597",
     "exception": false,
     "start_time": "2022-01-07T10:10:53.264717",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "subgenres = pd.read_csv(\n",
    "    \"../input/recommender-system-2021-challenge-polimi/data_ICM_subgenre.csv\",\n",
    "    sep=\",\",\n",
    "    header=0,\n",
    "    names=[\"item\", \"feature\", \"data\"],\n",
    "    dtype={\"item\": np.int32,\n",
    "           \"feature\": np.int32,\n",
    "           \"data\": np.int32}\n",
    "    )\n",
    "\n",
    "num_features = len(np.unique(subgenres['feature']))\n",
    "\n",
    "icm_subgenre = sp.csr_matrix((subgenres['data'], \n",
    "                          (subgenres['item'], subgenres['feature'])), \n",
    "                          shape=(num_items, num_features), dtype=np.double)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "5c790c44",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:53.354917Z",
     "iopub.status.busy": "2022-01-07T10:10:53.354295Z",
     "iopub.status.idle": "2022-01-07T10:10:53.378706Z",
     "shell.execute_reply": "2022-01-07T10:10:53.379395Z"
    },
    "papermill": {
     "duration": 0.048825,
     "end_time": "2022-01-07T10:10:53.379618",
     "exception": false,
     "start_time": "2022-01-07T10:10:53.330793",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "channels = pd.read_csv(\n",
    "    \"../input/recommender-system-2021-challenge-polimi/data_ICM_channel.csv\",\n",
    "    sep=\",\",\n",
    "    header=0,\n",
    "    names=[\"item\", \"feature\", \"data\"],\n",
    "    dtype={\"item\": np.int32,\n",
    "           \"feature\": np.int32,\n",
    "           \"data\": np.int32}\n",
    "    )\n",
    "\n",
    "num_features = len(np.unique(channels['feature']))\n",
    "\n",
    "icm_channel = sp.csr_matrix((channels['data'], \n",
    "                          (channels['item'], channels['feature'])), \n",
    "                          shape=(num_items, num_features), dtype=np.double )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7909e158",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:53.422843Z",
     "iopub.status.busy": "2022-01-07T10:10:53.422191Z",
     "iopub.status.idle": "2022-01-07T10:10:53.960786Z",
     "shell.execute_reply": "2022-01-07T10:10:53.960266Z"
    },
    "papermill": {
     "duration": 0.561219,
     "end_time": "2022-01-07T10:10:53.960928",
     "exception": false,
     "start_time": "2022-01-07T10:10:53.399709",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Unique feature_id in the URM are 347825\n"
     ]
    }
   ],
   "source": [
    "episodes = pd.read_csv(\n",
    "    \"../input/recommender-system-2021-challenge-polimi/data_ICM_event.csv\",\n",
    "    sep=\",\",\n",
    "    header=0,\n",
    "    names=[\"item\", \"feature\", \"data\"],\n",
    "    dtype={\"item\": np.int32,\n",
    "           \"feature\": np.int32,\n",
    "           \"data\": np.int32}\n",
    "    )\n",
    "num_features = len(np.unique(episodes['feature']))\n",
    "\n",
    "feature_original_ID_to_index_dict = {}\n",
    "\n",
    "for feature_id in episodes[\"feature\"].unique():\n",
    "    feature_original_ID_to_index_dict[feature_id] = len(feature_original_ID_to_index_dict)\n",
    "\n",
    "print(\"Unique feature_id in the URM are {}\".format(len(feature_original_ID_to_index_dict)))\n",
    "\n",
    "episodes[\"feature\"] = [feature_original_ID_to_index_dict[feature_original] for feature_original in\n",
    "                                      episodes[\"feature\"].values]\n",
    "\n",
    "ICM_episodes = sp.csr_matrix((episodes['data'], \n",
    "                          (episodes['item'], episodes['feature'])), \n",
    "                          shape=(num_items, num_features), dtype=np.double )\n",
    "\n",
    "episodes_per_item = np.ediff1d(ICM_episodes.indptr)\n",
    "\n",
    "def normalizeData(data):\n",
    "    return (data - np.min(data)) / (np.max(data) - np.min(data))\n",
    "\n",
    "episodes_per_item_norm = normalizeData(episodes_per_item)\n",
    "\n",
    "item_ids = []\n",
    "episodes_per_item_new = episodes_per_item_norm.copy()\n",
    "i = 0\n",
    "deleted_items = 0\n",
    "for item in episodes_per_item_norm:\n",
    "    if(item != 0):\n",
    "        item_ids.append(i)\n",
    "        i = i+1\n",
    "    elif(item == 0):\n",
    "        episodes_per_item_new = np.delete(episodes_per_item_new, i)\n",
    "        deleted_items = deleted_items + 1\n",
    "        \n",
    "        \n",
    "feature_id = [0] * len(episodes_per_item_new)\n",
    "\n",
    "icm_num_episodes = sp.csr_matrix((episodes_per_item_new, \n",
    "                          (item_ids, feature_id)), \n",
    "                          shape=(num_items, 1), dtype=np.double)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "da5558db",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:54.007655Z",
     "iopub.status.busy": "2022-01-07T10:10:54.007005Z",
     "iopub.status.idle": "2022-01-07T10:10:54.013153Z",
     "shell.execute_reply": "2022-01-07T10:10:54.012659Z"
    },
    "papermill": {
     "duration": 0.031847,
     "end_time": "2022-01-07T10:10:54.013295",
     "exception": false,
     "start_time": "2022-01-07T10:10:53.981448",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "icm_stacked_all = (sp.vstack([icm_genre.T, icm_subgenre.T, icm_channel.T, icm_num_episodes.T])).T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e303ab8c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:54.064168Z",
     "iopub.status.busy": "2022-01-07T10:10:54.063167Z",
     "iopub.status.idle": "2022-01-07T10:10:54.125924Z",
     "shell.execute_reply": "2022-01-07T10:10:54.125201Z"
    },
    "papermill": {
     "duration": 0.091035,
     "end_time": "2022-01-07T10:10:54.126093",
     "exception": false,
     "start_time": "2022-01-07T10:10:54.035058",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "EvaluatorHoldout: Ignoring 13637 ( 0.1%) Users that have less than 1 test interactions\n"
     ]
    }
   ],
   "source": [
    "from Evaluation.Evaluator import EvaluatorHoldout\n",
    "\n",
    "cutoff_list=[10]\n",
    "\n",
    "evaluator_validation = EvaluatorHoldout(urm_validation, cutoff_list=cutoff_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d4f41cb0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:10:54.181432Z",
     "iopub.status.busy": "2022-01-07T10:10:54.173784Z",
     "iopub.status.idle": "2022-01-07T10:13:41.678345Z",
     "shell.execute_reply": "2022-01-07T10:13:41.677815Z"
    },
    "papermill": {
     "duration": 167.530799,
     "end_time": "2022-01-07T10:13:41.678530",
     "exception": false,
     "start_time": "2022-01-07T10:10:54.147731",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "run_compile_all_cython: Found 10 Cython files in 4 folders...\r\n",
      "run_compile_all_cython: All files will be compiled using your current python environment: '/opt/conda/bin/python'\r\n",
      "Compiling [1/10]: MatrixFactorizationImpressions_Cython_Epoch.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_f_43MatrixFactorizationImpressions_Cython_Epoch_32MatrixFactorization_Cython_Epoch_sampleBPR_Cython\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:12608:17:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_start_pos_impression_items\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      "12608 |       \u001b[01;35m\u001b[K__pyx_t_4 = (__pyx_v_start_pos_impression_items + __pyx_v_index)\u001b[m\u001b[K;\r\n",
      "      |       \u001b[01;35m\u001b[K~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_pf_43MatrixFactorizationImpressions_Cython_Epoch_32MatrixFactorization_Cython_Epoch_10epochIteration_Cython_ASY_SVD_SGD\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:8586:7:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_end_pos_seen_items\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 8586 |       \u001b[01;35m\u001b[Kfor\u001b[m\u001b[K (__pyx_t_19 = __pyx_v_start_pos_seen_items; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {\r\n",
      "      |       \u001b[01;35m\u001b[K^~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KMatrixFactorizationImpressions_Cython_Epoch.c:8586:7:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_start_pos_seen_items\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/MatrixFactorization/Cython/MatrixFactorizationImpressions_Cython_Epoch.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [1/10]: MatrixFactorizationImpressions_Cython_Epoch.pyx... PASS\r\n",
      "\r\n",
      "Compiling [2/10]: MatrixFactorization_Cython_Epoch.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KMatrixFactorization_Cython_Epoch.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KMatrixFactorization_Cython_Epoch.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_pf_32MatrixFactorization_Cython_Epoch_32MatrixFactorization_Cython_Epoch_10epochIteration_Cython_ASY_SVD_SGD\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KMatrixFactorization_Cython_Epoch.c:8519:9:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_end_pos_seen_items\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 8519 |         \u001b[01;35m\u001b[Kfor\u001b[m\u001b[K (__pyx_t_19 = __pyx_v_start_pos_seen_items; __pyx_t_19 < __pyx_t_18; __pyx_t_19+=1) {\r\n",
      "      |         \u001b[01;35m\u001b[K^~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KMatrixFactorization_Cython_Epoch.c:8519:9:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_start_pos_seen_items\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/MatrixFactorization/Cython/MatrixFactorization_Cython_Epoch.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [2/10]: MatrixFactorization_Cython_Epoch.pyx... PASS\r\n",
      "\r\n",
      "Compiling [3/10]: Compute_Similarity_Cython.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KCompute_Similarity_Cython.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/Similarity/Cython/Compute_Similarity_Cython.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [3/10]: Compute_Similarity_Cython.pyx... PASS\r\n",
      "\r\n",
      "Compiling [4/10]: SLIM_BPR_Cython_Epoch.pyx... \r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:633:34: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:633:66: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:818:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:818:52: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:69: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1052:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1052:42: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1053:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1053:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KSLIM_BPR_Cython_Epoch.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KSLIM_BPR_Cython_Epoch.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_f_21SLIM_BPR_Cython_Epoch_22Sparse_Matrix_Tree_CSR_test_list_tee_conversion\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KSLIM_BPR_Cython_Epoch.c:10691:15:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_previous_element\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      "10691 |     \u001b[01;35m\u001b[K__pyx_t_7 = __pyx_v_current_element->lower\u001b[m\u001b[K;\r\n",
      "      |     \u001b[01;35m\u001b[K~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/SLIM/Cython/SLIM_BPR_Cython_Epoch.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:633:34: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:633:66: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:818:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:818:52: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:917:69: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1052:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1052:42: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1053:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: SLIM_BPR_Cython_Epoch.pyx:1053:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "Compiling [4/10]: SLIM_BPR_Cython_Epoch.pyx... PASS\r\n",
      "\r\n",
      "Compiling [5/10]: Triangular_Matrix.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KTriangular_Matrix.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/SLIM/Cython/Triangular_Matrix.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [5/10]: Triangular_Matrix.pyx... PASS\r\n",
      "\r\n",
      "Compiling [6/10]: Sparse_Matrix_Tree_CSR.pyx... \r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:132:34: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:132:66: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:343:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:343:52: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:69: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:577:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:577:42: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:578:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:578:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KSparse_Matrix_Tree_CSR.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KSparse_Matrix_Tree_CSR.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_f_22Sparse_Matrix_Tree_CSR_22Sparse_Matrix_Tree_CSR_test_list_tree_conversion\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KSparse_Matrix_Tree_CSR.c:5696:15:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_previous_element\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 5696 |     \u001b[01;35m\u001b[K__pyx_t_7 = __pyx_v_current_element->lower\u001b[m\u001b[K;\r\n",
      "      |     \u001b[01;35m\u001b[K~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/SLIM/Cython/Sparse_Matrix_Tree_CSR.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:132:34: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:132:66: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:343:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:343:52: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:442:69: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:577:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:577:42: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:578:35: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "warning: Sparse_Matrix_Tree_CSR.pyx:578:53: Non-trivial type declarators in shared declaration (e.g. mix of pointers and values). Each pointer declaration should be on its own line.\r\n",
      "Compiling [6/10]: Sparse_Matrix_Tree_CSR.pyx... PASS\r\n",
      "\r\n",
      "Compiling [7/10]: FBSM_Rating_Cython_SGD.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KFBSM_Rating_Cython_SGD.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KFBSM_Rating_Cython_SGD.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_pf_22FBSM_Rating_Cython_SGD_22FBSM_Rating_Cython_SGD_2fit\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KFBSM_Rating_Cython_SGD.c:8875:55:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_num_sample\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 8875 |   __pyx_t_5 = PyFloat_FromDouble((__pyx_v_cum_loss / \u001b[01;35m\u001b[K((double)__pyx_v_num_sample)\u001b[m\u001b[K)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)\r\n",
      "      |                                                      \u001b[01;35m\u001b[K~^~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/FeatureWeighting/Cython/FBSM_Rating_Cython_SGD.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [7/10]: FBSM_Rating_Cython_SGD.pyx... PASS\r\n",
      "\r\n",
      "Compiling [8/10]: CFW_DVV_Similarity_Cython_SGD.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KCFW_DVV_Similarity_Cython_SGD.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/FeatureWeighting/Cython/CFW_DVV_Similarity_Cython_SGD.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [8/10]: CFW_DVV_Similarity_Cython_SGD.pyx... PASS\r\n",
      "\r\n",
      "Compiling [9/10]: HP3_Similarity_Cython_SGD.pyx... \r\n",
      "warning: HP3_Similarity_Cython_SGD.pyx:113:40: Index should be typed for more efficient access\r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KHP3_Similarity_Cython_SGD.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KHP3_Similarity_Cython_SGD.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_pf_25HP3_Similarity_Cython_SGD_25HP3_Similarity_Cython_SGD_4fit\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KHP3_Similarity_Cython_SGD.c:6147:55:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_sample_num\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 6147 |   __pyx_t_1 = PyFloat_FromDouble((__pyx_v_cum_loss / \u001b[01;35m\u001b[K((double)__pyx_v_sample_num)\u001b[m\u001b[K)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)\r\n",
      "      |                                                      \u001b[01;35m\u001b[K~^~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/FeatureWeighting/Cython/HP3_Similarity_Cython_SGD.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "warning: HP3_Similarity_Cython_SGD.pyx:113:40: Index should be typed for more efficient access\r\n",
      "Compiling [9/10]: HP3_Similarity_Cython_SGD.pyx... PASS\r\n",
      "\r\n",
      "Compiling [10/10]: CFW_D_Similarity_Cython_SGD.pyx... \r\n",
      "In file included from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4\u001b[m\u001b[K,\r\n",
      "                 from \u001b[01m\u001b[KCFW_D_Similarity_Cython_SGD.c:620\u001b[m\u001b[K:\r\n",
      "\u001b[01m\u001b[K/opt/conda/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K#warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [\u001b[01;35m\u001b[K-Wcpp\u001b[m\u001b[K]\r\n",
      "   17 | #\u001b[01;35m\u001b[Kwarning\u001b[m\u001b[K \"Using deprecated NumPy API, disable it with \" \\\r\n",
      "      |  \u001b[01;35m\u001b[K^~~~~~~\u001b[m\u001b[K\r\n",
      "\u001b[01m\u001b[KCFW_D_Similarity_Cython_SGD.c:\u001b[m\u001b[K In function ‘\u001b[01m\u001b[K__pyx_pf_27CFW_D_Similarity_Cython_SGD_27CFW_D_Similarity_Cython_SGD_6fit\u001b[m\u001b[K’:\r\n",
      "\u001b[01m\u001b[KCFW_D_Similarity_Cython_SGD.c:5900:55:\u001b[m\u001b[K \u001b[01;35m\u001b[Kwarning: \u001b[m\u001b[K‘\u001b[01m\u001b[K__pyx_v_sample_num\u001b[m\u001b[K’ may be used uninitialized in this function [\u001b[01;35m\u001b[K-Wmaybe-uninitialized\u001b[m\u001b[K]\r\n",
      " 5900 |   __pyx_t_3 = PyFloat_FromDouble((__pyx_v_cum_loss / \u001b[01;35m\u001b[K((double)__pyx_v_sample_num)\u001b[m\u001b[K)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)\r\n",
      "      |                                                      \u001b[01;35m\u001b[K~^~~~~~~~~~~~~~~~~~~~~~~~~~~\u001b[m\u001b[K\r\n",
      "/opt/conda/lib/python3.7/site-packages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now (Py2). This will change in a later release! File: /kaggle/working/Recommenders/FeatureWeighting/Cython/CFW_D_Similarity_Cython_SGD.pyx\r\n",
      "  tree = Parsing.p_module(s, pxd, full_module_name)\r\n",
      "Compiling [10/10]: CFW_D_Similarity_Cython_SGD.pyx... PASS\r\n",
      "\r\n",
      "run_compile_all_cython: Compilation finished. SUCCESS.\r\n",
      "Compilation log can be found here: './result_experiments/run_compile_all_cython.txt'\r\n"
     ]
    }
   ],
   "source": [
    "!python run_compile_all_cython.py\n",
    "%load_ext cython"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae034325",
   "metadata": {
    "papermill": {
     "duration": 0.035274,
     "end_time": "2022-01-07T10:13:41.746387",
     "exception": false,
     "start_time": "2022-01-07T10:13:41.711113",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    " *I recommender sono ordinati in ordine decrescente di MAP in locale*"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "95304208",
   "metadata": {
    "papermill": {
     "duration": 0.033905,
     "end_time": "2022-01-07T10:13:41.815532",
     "exception": false,
     "start_time": "2022-01-07T10:13:41.781627",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**SLIM ELASTIC NET** MAP(locale) = 0.19 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "fa713dd5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T10:13:41.887367Z",
     "iopub.status.busy": "2022-01-07T10:13:41.886649Z",
     "iopub.status.idle": "2022-01-07T11:32:09.669771Z",
     "shell.execute_reply": "2022-01-07T11:32:09.669087Z"
    },
    "papermill": {
     "duration": 4707.820041,
     "end_time": "2022-01-07T11:32:09.669946",
     "exception": false,
     "start_time": "2022-01-07T10:13:41.849905",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SLIMElasticNetRecommender: Processed 1159 ( 6.4%) in 5.00 min. Items per second: 3.86\n",
      "SLIMElasticNetRecommender: Processed 2307 (12.8%) in 10.00 min. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 3458 (19.1%) in 15.00 min. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 4607 (25.5%) in 20.00 min. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 5759 (31.9%) in 25.01 min. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 6924 (38.3%) in 30.01 min. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 8101 (44.9%) in 35.01 min. Items per second: 3.86\n",
      "SLIMElasticNetRecommender: Processed 9285 (51.4%) in 40.01 min. Items per second: 3.87\n",
      "SLIMElasticNetRecommender: Processed 10454 (57.9%) in 45.02 min. Items per second: 3.87\n",
      "SLIMElasticNetRecommender: Processed 11586 (64.2%) in 50.02 min. Items per second: 3.86\n",
      "SLIMElasticNetRecommender: Processed 12726 (70.5%) in 55.02 min. Items per second: 3.85\n",
      "SLIMElasticNetRecommender: Processed 13860 (76.7%) in 1.00 hour. Items per second: 3.85\n",
      "SLIMElasticNetRecommender: Processed 15001 (83.1%) in 1.08 hour. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 16146 (89.4%) in 1.17 hour. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 17284 (95.7%) in 1.25 hour. Items per second: 3.84\n",
      "SLIMElasticNetRecommender: Processed 18059 (100.0%) in 1.31 hour. Items per second: 3.84\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.Recommender_utils import check_matrix\n",
    "from sklearn.linear_model import ElasticNet\n",
    "from Recommenders.BaseSimilarityMatrixRecommender import BaseItemSimilarityMatrixRecommender\n",
    "from Utils.seconds_to_biggest_unit import seconds_to_biggest_unit\n",
    "import time, sys\n",
    "from tqdm import tqdm\n",
    "from sklearn.utils._testing import ignore_warnings\n",
    "from sklearn.exceptions import ConvergenceWarning\n",
    "\n",
    "class SLIMElasticNetRecommender(BaseItemSimilarityMatrixRecommender):\n",
    "    \"\"\"\n",
    "    Train a Sparse Linear Methods (SLIM) item similarity model.\n",
    "    NOTE: ElasticNet solver is parallel, a single intance of SLIM_ElasticNet will\n",
    "          make use of half the cores available\n",
    "\n",
    "    See:\n",
    "        Efficient Top-N Recommendation by Linear Regression,\n",
    "        M. Levy and K. Jack, LSRS workshop at RecSys 2013.\n",
    "\n",
    "        SLIM: Sparse linear methods for top-n recommender systems,\n",
    "        X. Ning and G. Karypis, ICDM 2011.\n",
    "        http://glaros.dtc.umn.edu/gkhome/fetch/papers/SLIM2011icdm.pdf\n",
    "    \"\"\"\n",
    "\n",
    "    RECOMMENDER_NAME = \"SLIMElasticNetRecommender\"\n",
    "\n",
    "    def __init__(self, URM_train, verbose = True):\n",
    "        super(SLIMElasticNetRecommender, self).__init__(URM_train, verbose = verbose)\n",
    "\n",
    "    @ignore_warnings(category=ConvergenceWarning)\n",
    "    def fit(self, l1_ratio=0.1, alpha = 1.0, positive_only=True, topK = 100):\n",
    "\n",
    "        assert l1_ratio>= 0 and l1_ratio<=1, \"{}: l1_ratio must be between 0 and 1, provided value was {}\".format(self.RECOMMENDER_NAME, l1_ratio)\n",
    "\n",
    "        self.l1_ratio = l1_ratio\n",
    "        self.positive_only = positive_only\n",
    "        self.topK = topK\n",
    "\n",
    "\n",
    "        # initialize the ElasticNet model\n",
    "        self.model = ElasticNet(alpha=alpha,\n",
    "                                l1_ratio=self.l1_ratio,\n",
    "                                positive=self.positive_only,\n",
    "                                fit_intercept=False,\n",
    "                                copy_X=False,\n",
    "                                precompute=True,\n",
    "                                selection='random',\n",
    "                                max_iter=100,\n",
    "                                tol=1e-4)\n",
    "\n",
    "        URM_train = check_matrix(self.URM_train, 'csc', dtype=np.float32)\n",
    "\n",
    "        n_items = URM_train.shape[1]\n",
    "\n",
    "        # Use array as it reduces memory requirements compared to lists\n",
    "        dataBlock = 10000000\n",
    "\n",
    "        rows = np.zeros(dataBlock, dtype=np.int32)\n",
    "        cols = np.zeros(dataBlock, dtype=np.int32)\n",
    "        values = np.zeros(dataBlock, dtype=np.float32)\n",
    "\n",
    "        numCells = 0\n",
    "\n",
    "        start_time = time.time()\n",
    "        start_time_printBatch = start_time\n",
    "\n",
    "        # fit each item's factors sequentially (not in parallel)\n",
    "        for currentItem in range(n_items):\n",
    "\n",
    "            # get the target column\n",
    "            y = URM_train[:, currentItem].toarray()\n",
    "\n",
    "            # set the j-th column of X to zero\n",
    "            start_pos = URM_train.indptr[currentItem]\n",
    "            end_pos = URM_train.indptr[currentItem + 1]\n",
    "\n",
    "            current_item_data_backup = URM_train.data[start_pos: end_pos].copy()\n",
    "            URM_train.data[start_pos: end_pos] = 0.0\n",
    "\n",
    "            # fit one ElasticNet model per column\n",
    "            self.model.fit(URM_train, y)\n",
    "\n",
    "            # self.model.coef_ contains the coefficient of the ElasticNet model\n",
    "            # let's keep only the non-zero values\n",
    "\n",
    "            # Select topK values\n",
    "            # Sorting is done in three steps. Faster then plain np.argsort for higher number of items\n",
    "            # - Partition the data to extract the set of relevant items\n",
    "            # - Sort only the relevant items\n",
    "            # - Get the original item index\n",
    "\n",
    "            nonzero_model_coef_index = self.model.sparse_coef_.indices\n",
    "            nonzero_model_coef_value = self.model.sparse_coef_.data\n",
    "\n",
    "            local_topK = min(len(nonzero_model_coef_value)-1, self.topK)\n",
    "\n",
    "            relevant_items_partition = (-nonzero_model_coef_value).argpartition(local_topK)[0:local_topK]\n",
    "            relevant_items_partition_sorting = np.argsort(-nonzero_model_coef_value[relevant_items_partition])\n",
    "            ranking = relevant_items_partition[relevant_items_partition_sorting]\n",
    "\n",
    "            for index in range(len(ranking)):\n",
    "\n",
    "                if numCells == len(rows):\n",
    "                    rows = np.concatenate((rows, np.zeros(dataBlock, dtype=np.int32)))\n",
    "                    cols = np.concatenate((cols, np.zeros(dataBlock, dtype=np.int32)))\n",
    "                    values = np.concatenate((values, np.zeros(dataBlock, dtype=np.float32)))\n",
    "\n",
    "\n",
    "                rows[numCells] = nonzero_model_coef_index[ranking[index]]\n",
    "                cols[numCells] = currentItem\n",
    "                values[numCells] = nonzero_model_coef_value[ranking[index]]\n",
    "\n",
    "                numCells += 1\n",
    "\n",
    "            # finally, replace the original values of the j-th column\n",
    "            URM_train.data[start_pos:end_pos] = current_item_data_backup\n",
    "\n",
    "            elapsed_time = time.time() - start_time\n",
    "            new_time_value, new_time_unit = seconds_to_biggest_unit(elapsed_time)\n",
    "\n",
    "\n",
    "            if time.time() - start_time_printBatch > 300 or currentItem == n_items-1:\n",
    "                self._print(\"Processed {} ({:4.1f}%) in {:.2f} {}. Items per second: {:.2f}\".format(\n",
    "                    currentItem+1,\n",
    "                    100.0* float(currentItem+1)/n_items,\n",
    "                    new_time_value,\n",
    "                    new_time_unit,\n",
    "                    float(currentItem)/elapsed_time))\n",
    "\n",
    "                sys.stdout.flush()\n",
    "                sys.stderr.flush()\n",
    "\n",
    "                start_time_printBatch = time.time()\n",
    "\n",
    "        # generate the sparse weight matrix\n",
    "        self.W_sparse = sp.csr_matrix((values[:numCells], (rows[:numCells], cols[:numCells])),\n",
    "                                       shape=(n_items, n_items), dtype=np.float32)\n",
    "\n",
    "        \n",
    "SLIMElasticNetRecommender = SLIMElasticNetRecommender(urm_train_validation) \n",
    "SLIMElasticNetRecommender.fit(topK = 485, l1_ratio = 0.01045990404597256, alpha = 0.02647334908199872\n",
    "                             )  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b9e8bc0b",
   "metadata": {
    "papermill": {
     "duration": 0.03686,
     "end_time": "2022-01-07T11:32:09.744271",
     "exception": false,
     "start_time": "2022-01-07T11:32:09.707411",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**IALS** MAP(locale) = 0.18 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "192be211",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T11:32:09.823328Z",
     "iopub.status.busy": "2022-01-07T11:32:09.822737Z",
     "iopub.status.idle": "2022-01-07T11:50:38.351727Z",
     "shell.execute_reply": "2022-01-07T11:50:38.350685Z"
    },
    "papermill": {
     "duration": 1108.568643,
     "end_time": "2022-01-07T11:50:38.352018",
     "exception": false,
     "start_time": "2022-01-07T11:32:09.783375",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "IALSRecommender: Epoch 1 of 75. Elapsed time 14.05 sec\n",
      "IALSRecommender: Epoch 2 of 75. Elapsed time 29.49 sec\n",
      "IALSRecommender: Epoch 3 of 75. Elapsed time 44.01 sec\n",
      "IALSRecommender: Epoch 4 of 75. Elapsed time 59.37 sec\n",
      "IALSRecommender: Epoch 5 of 75. Elapsed time 1.21 min\n",
      "IALSRecommender: Epoch 6 of 75. Elapsed time 1.45 min\n",
      "IALSRecommender: Epoch 7 of 75. Elapsed time 1.72 min\n",
      "IALSRecommender: Epoch 8 of 75. Elapsed time 1.96 min\n",
      "IALSRecommender: Epoch 9 of 75. Elapsed time 2.22 min\n",
      "IALSRecommender: Epoch 10 of 75. Elapsed time 2.47 min\n",
      "IALSRecommender: Epoch 11 of 75. Elapsed time 2.72 min\n",
      "IALSRecommender: Epoch 12 of 75. Elapsed time 2.96 min\n",
      "IALSRecommender: Epoch 13 of 75. Elapsed time 3.22 min\n",
      "IALSRecommender: Epoch 14 of 75. Elapsed time 3.45 min\n",
      "IALSRecommender: Epoch 15 of 75. Elapsed time 3.70 min\n",
      "IALSRecommender: Epoch 16 of 75. Elapsed time 3.94 min\n",
      "IALSRecommender: Epoch 17 of 75. Elapsed time 4.17 min\n",
      "IALSRecommender: Epoch 18 of 75. Elapsed time 4.43 min\n",
      "IALSRecommender: Epoch 19 of 75. Elapsed time 4.68 min\n",
      "IALSRecommender: Epoch 20 of 75. Elapsed time 4.94 min\n",
      "IALSRecommender: Epoch 21 of 75. Elapsed time 5.17 min\n",
      "IALSRecommender: Epoch 22 of 75. Elapsed time 5.43 min\n",
      "IALSRecommender: Epoch 23 of 75. Elapsed time 5.67 min\n",
      "IALSRecommender: Epoch 24 of 75. Elapsed time 5.93 min\n",
      "IALSRecommender: Epoch 25 of 75. Elapsed time 6.18 min\n",
      "IALSRecommender: Epoch 26 of 75. Elapsed time 6.45 min\n",
      "IALSRecommender: Epoch 27 of 75. Elapsed time 6.68 min\n",
      "IALSRecommender: Epoch 28 of 75. Elapsed time 6.96 min\n",
      "IALSRecommender: Epoch 29 of 75. Elapsed time 7.20 min\n",
      "IALSRecommender: Epoch 30 of 75. Elapsed time 7.43 min\n",
      "IALSRecommender: Epoch 31 of 75. Elapsed time 7.68 min\n",
      "IALSRecommender: Epoch 32 of 75. Elapsed time 7.91 min\n",
      "IALSRecommender: Epoch 33 of 75. Elapsed time 8.17 min\n",
      "IALSRecommender: Epoch 34 of 75. Elapsed time 8.40 min\n",
      "IALSRecommender: Epoch 35 of 75. Elapsed time 8.65 min\n",
      "IALSRecommender: Epoch 36 of 75. Elapsed time 8.89 min\n",
      "IALSRecommender: Epoch 37 of 75. Elapsed time 9.16 min\n",
      "IALSRecommender: Epoch 38 of 75. Elapsed time 9.40 min\n",
      "IALSRecommender: Epoch 39 of 75. Elapsed time 9.67 min\n",
      "IALSRecommender: Epoch 40 of 75. Elapsed time 9.90 min\n",
      "IALSRecommender: Epoch 41 of 75. Elapsed time 10.13 min\n",
      "IALSRecommender: Epoch 42 of 75. Elapsed time 10.38 min\n",
      "IALSRecommender: Epoch 43 of 75. Elapsed time 10.62 min\n",
      "IALSRecommender: Epoch 44 of 75. Elapsed time 10.89 min\n",
      "IALSRecommender: Epoch 45 of 75. Elapsed time 11.12 min\n",
      "IALSRecommender: Epoch 46 of 75. Elapsed time 11.38 min\n",
      "IALSRecommender: Epoch 47 of 75. Elapsed time 11.62 min\n",
      "IALSRecommender: Epoch 48 of 75. Elapsed time 11.88 min\n",
      "IALSRecommender: Epoch 49 of 75. Elapsed time 12.11 min\n",
      "IALSRecommender: Epoch 50 of 75. Elapsed time 12.37 min\n",
      "IALSRecommender: Epoch 51 of 75. Elapsed time 12.61 min\n",
      "IALSRecommender: Epoch 52 of 75. Elapsed time 12.87 min\n",
      "IALSRecommender: Epoch 53 of 75. Elapsed time 13.11 min\n",
      "IALSRecommender: Epoch 54 of 75. Elapsed time 13.34 min\n",
      "IALSRecommender: Epoch 55 of 75. Elapsed time 13.61 min\n",
      "IALSRecommender: Epoch 56 of 75. Elapsed time 13.85 min\n",
      "IALSRecommender: Epoch 57 of 75. Elapsed time 14.12 min\n",
      "IALSRecommender: Epoch 58 of 75. Elapsed time 14.36 min\n",
      "IALSRecommender: Epoch 59 of 75. Elapsed time 14.61 min\n",
      "IALSRecommender: Epoch 60 of 75. Elapsed time 14.84 min\n",
      "IALSRecommender: Epoch 61 of 75. Elapsed time 15.10 min\n",
      "IALSRecommender: Epoch 62 of 75. Elapsed time 15.33 min\n",
      "IALSRecommender: Epoch 63 of 75. Elapsed time 15.57 min\n",
      "IALSRecommender: Epoch 64 of 75. Elapsed time 15.82 min\n",
      "IALSRecommender: Epoch 65 of 75. Elapsed time 16.06 min\n",
      "IALSRecommender: Epoch 66 of 75. Elapsed time 16.37 min\n",
      "IALSRecommender: Epoch 67 of 75. Elapsed time 16.59 min\n",
      "IALSRecommender: Epoch 68 of 75. Elapsed time 16.84 min\n",
      "IALSRecommender: Epoch 69 of 75. Elapsed time 17.06 min\n",
      "IALSRecommender: Epoch 70 of 75. Elapsed time 17.32 min\n",
      "IALSRecommender: Epoch 71 of 75. Elapsed time 17.54 min\n",
      "IALSRecommender: Epoch 72 of 75. Elapsed time 17.79 min\n",
      "IALSRecommender: Epoch 73 of 75. Elapsed time 18.00 min\n",
      "IALSRecommender: Epoch 74 of 75. Elapsed time 18.22 min\n",
      "IALSRecommender: Epoch 75 of 75. Elapsed time 18.46 min\n",
      "IALSRecommender: Terminating at epoch 75. Elapsed time 18.46 min\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.MatrixFactorization.IALSRecommender import IALSRecommender\n",
    "\n",
    "IALSRecommender = IALSRecommender(urm_train_validation) \n",
    "IALSRecommender.fit(epochs = 75, num_factors = 50, confidence_scaling = 'log',\n",
    "                         alpha = 0.3075221670942267, epsilon = 0.10052111154657879,\n",
    "                         reg = 0.009384707112613314)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "674ad35e",
   "metadata": {
    "papermill": {
     "duration": 0.057149,
     "end_time": "2022-01-07T11:50:38.464334",
     "exception": false,
     "start_time": "2022-01-07T11:50:38.407185",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**LightFM** MAP(Locale) = 0.1587"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "4c71d7c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T11:50:38.578948Z",
     "iopub.status.busy": "2022-01-07T11:50:38.578000Z",
     "iopub.status.idle": "2022-01-07T13:50:52.476431Z",
     "shell.execute_reply": "2022-01-07T13:50:52.474601Z"
    },
    "papermill": {
     "duration": 7213.958484,
     "end_time": "2022-01-07T13:50:52.476701",
     "exception": false,
     "start_time": "2022-01-07T11:50:38.518217",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LightFMItemHybridRecommender: Epoch 1 of 500. Elapsed time 6.67 sec\n",
      "LightFMItemHybridRecommender: Epoch 2 of 500. Elapsed time 13.22 sec\n",
      "LightFMItemHybridRecommender: Epoch 3 of 500. Elapsed time 19.73 sec\n",
      "LightFMItemHybridRecommender: Epoch 4 of 500. Elapsed time 26.62 sec\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.63 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2667742, PRECISION_RECALL_MIN_DEN: 0.2682662, RECALL: 0.0576523, MAP: 0.1446379, MAP_MIN_DEN: 0.1452911, MRR: 0.5064464, NDCG: 0.2793351, F1: 0.0948143, HIT_RATE: 0.8993180, ARHR_ALL_HITS: 0.8467842, NOVELTY: 0.0055766, AVERAGE_POPULARITY: 0.5317167, DIVERSITY_MEAN_INTER_LIST: 0.9069670, DIVERSITY_HERFINDAHL: 0.9906900, COVERAGE_ITEM: 0.0539897, COVERAGE_ITEM_CORRECT: 0.0392602, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.8984615, DIVERSITY_GINI: 0.0084505, SHANNON_ENTROPY: 7.5707634, RATIO_DIVERSITY_HERFINDAHL: 0.9910724, RATIO_DIVERSITY_GINI: 0.0340806, RATIO_SHANNON_ENTROPY: 0.6110271, RATIO_AVERAGE_POPULARITY: 2.6161767, RATIO_NOVELTY: 0.0246944, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 5 of 500. Elapsed time 1.18 min\n",
      "LightFMItemHybridRecommender: Epoch 6 of 500. Elapsed time 1.28 min\n",
      "LightFMItemHybridRecommender: Epoch 7 of 500. Elapsed time 1.39 min\n",
      "LightFMItemHybridRecommender: Epoch 8 of 500. Elapsed time 1.49 min\n",
      "LightFMItemHybridRecommender: Epoch 9 of 500. Elapsed time 1.61 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.43 sec. Users per second: 355\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2734619, PRECISION_RECALL_MIN_DEN: 0.2750475, RECALL: 0.0594401, MAP: 0.1498052, MAP_MIN_DEN: 0.1505048, MRR: 0.5195920, NDCG: 0.2868859, F1: 0.0976539, HIT_RATE: 0.9081910, ARHR_ALL_HITS: 0.8712551, NOVELTY: 0.0055833, AVERAGE_POPULARITY: 0.5285964, DIVERSITY_MEAN_INTER_LIST: 0.9112422, DIVERSITY_HERFINDAHL: 0.9911175, COVERAGE_ITEM: 0.0612437, COVERAGE_ITEM_CORRECT: 0.0432471, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9073260, DIVERSITY_GINI: 0.0092894, SHANNON_ENTROPY: 7.6870985, RATIO_DIVERSITY_HERFINDAHL: 0.9915001, RATIO_DIVERSITY_GINI: 0.0374640, RATIO_SHANNON_ENTROPY: 0.6204164, RATIO_AVERAGE_POPULARITY: 2.6008244, RATIO_NOVELTY: 0.0247238, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 10 of 500. Elapsed time 2.35 min\n",
      "LightFMItemHybridRecommender: Epoch 11 of 500. Elapsed time 2.47 min\n",
      "LightFMItemHybridRecommender: Epoch 12 of 500. Elapsed time 2.58 min\n",
      "LightFMItemHybridRecommender: Epoch 13 of 500. Elapsed time 2.69 min\n",
      "LightFMItemHybridRecommender: Epoch 14 of 500. Elapsed time 2.80 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.49 sec. Users per second: 364\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2751192, PRECISION_RECALL_MIN_DEN: 0.2767276, RECALL: 0.0598547, MAP: 0.1516334, MAP_MIN_DEN: 0.1524611, MRR: 0.5256641, NDCG: 0.2896319, F1: 0.0983192, HIT_RATE: 0.9092909, ARHR_ALL_HITS: 0.8815987, NOVELTY: 0.0055869, AVERAGE_POPULARITY: 0.5266794, DIVERSITY_MEAN_INTER_LIST: 0.9129842, DIVERSITY_HERFINDAHL: 0.9912917, COVERAGE_ITEM: 0.0646769, COVERAGE_ITEM_CORRECT: 0.0458497, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9084249, DIVERSITY_GINI: 0.0098006, SHANNON_ENTROPY: 7.7511568, RATIO_DIVERSITY_HERFINDAHL: 0.9916743, RATIO_DIVERSITY_GINI: 0.0395256, RATIO_SHANNON_ENTROPY: 0.6255864, RATIO_AVERAGE_POPULARITY: 2.5913922, RATIO_NOVELTY: 0.0247399, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 15 of 500. Elapsed time 3.53 min\n",
      "LightFMItemHybridRecommender: Epoch 16 of 500. Elapsed time 3.63 min\n",
      "LightFMItemHybridRecommender: Epoch 17 of 500. Elapsed time 3.74 min\n",
      "LightFMItemHybridRecommender: Epoch 18 of 500. Elapsed time 3.85 min\n",
      "LightFMItemHybridRecommender: Epoch 19 of 500. Elapsed time 3.96 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.91 sec. Users per second: 360\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2761311, PRECISION_RECALL_MIN_DEN: 0.2777491, RECALL: 0.0601220, MAP: 0.1521733, MAP_MIN_DEN: 0.1529105, MRR: 0.5237520, NDCG: 0.2901790, F1: 0.0987444, HIT_RATE: 0.9100242, ARHR_ALL_HITS: 0.8820612, NOVELTY: 0.0055968, AVERAGE_POPULARITY: 0.5207777, DIVERSITY_MEAN_INTER_LIST: 0.9178962, DIVERSITY_HERFINDAHL: 0.9917829, COVERAGE_ITEM: 0.0682762, COVERAGE_ITEM_CORRECT: 0.0484523, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9091575, DIVERSITY_GINI: 0.0104041, SHANNON_ENTROPY: 7.8375747, RATIO_DIVERSITY_HERFINDAHL: 0.9921657, RATIO_DIVERSITY_GINI: 0.0419593, RATIO_SHANNON_ENTROPY: 0.6325611, RATIO_AVERAGE_POPULARITY: 2.5623546, RATIO_NOVELTY: 0.0247838, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 20 of 500. Elapsed time 4.69 min\n",
      "LightFMItemHybridRecommender: Epoch 21 of 500. Elapsed time 4.80 min\n",
      "LightFMItemHybridRecommender: Epoch 22 of 500. Elapsed time 4.91 min\n",
      "LightFMItemHybridRecommender: Epoch 23 of 500. Elapsed time 5.01 min\n",
      "LightFMItemHybridRecommender: Epoch 24 of 500. Elapsed time 5.12 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.44 sec. Users per second: 364\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2779570, PRECISION_RECALL_MIN_DEN: 0.2796248, RECALL: 0.0606199, MAP: 0.1532521, MAP_MIN_DEN: 0.1538903, MRR: 0.5255184, NDCG: 0.2918096, F1: 0.0995327, HIT_RATE: 0.9114175, ARHR_ALL_HITS: 0.8865962, NOVELTY: 0.0055978, AVERAGE_POPULARITY: 0.5212107, DIVERSITY_MEAN_INTER_LIST: 0.9175536, DIVERSITY_HERFINDAHL: 0.9917486, COVERAGE_ITEM: 0.0705465, COVERAGE_ITEM_CORRECT: 0.0497813, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9105495, DIVERSITY_GINI: 0.0106705, SHANNON_ENTROPY: 7.8603206, RATIO_DIVERSITY_HERFINDAHL: 0.9921314, RATIO_DIVERSITY_GINI: 0.0430337, RATIO_SHANNON_ENTROPY: 0.6343969, RATIO_AVERAGE_POPULARITY: 2.5644850, RATIO_NOVELTY: 0.0247884, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 25 of 500. Elapsed time 5.85 min\n",
      "LightFMItemHybridRecommender: Epoch 26 of 500. Elapsed time 5.96 min\n",
      "LightFMItemHybridRecommender: Epoch 27 of 500. Elapsed time 6.06 min\n",
      "LightFMItemHybridRecommender: Epoch 28 of 500. Elapsed time 6.18 min\n",
      "LightFMItemHybridRecommender: Epoch 29 of 500. Elapsed time 6.29 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.63 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2789396, PRECISION_RECALL_MIN_DEN: 0.2805922, RECALL: 0.0608668, MAP: 0.1545919, MAP_MIN_DEN: 0.1554038, MRR: 0.5315991, NDCG: 0.2939011, F1: 0.0999284, HIT_RATE: 0.9139107, ARHR_ALL_HITS: 0.8952820, NOVELTY: 0.0056036, AVERAGE_POPULARITY: 0.5188402, DIVERSITY_MEAN_INTER_LIST: 0.9188429, DIVERSITY_HERFINDAHL: 0.9918776, COVERAGE_ITEM: 0.0715433, COVERAGE_ITEM_CORRECT: 0.0503350, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9130403, DIVERSITY_GINI: 0.0109254, SHANNON_ENTROPY: 7.8936810, RATIO_DIVERSITY_HERFINDAHL: 0.9922604, RATIO_DIVERSITY_GINI: 0.0440619, RATIO_SHANNON_ENTROPY: 0.6370894, RATIO_AVERAGE_POPULARITY: 2.5528215, RATIO_NOVELTY: 0.0248141, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 30 of 500. Elapsed time 7.03 min\n",
      "LightFMItemHybridRecommender: Epoch 31 of 500. Elapsed time 7.14 min\n",
      "LightFMItemHybridRecommender: Epoch 32 of 500. Elapsed time 7.24 min\n",
      "LightFMItemHybridRecommender: Epoch 33 of 500. Elapsed time 7.35 min\n",
      "LightFMItemHybridRecommender: Epoch 34 of 500. Elapsed time 7.45 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.11 sec. Users per second: 368\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2795850, PRECISION_RECALL_MIN_DEN: 0.2813163, RECALL: 0.0611755, MAP: 0.1546772, MAP_MIN_DEN: 0.1554859, MRR: 0.5311040, NDCG: 0.2942007, F1: 0.1003857, HIT_RATE: 0.9160373, ARHR_ALL_HITS: 0.8951562, NOVELTY: 0.0056037, AVERAGE_POPULARITY: 0.5179741, DIVERSITY_MEAN_INTER_LIST: 0.9205706, DIVERSITY_HERFINDAHL: 0.9920503, COVERAGE_ITEM: 0.0724846, COVERAGE_ITEM_CORRECT: 0.0512210, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9151648, DIVERSITY_GINI: 0.0111312, SHANNON_ENTROPY: 7.9219076, RATIO_DIVERSITY_HERFINDAHL: 0.9924332, RATIO_DIVERSITY_GINI: 0.0448916, RATIO_SHANNON_ENTROPY: 0.6393675, RATIO_AVERAGE_POPULARITY: 2.5485598, RATIO_NOVELTY: 0.0248145, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 35 of 500. Elapsed time 8.19 min\n",
      "LightFMItemHybridRecommender: Epoch 36 of 500. Elapsed time 8.29 min\n",
      "LightFMItemHybridRecommender: Epoch 37 of 500. Elapsed time 8.40 min\n",
      "LightFMItemHybridRecommender: Epoch 38 of 500. Elapsed time 8.51 min\n",
      "LightFMItemHybridRecommender: Epoch 39 of 500. Elapsed time 8.62 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.23 sec. Users per second: 366\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2800323, PRECISION_RECALL_MIN_DEN: 0.2816985, RECALL: 0.0611745, MAP: 0.1554820, MAP_MIN_DEN: 0.1562370, MRR: 0.5336040, NDCG: 0.2951688, F1: 0.1004132, HIT_RATE: 0.9158906, ARHR_ALL_HITS: 0.8995900, NOVELTY: 0.0056031, AVERAGE_POPULARITY: 0.5194021, DIVERSITY_MEAN_INTER_LIST: 0.9187979, DIVERSITY_HERFINDAHL: 0.9918731, COVERAGE_ITEM: 0.0732599, COVERAGE_ITEM_CORRECT: 0.0526053, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9150183, DIVERSITY_GINI: 0.0111866, SHANNON_ENTROPY: 7.9168810, RATIO_DIVERSITY_HERFINDAHL: 0.9922559, RATIO_DIVERSITY_GINI: 0.0451153, RATIO_SHANNON_ENTROPY: 0.6389618, RATIO_AVERAGE_POPULARITY: 2.5555858, RATIO_NOVELTY: 0.0248117, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 40 of 500. Elapsed time 9.35 min\n",
      "LightFMItemHybridRecommender: Epoch 41 of 500. Elapsed time 9.45 min\n",
      "LightFMItemHybridRecommender: Epoch 42 of 500. Elapsed time 9.55 min\n",
      "LightFMItemHybridRecommender: Epoch 43 of 500. Elapsed time 9.66 min\n",
      "LightFMItemHybridRecommender: Epoch 44 of 500. Elapsed time 9.77 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.00 sec. Users per second: 369\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2797096, PRECISION_RECALL_MIN_DEN: 0.2814265, RECALL: 0.0611113, MAP: 0.1549853, MAP_MIN_DEN: 0.1557267, MRR: 0.5316369, NDCG: 0.2944710, F1: 0.1003074, HIT_RATE: 0.9150840, ARHR_ALL_HITS: 0.8965448, NOVELTY: 0.0056053, AVERAGE_POPULARITY: 0.5182469, DIVERSITY_MEAN_INTER_LIST: 0.9198493, DIVERSITY_HERFINDAHL: 0.9919782, COVERAGE_ITEM: 0.0742012, COVERAGE_ITEM_CORRECT: 0.0532698, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9142125, DIVERSITY_GINI: 0.0113298, SHANNON_ENTROPY: 7.9331416, RATIO_DIVERSITY_HERFINDAHL: 0.9923611, RATIO_DIVERSITY_GINI: 0.0456927, RATIO_SHANNON_ENTROPY: 0.6402742, RATIO_AVERAGE_POPULARITY: 2.5499022, RATIO_NOVELTY: 0.0248214, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 45 of 500. Elapsed time 10.49 min\n",
      "LightFMItemHybridRecommender: Epoch 46 of 500. Elapsed time 10.60 min\n",
      "LightFMItemHybridRecommender: Epoch 47 of 500. Elapsed time 10.71 min\n",
      "LightFMItemHybridRecommender: Epoch 48 of 500. Elapsed time 10.82 min\n",
      "LightFMItemHybridRecommender: Epoch 49 of 500. Elapsed time 10.93 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.21 sec. Users per second: 366\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2801789, PRECISION_RECALL_MIN_DEN: 0.2818740, RECALL: 0.0612157, MAP: 0.1555233, MAP_MIN_DEN: 0.1561775, MRR: 0.5337006, NDCG: 0.2952349, F1: 0.1004781, HIT_RATE: 0.9142040, ARHR_ALL_HITS: 0.9000235, NOVELTY: 0.0056064, AVERAGE_POPULARITY: 0.5183696, DIVERSITY_MEAN_INTER_LIST: 0.9193614, DIVERSITY_HERFINDAHL: 0.9919294, COVERAGE_ITEM: 0.0745888, COVERAGE_ITEM_CORRECT: 0.0531591, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9133333, DIVERSITY_GINI: 0.0113380, SHANNON_ENTROPY: 7.9304340, RATIO_DIVERSITY_HERFINDAHL: 0.9923123, RATIO_DIVERSITY_GINI: 0.0457259, RATIO_SHANNON_ENTROPY: 0.6400557, RATIO_AVERAGE_POPULARITY: 2.5505057, RATIO_NOVELTY: 0.0248264, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 50 of 500. Elapsed time 11.65 min\n",
      "LightFMItemHybridRecommender: Epoch 51 of 500. Elapsed time 11.75 min\n",
      "LightFMItemHybridRecommender: Epoch 52 of 500. Elapsed time 11.86 min\n",
      "LightFMItemHybridRecommender: Epoch 53 of 500. Elapsed time 11.98 min\n",
      "LightFMItemHybridRecommender: Epoch 54 of 500. Elapsed time 12.08 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.57 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2795996, PRECISION_RECALL_MIN_DEN: 0.2812401, RECALL: 0.0609547, MAP: 0.1543923, MAP_MIN_DEN: 0.1550800, MRR: 0.5272641, NDCG: 0.2935070, F1: 0.1000893, HIT_RATE: 0.9143507, ARHR_ALL_HITS: 0.8914827, NOVELTY: 0.0056123, AVERAGE_POPULARITY: 0.5148108, DIVERSITY_MEAN_INTER_LIST: 0.9221356, DIVERSITY_HERFINDAHL: 0.9922068, COVERAGE_ITEM: 0.0757517, COVERAGE_ITEM_CORRECT: 0.0538236, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134799, DIVERSITY_GINI: 0.0115730, SHANNON_ENTROPY: 7.9664909, RATIO_DIVERSITY_HERFINDAHL: 0.9925898, RATIO_DIVERSITY_GINI: 0.0466735, RATIO_SHANNON_ENTROPY: 0.6429658, RATIO_AVERAGE_POPULARITY: 2.5329958, RATIO_NOVELTY: 0.0248526, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 55 of 500. Elapsed time 12.82 min\n",
      "LightFMItemHybridRecommender: Epoch 56 of 500. Elapsed time 12.92 min\n",
      "LightFMItemHybridRecommender: Epoch 57 of 500. Elapsed time 13.03 min\n",
      "LightFMItemHybridRecommender: Epoch 58 of 500. Elapsed time 13.14 min\n",
      "LightFMItemHybridRecommender: Epoch 59 of 500. Elapsed time 13.24 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.22 sec. Users per second: 366\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2802229, PRECISION_RECALL_MIN_DEN: 0.2819157, RECALL: 0.0612836, MAP: 0.1557410, MAP_MIN_DEN: 0.1565188, MRR: 0.5351494, NDCG: 0.2956130, F1: 0.1005724, HIT_RATE: 0.9147173, ARHR_ALL_HITS: 0.9015560, NOVELTY: 0.0056112, AVERAGE_POPULARITY: 0.5164314, DIVERSITY_MEAN_INTER_LIST: 0.9206627, DIVERSITY_HERFINDAHL: 0.9920595, COVERAGE_ITEM: 0.0774683, COVERAGE_ITEM_CORRECT: 0.0549864, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9138462, DIVERSITY_GINI: 0.0116468, SHANNON_ENTROPY: 7.9667417, RATIO_DIVERSITY_HERFINDAHL: 0.9924424, RATIO_DIVERSITY_GINI: 0.0469712, RATIO_SHANNON_ENTROPY: 0.6429860, RATIO_AVERAGE_POPULARITY: 2.5409696, RATIO_NOVELTY: 0.0248478, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 60 of 500. Elapsed time 13.97 min\n",
      "LightFMItemHybridRecommender: Epoch 61 of 500. Elapsed time 14.08 min\n",
      "LightFMItemHybridRecommender: Epoch 62 of 500. Elapsed time 14.18 min\n",
      "LightFMItemHybridRecommender: Epoch 63 of 500. Elapsed time 14.29 min\n",
      "LightFMItemHybridRecommender: Epoch 64 of 500. Elapsed time 14.40 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.98 sec. Users per second: 369\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2803256, PRECISION_RECALL_MIN_DEN: 0.2820295, RECALL: 0.0612844, MAP: 0.1553548, MAP_MIN_DEN: 0.1560917, MRR: 0.5320614, NDCG: 0.2950351, F1: 0.1005801, HIT_RATE: 0.9143507, ARHR_ALL_HITS: 0.8980936, NOVELTY: 0.0056120, AVERAGE_POPULARITY: 0.5152146, DIVERSITY_MEAN_INTER_LIST: 0.9218642, DIVERSITY_HERFINDAHL: 0.9921797, COVERAGE_ITEM: 0.0770253, COVERAGE_ITEM_CORRECT: 0.0545988, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134799, DIVERSITY_GINI: 0.0116422, SHANNON_ENTROPY: 7.9719179, RATIO_DIVERSITY_HERFINDAHL: 0.9925626, RATIO_DIVERSITY_GINI: 0.0469528, RATIO_SHANNON_ENTROPY: 0.6434038, RATIO_AVERAGE_POPULARITY: 2.5349824, RATIO_NOVELTY: 0.0248512, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 65 of 500. Elapsed time 15.12 min\n",
      "LightFMItemHybridRecommender: Epoch 66 of 500. Elapsed time 15.24 min\n",
      "LightFMItemHybridRecommender: Epoch 67 of 500. Elapsed time 15.35 min\n",
      "LightFMItemHybridRecommender: Epoch 68 of 500. Elapsed time 15.46 min\n",
      "LightFMItemHybridRecommender: Epoch 69 of 500. Elapsed time 15.57 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.27 sec. Users per second: 366\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2804576, PRECISION_RECALL_MIN_DEN: 0.2822044, RECALL: 0.0613535, MAP: 0.1556036, MAP_MIN_DEN: 0.1563681, MRR: 0.5330081, NDCG: 0.2954308, F1: 0.1006816, HIT_RATE: 0.9142773, ARHR_ALL_HITS: 0.8997795, NOVELTY: 0.0056122, AVERAGE_POPULARITY: 0.5157093, DIVERSITY_MEAN_INTER_LIST: 0.9214259, DIVERSITY_HERFINDAHL: 0.9921358, COVERAGE_ITEM: 0.0792403, COVERAGE_ITEM_CORRECT: 0.0553187, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134066, DIVERSITY_GINI: 0.0117329, SHANNON_ENTROPY: 7.9751440, RATIO_DIVERSITY_HERFINDAHL: 0.9925188, RATIO_DIVERSITY_GINI: 0.0473184, RATIO_SHANNON_ENTROPY: 0.6436642, RATIO_AVERAGE_POPULARITY: 2.5374165, RATIO_NOVELTY: 0.0248519, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 70 of 500. Elapsed time 16.30 min\n",
      "LightFMItemHybridRecommender: Epoch 71 of 500. Elapsed time 16.41 min\n",
      "LightFMItemHybridRecommender: Epoch 72 of 500. Elapsed time 16.52 min\n",
      "LightFMItemHybridRecommender: Epoch 73 of 500. Elapsed time 16.63 min\n",
      "LightFMItemHybridRecommender: Epoch 74 of 500. Elapsed time 16.74 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.94 sec. Users per second: 369\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2806629, PRECISION_RECALL_MIN_DEN: 0.2823197, RECALL: 0.0613425, MAP: 0.1553026, MAP_MIN_DEN: 0.1559642, MRR: 0.5297900, NDCG: 0.2948944, F1: 0.1006800, HIT_RATE: 0.9128107, ARHR_ALL_HITS: 0.8966084, NOVELTY: 0.0056141, AVERAGE_POPULARITY: 0.5141552, DIVERSITY_MEAN_INTER_LIST: 0.9220484, DIVERSITY_HERFINDAHL: 0.9921981, COVERAGE_ITEM: 0.0791295, COVERAGE_ITEM_CORRECT: 0.0558170, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9119414, DIVERSITY_GINI: 0.0117473, SHANNON_ENTROPY: 7.9804633, RATIO_DIVERSITY_HERFINDAHL: 0.9925810, RATIO_DIVERSITY_GINI: 0.0473764, RATIO_SHANNON_ENTROPY: 0.6440935, RATIO_AVERAGE_POPULARITY: 2.5297702, RATIO_NOVELTY: 0.0248604, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 75 of 500. Elapsed time 17.46 min\n",
      "LightFMItemHybridRecommender: Epoch 76 of 500. Elapsed time 17.57 min\n",
      "LightFMItemHybridRecommender: Epoch 77 of 500. Elapsed time 17.68 min\n",
      "LightFMItemHybridRecommender: Epoch 78 of 500. Elapsed time 17.78 min\n",
      "LightFMItemHybridRecommender: Epoch 79 of 500. Elapsed time 17.89 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.96 sec. Users per second: 369\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2808316, PRECISION_RECALL_MIN_DEN: 0.2824470, RECALL: 0.0613277, MAP: 0.1558938, MAP_MIN_DEN: 0.1565649, MRR: 0.5322340, NDCG: 0.2955600, F1: 0.1006710, HIT_RATE: 0.9128841, ARHR_ALL_HITS: 0.8999759, NOVELTY: 0.0056143, AVERAGE_POPULARITY: 0.5151539, DIVERSITY_MEAN_INTER_LIST: 0.9209872, DIVERSITY_HERFINDAHL: 0.9920920, COVERAGE_ITEM: 0.0800155, COVERAGE_ITEM_CORRECT: 0.0559832, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9120147, DIVERSITY_GINI: 0.0118172, SHANNON_ENTROPY: 7.9798476, RATIO_DIVERSITY_HERFINDAHL: 0.9924749, RATIO_DIVERSITY_GINI: 0.0476585, RATIO_SHANNON_ENTROPY: 0.6440438, RATIO_AVERAGE_POPULARITY: 2.5346837, RATIO_NOVELTY: 0.0248613, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 80 of 500. Elapsed time 18.61 min\n",
      "LightFMItemHybridRecommender: Epoch 81 of 500. Elapsed time 18.72 min\n",
      "LightFMItemHybridRecommender: Epoch 82 of 500. Elapsed time 18.83 min\n",
      "LightFMItemHybridRecommender: Epoch 83 of 500. Elapsed time 18.94 min\n",
      "LightFMItemHybridRecommender: Epoch 84 of 500. Elapsed time 19.05 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.00 sec. Users per second: 369\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2809636, PRECISION_RECALL_MIN_DEN: 0.2826705, RECALL: 0.0614742, MAP: 0.1561744, MAP_MIN_DEN: 0.1569099, MRR: 0.5340602, NDCG: 0.2960992, F1: 0.1008767, HIT_RATE: 0.9130307, ARHR_ALL_HITS: 0.9023828, NOVELTY: 0.0056128, AVERAGE_POPULARITY: 0.5158226, DIVERSITY_MEAN_INTER_LIST: 0.9212457, DIVERSITY_HERFINDAHL: 0.9921178, COVERAGE_ITEM: 0.0808461, COVERAGE_ITEM_CORRECT: 0.0564262, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9121612, DIVERSITY_GINI: 0.0118396, SHANNON_ENTROPY: 7.9837943, RATIO_DIVERSITY_HERFINDAHL: 0.9925007, RATIO_DIVERSITY_GINI: 0.0477489, RATIO_SHANNON_ENTROPY: 0.6443623, RATIO_AVERAGE_POPULARITY: 2.5379738, RATIO_NOVELTY: 0.0248546, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 85 of 500. Elapsed time 19.77 min\n",
      "LightFMItemHybridRecommender: Epoch 86 of 500. Elapsed time 19.88 min\n",
      "LightFMItemHybridRecommender: Epoch 87 of 500. Elapsed time 19.98 min\n",
      "LightFMItemHybridRecommender: Epoch 88 of 500. Elapsed time 20.09 min\n",
      "LightFMItemHybridRecommender: Epoch 89 of 500. Elapsed time 20.19 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.03 sec. Users per second: 368\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2807362, PRECISION_RECALL_MIN_DEN: 0.2824680, RECALL: 0.0613199, MAP: 0.1559086, MAP_MIN_DEN: 0.1566204, MRR: 0.5315432, NDCG: 0.2954731, F1: 0.1006544, HIT_RATE: 0.9131041, ARHR_ALL_HITS: 0.8993219, NOVELTY: 0.0056188, AVERAGE_POPULARITY: 0.5127796, DIVERSITY_MEAN_INTER_LIST: 0.9228038, DIVERSITY_HERFINDAHL: 0.9922736, COVERAGE_ITEM: 0.0816214, COVERAGE_ITEM_CORRECT: 0.0566477, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9122344, DIVERSITY_GINI: 0.0119952, SHANNON_ENTROPY: 8.0058736, RATIO_DIVERSITY_HERFINDAHL: 0.9926566, RATIO_DIVERSITY_GINI: 0.0483764, RATIO_SHANNON_ENTROPY: 0.6461443, RATIO_AVERAGE_POPULARITY: 2.5230017, RATIO_NOVELTY: 0.0248812, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 90 of 500. Elapsed time 20.92 min\n",
      "LightFMItemHybridRecommender: Epoch 91 of 500. Elapsed time 21.03 min\n",
      "LightFMItemHybridRecommender: Epoch 92 of 500. Elapsed time 21.14 min\n",
      "LightFMItemHybridRecommender: Epoch 93 of 500. Elapsed time 21.24 min\n",
      "LightFMItemHybridRecommender: Epoch 94 of 500. Elapsed time 21.35 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.37 sec. Users per second: 365\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2805529, PRECISION_RECALL_MIN_DEN: 0.2822538, RECALL: 0.0613808, MAP: 0.1555062, MAP_MIN_DEN: 0.1561801, MRR: 0.5290284, NDCG: 0.2949253, F1: 0.1007246, HIT_RATE: 0.9117841, ARHR_ALL_HITS: 0.8967980, NOVELTY: 0.0056225, AVERAGE_POPULARITY: 0.5110857, DIVERSITY_MEAN_INTER_LIST: 0.9235452, DIVERSITY_HERFINDAHL: 0.9923477, COVERAGE_ITEM: 0.0821197, COVERAGE_ITEM_CORRECT: 0.0568138, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9109158, DIVERSITY_GINI: 0.0120697, SHANNON_ENTROPY: 8.0160913, RATIO_DIVERSITY_HERFINDAHL: 0.9927308, RATIO_DIVERSITY_GINI: 0.0486767, RATIO_SHANNON_ENTROPY: 0.6469690, RATIO_AVERAGE_POPULARITY: 2.5146673, RATIO_NOVELTY: 0.0248977, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 95 of 500. Elapsed time 22.08 min\n",
      "LightFMItemHybridRecommender: Epoch 96 of 500. Elapsed time 22.19 min\n",
      "LightFMItemHybridRecommender: Epoch 97 of 500. Elapsed time 22.30 min\n",
      "LightFMItemHybridRecommender: Epoch 98 of 500. Elapsed time 22.40 min\n",
      "LightFMItemHybridRecommender: Epoch 99 of 500. Elapsed time 22.51 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.55 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2807289, PRECISION_RECALL_MIN_DEN: 0.2824321, RECALL: 0.0614595, MAP: 0.1561235, MAP_MIN_DEN: 0.1568469, MRR: 0.5346669, NDCG: 0.2960704, F1: 0.1008419, HIT_RATE: 0.9133240, ARHR_ALL_HITS: 0.9028023, NOVELTY: 0.0056185, AVERAGE_POPULARITY: 0.5138188, DIVERSITY_MEAN_INTER_LIST: 0.9220505, DIVERSITY_HERFINDAHL: 0.9921983, COVERAGE_ITEM: 0.0826181, COVERAGE_ITEM_CORRECT: 0.0558170, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9124542, DIVERSITY_GINI: 0.0120401, SHANNON_ENTROPY: 8.0060576, RATIO_DIVERSITY_HERFINDAHL: 0.9925812, RATIO_DIVERSITY_GINI: 0.0485574, RATIO_SHANNON_ENTROPY: 0.6461592, RATIO_AVERAGE_POPULARITY: 2.5281151, RATIO_NOVELTY: 0.0248801, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 100 of 500. Elapsed time 23.25 min\n",
      "LightFMItemHybridRecommender: Epoch 101 of 500. Elapsed time 23.36 min\n",
      "LightFMItemHybridRecommender: Epoch 102 of 500. Elapsed time 23.46 min\n",
      "LightFMItemHybridRecommender: Epoch 103 of 500. Elapsed time 23.57 min\n",
      "LightFMItemHybridRecommender: Epoch 104 of 500. Elapsed time 23.68 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.88 sec. Users per second: 370\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2813742, PRECISION_RECALL_MIN_DEN: 0.2830545, RECALL: 0.0615615, MAP: 0.1564022, MAP_MIN_DEN: 0.1571347, MRR: 0.5352076, NDCG: 0.2965924, F1: 0.1010207, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9040288, NOVELTY: 0.0056193, AVERAGE_POPULARITY: 0.5128841, DIVERSITY_MEAN_INTER_LIST: 0.9227476, DIVERSITY_HERFINDAHL: 0.9922680, COVERAGE_ITEM: 0.0822858, COVERAGE_ITEM_CORRECT: 0.0565923, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0120317, SHANNON_ENTROPY: 8.0091536, RATIO_DIVERSITY_HERFINDAHL: 0.9926510, RATIO_DIVERSITY_GINI: 0.0485236, RATIO_SHANNON_ENTROPY: 0.6464090, RATIO_AVERAGE_POPULARITY: 2.5235158, RATIO_NOVELTY: 0.0248833, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 105 of 500. Elapsed time 24.41 min\n",
      "LightFMItemHybridRecommender: Epoch 106 of 500. Elapsed time 24.52 min\n",
      "LightFMItemHybridRecommender: Epoch 107 of 500. Elapsed time 24.62 min\n",
      "LightFMItemHybridRecommender: Epoch 108 of 500. Elapsed time 24.73 min\n",
      "LightFMItemHybridRecommender: Epoch 109 of 500. Elapsed time 24.84 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.66 sec. Users per second: 372\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2815429, PRECISION_RECALL_MIN_DEN: 0.2832113, RECALL: 0.0616544, MAP: 0.1560685, MAP_MIN_DEN: 0.1568046, MRR: 0.5314852, NDCG: 0.2960028, F1: 0.1011567, HIT_RATE: 0.9142040, ARHR_ALL_HITS: 0.9001223, NOVELTY: 0.0056204, AVERAGE_POPULARITY: 0.5124102, DIVERSITY_MEAN_INTER_LIST: 0.9229376, DIVERSITY_HERFINDAHL: 0.9922870, COVERAGE_ITEM: 0.0828950, COVERAGE_ITEM_CORRECT: 0.0565923, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9133333, DIVERSITY_GINI: 0.0120833, SHANNON_ENTROPY: 8.0127743, RATIO_DIVERSITY_HERFINDAHL: 0.9926700, RATIO_DIVERSITY_GINI: 0.0487317, RATIO_SHANNON_ENTROPY: 0.6467012, RATIO_AVERAGE_POPULARITY: 2.5211841, RATIO_NOVELTY: 0.0248882, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 110 of 500. Elapsed time 25.56 min\n",
      "LightFMItemHybridRecommender: Epoch 111 of 500. Elapsed time 25.67 min\n",
      "LightFMItemHybridRecommender: Epoch 112 of 500. Elapsed time 25.78 min\n",
      "LightFMItemHybridRecommender: Epoch 113 of 500. Elapsed time 25.89 min\n",
      "LightFMItemHybridRecommender: Epoch 114 of 500. Elapsed time 26.00 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.33 sec. Users per second: 365\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2814109, PRECISION_RECALL_MIN_DEN: 0.2831063, RECALL: 0.0616127, MAP: 0.1561525, MAP_MIN_DEN: 0.1568588, MRR: 0.5317539, NDCG: 0.2960418, F1: 0.1010921, HIT_RATE: 0.9136174, ARHR_ALL_HITS: 0.9007444, NOVELTY: 0.0056195, AVERAGE_POPULARITY: 0.5131427, DIVERSITY_MEAN_INTER_LIST: 0.9223588, DIVERSITY_HERFINDAHL: 0.9922291, COVERAGE_ITEM: 0.0838363, COVERAGE_ITEM_CORRECT: 0.0570906, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9127473, DIVERSITY_GINI: 0.0120859, SHANNON_ENTROPY: 8.0082517, RATIO_DIVERSITY_HERFINDAHL: 0.9926121, RATIO_DIVERSITY_GINI: 0.0487421, RATIO_SHANNON_ENTROPY: 0.6463362, RATIO_AVERAGE_POPULARITY: 2.5247882, RATIO_NOVELTY: 0.0248844, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 115 of 500. Elapsed time 26.73 min\n",
      "LightFMItemHybridRecommender: Epoch 116 of 500. Elapsed time 26.84 min\n",
      "LightFMItemHybridRecommender: Epoch 117 of 500. Elapsed time 26.95 min\n",
      "LightFMItemHybridRecommender: Epoch 118 of 500. Elapsed time 27.06 min\n",
      "LightFMItemHybridRecommender: Epoch 119 of 500. Elapsed time 27.17 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 36.80 sec. Users per second: 371\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2813815, PRECISION_RECALL_MIN_DEN: 0.2830688, RECALL: 0.0616174, MAP: 0.1561831, MAP_MIN_DEN: 0.1568986, MRR: 0.5320100, NDCG: 0.2960688, F1: 0.1010965, HIT_RATE: 0.9138374, ARHR_ALL_HITS: 0.9009343, NOVELTY: 0.0056195, AVERAGE_POPULARITY: 0.5131130, DIVERSITY_MEAN_INTER_LIST: 0.9223817, DIVERSITY_HERFINDAHL: 0.9922314, COVERAGE_ITEM: 0.0837809, COVERAGE_ITEM_CORRECT: 0.0570353, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9129670, DIVERSITY_GINI: 0.0120465, SHANNON_ENTROPY: 8.0050862, RATIO_DIVERSITY_HERFINDAHL: 0.9926144, RATIO_DIVERSITY_GINI: 0.0485832, RATIO_SHANNON_ENTROPY: 0.6460807, RATIO_AVERAGE_POPULARITY: 2.5246419, RATIO_NOVELTY: 0.0248842, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 120 of 500. Elapsed time 27.89 min\n",
      "LightFMItemHybridRecommender: Epoch 121 of 500. Elapsed time 28.01 min\n",
      "LightFMItemHybridRecommender: Epoch 122 of 500. Elapsed time 28.11 min\n",
      "LightFMItemHybridRecommender: Epoch 123 of 500. Elapsed time 28.23 min\n",
      "LightFMItemHybridRecommender: Epoch 124 of 500. Elapsed time 28.34 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.52 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2818215, PRECISION_RECALL_MIN_DEN: 0.2834812, RECALL: 0.0616376, MAP: 0.1568220, MAP_MIN_DEN: 0.1575395, MRR: 0.5351675, NDCG: 0.2969257, F1: 0.1011521, HIT_RATE: 0.9136174, ARHR_ALL_HITS: 0.9048194, NOVELTY: 0.0056236, AVERAGE_POPULARITY: 0.5113548, DIVERSITY_MEAN_INTER_LIST: 0.9234577, DIVERSITY_HERFINDAHL: 0.9923390, COVERAGE_ITEM: 0.0842793, COVERAGE_ITEM_CORRECT: 0.0569245, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9127473, DIVERSITY_GINI: 0.0122125, SHANNON_ENTROPY: 8.0270667, RATIO_DIVERSITY_HERFINDAHL: 0.9927220, RATIO_DIVERSITY_GINI: 0.0492526, RATIO_SHANNON_ENTROPY: 0.6478548, RATIO_AVERAGE_POPULARITY: 2.5159912, RATIO_NOVELTY: 0.0249027, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 125 of 500. Elapsed time 29.07 min\n",
      "LightFMItemHybridRecommender: Epoch 126 of 500. Elapsed time 29.18 min\n",
      "LightFMItemHybridRecommender: Epoch 127 of 500. Elapsed time 29.29 min\n",
      "LightFMItemHybridRecommender: Epoch 128 of 500. Elapsed time 29.40 min\n",
      "LightFMItemHybridRecommender: Epoch 129 of 500. Elapsed time 29.51 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.03 sec. Users per second: 359\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2813669, PRECISION_RECALL_MIN_DEN: 0.2829975, RECALL: 0.0616324, MAP: 0.1562894, MAP_MIN_DEN: 0.1569423, MRR: 0.5319694, NDCG: 0.2960315, F1: 0.1011157, HIT_RATE: 0.9147906, ARHR_ALL_HITS: 0.9010889, NOVELTY: 0.0056243, AVERAGE_POPULARITY: 0.5111714, DIVERSITY_MEAN_INTER_LIST: 0.9234503, DIVERSITY_HERFINDAHL: 0.9923383, COVERAGE_ITEM: 0.0848884, COVERAGE_ITEM_CORRECT: 0.0574229, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9139194, DIVERSITY_GINI: 0.0122517, SHANNON_ENTROPY: 8.0287465, RATIO_DIVERSITY_HERFINDAHL: 0.9927213, RATIO_DIVERSITY_GINI: 0.0494107, RATIO_SHANNON_ENTROPY: 0.6479903, RATIO_AVERAGE_POPULARITY: 2.5150889, RATIO_NOVELTY: 0.0249056, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 130 of 500. Elapsed time 30.26 min\n",
      "LightFMItemHybridRecommender: Epoch 131 of 500. Elapsed time 30.38 min\n",
      "LightFMItemHybridRecommender: Epoch 132 of 500. Elapsed time 30.49 min\n",
      "LightFMItemHybridRecommender: Epoch 133 of 500. Elapsed time 30.60 min\n",
      "LightFMItemHybridRecommender: Epoch 134 of 500. Elapsed time 30.71 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.68 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2819902, PRECISION_RECALL_MIN_DEN: 0.2836155, RECALL: 0.0616801, MAP: 0.1569730, MAP_MIN_DEN: 0.1576537, MRR: 0.5341950, NDCG: 0.2969837, F1: 0.1012202, HIT_RATE: 0.9140573, ARHR_ALL_HITS: 0.9047405, NOVELTY: 0.0056225, AVERAGE_POPULARITY: 0.5122685, DIVERSITY_MEAN_INTER_LIST: 0.9227005, DIVERSITY_HERFINDAHL: 0.9922633, COVERAGE_ITEM: 0.0854975, COVERAGE_ITEM_CORRECT: 0.0572014, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9131868, DIVERSITY_GINI: 0.0122350, SHANNON_ENTROPY: 8.0231139, RATIO_DIVERSITY_HERFINDAHL: 0.9926463, RATIO_DIVERSITY_GINI: 0.0493435, RATIO_SHANNON_ENTROPY: 0.6475357, RATIO_AVERAGE_POPULARITY: 2.5204869, RATIO_NOVELTY: 0.0248977, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 135 of 500. Elapsed time 31.44 min\n",
      "LightFMItemHybridRecommender: Epoch 136 of 500. Elapsed time 31.55 min\n",
      "LightFMItemHybridRecommender: Epoch 137 of 500. Elapsed time 31.66 min\n",
      "LightFMItemHybridRecommender: Epoch 138 of 500. Elapsed time 31.77 min\n",
      "LightFMItemHybridRecommender: Epoch 139 of 500. Elapsed time 31.89 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.89 sec. Users per second: 360\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2819902, PRECISION_RECALL_MIN_DEN: 0.2835646, RECALL: 0.0615905, MAP: 0.1567984, MAP_MIN_DEN: 0.1574742, MRR: 0.5322994, NDCG: 0.2966794, F1: 0.1010995, HIT_RATE: 0.9143507, ARHR_ALL_HITS: 0.9029281, NOVELTY: 0.0056206, AVERAGE_POPULARITY: 0.5128798, DIVERSITY_MEAN_INTER_LIST: 0.9226660, DIVERSITY_HERFINDAHL: 0.9922598, COVERAGE_ITEM: 0.0857190, COVERAGE_ITEM_CORRECT: 0.0577551, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134799, DIVERSITY_GINI: 0.0122145, SHANNON_ENTROPY: 8.0202270, RATIO_DIVERSITY_HERFINDAHL: 0.9926428, RATIO_DIVERSITY_GINI: 0.0492607, RATIO_SHANNON_ENTROPY: 0.6473027, RATIO_AVERAGE_POPULARITY: 2.5234948, RATIO_NOVELTY: 0.0248890, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 140 of 500. Elapsed time 32.63 min\n",
      "LightFMItemHybridRecommender: Epoch 141 of 500. Elapsed time 32.74 min\n",
      "LightFMItemHybridRecommender: Epoch 142 of 500. Elapsed time 32.86 min\n",
      "LightFMItemHybridRecommender: Epoch 143 of 500. Elapsed time 32.97 min\n",
      "LightFMItemHybridRecommender: Epoch 144 of 500. Elapsed time 33.08 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.40 sec. Users per second: 355\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2813082, PRECISION_RECALL_MIN_DEN: 0.2828865, RECALL: 0.0614216, MAP: 0.1566147, MAP_MIN_DEN: 0.1573056, MRR: 0.5340749, NDCG: 0.2964480, F1: 0.1008282, HIT_RATE: 0.9138374, ARHR_ALL_HITS: 0.9035771, NOVELTY: 0.0056229, AVERAGE_POPULARITY: 0.5117363, DIVERSITY_MEAN_INTER_LIST: 0.9232884, DIVERSITY_HERFINDAHL: 0.9923221, COVERAGE_ITEM: 0.0854975, COVERAGE_ITEM_CORRECT: 0.0576998, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9129670, DIVERSITY_GINI: 0.0122513, SHANNON_ENTROPY: 8.0274374, RATIO_DIVERSITY_HERFINDAHL: 0.9927051, RATIO_DIVERSITY_GINI: 0.0494091, RATIO_SHANNON_ENTROPY: 0.6478847, RATIO_AVERAGE_POPULARITY: 2.5178686, RATIO_NOVELTY: 0.0248994, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 145 of 500. Elapsed time 33.83 min\n",
      "LightFMItemHybridRecommender: Epoch 146 of 500. Elapsed time 33.94 min\n",
      "LightFMItemHybridRecommender: Epoch 147 of 500. Elapsed time 34.06 min\n",
      "LightFMItemHybridRecommender: Epoch 148 of 500. Elapsed time 34.18 min\n",
      "LightFMItemHybridRecommender: Epoch 149 of 500. Elapsed time 34.29 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.40 sec. Users per second: 365\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2819902, PRECISION_RECALL_MIN_DEN: 0.2836126, RECALL: 0.0617048, MAP: 0.1570358, MAP_MIN_DEN: 0.1576786, MRR: 0.5356069, NDCG: 0.2971945, F1: 0.1012534, HIT_RATE: 0.9142773, ARHR_ALL_HITS: 0.9061479, NOVELTY: 0.0056227, AVERAGE_POPULARITY: 0.5122292, DIVERSITY_MEAN_INTER_LIST: 0.9227188, DIVERSITY_HERFINDAHL: 0.9922651, COVERAGE_ITEM: 0.0857744, COVERAGE_ITEM_CORRECT: 0.0578659, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134066, DIVERSITY_GINI: 0.0122653, SHANNON_ENTROPY: 8.0255982, RATIO_DIVERSITY_HERFINDAHL: 0.9926481, RATIO_DIVERSITY_GINI: 0.0494656, RATIO_SHANNON_ENTROPY: 0.6477363, RATIO_AVERAGE_POPULARITY: 2.5202938, RATIO_NOVELTY: 0.0248987, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 150 of 500. Elapsed time 35.03 min\n",
      "LightFMItemHybridRecommender: Epoch 151 of 500. Elapsed time 35.14 min\n",
      "LightFMItemHybridRecommender: Epoch 152 of 500. Elapsed time 35.25 min\n",
      "LightFMItemHybridRecommender: Epoch 153 of 500. Elapsed time 35.36 min\n",
      "LightFMItemHybridRecommender: Epoch 154 of 500. Elapsed time 35.47 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.98 sec. Users per second: 359\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2819168, PRECISION_RECALL_MIN_DEN: 0.2835704, RECALL: 0.0615180, MAP: 0.1567066, MAP_MIN_DEN: 0.1573606, MRR: 0.5329070, NDCG: 0.2965572, F1: 0.1009971, HIT_RATE: 0.9133240, ARHR_ALL_HITS: 0.9027201, NOVELTY: 0.0056268, AVERAGE_POPULARITY: 0.5097862, DIVERSITY_MEAN_INTER_LIST: 0.9239719, DIVERSITY_HERFINDAHL: 0.9923904, COVERAGE_ITEM: 0.0866050, COVERAGE_ITEM_CORRECT: 0.0579766, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9124542, DIVERSITY_GINI: 0.0123514, SHANNON_ENTROPY: 8.0393820, RATIO_DIVERSITY_HERFINDAHL: 0.9927734, RATIO_DIVERSITY_GINI: 0.0498129, RATIO_SHANNON_ENTROPY: 0.6488487, RATIO_AVERAGE_POPULARITY: 2.5082733, RATIO_NOVELTY: 0.0249169, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 155 of 500. Elapsed time 36.22 min\n",
      "LightFMItemHybridRecommender: Epoch 156 of 500. Elapsed time 36.33 min\n",
      "LightFMItemHybridRecommender: Epoch 157 of 500. Elapsed time 36.44 min\n",
      "LightFMItemHybridRecommender: Epoch 158 of 500. Elapsed time 36.55 min\n",
      "LightFMItemHybridRecommender: Epoch 159 of 500. Elapsed time 36.67 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.98 sec. Users per second: 350\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2820635, PRECISION_RECALL_MIN_DEN: 0.2836840, RECALL: 0.0616017, MAP: 0.1569836, MAP_MIN_DEN: 0.1576376, MRR: 0.5351850, NDCG: 0.2970745, F1: 0.1011193, HIT_RATE: 0.9139107, ARHR_ALL_HITS: 0.9052686, NOVELTY: 0.0056261, AVERAGE_POPULARITY: 0.5103331, DIVERSITY_MEAN_INTER_LIST: 0.9237645, DIVERSITY_HERFINDAHL: 0.9923697, COVERAGE_ITEM: 0.0863835, COVERAGE_ITEM_CORRECT: 0.0582535, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9130403, DIVERSITY_GINI: 0.0124130, SHANNON_ENTROPY: 8.0444235, RATIO_DIVERSITY_HERFINDAHL: 0.9927527, RATIO_DIVERSITY_GINI: 0.0500611, RATIO_SHANNON_ENTROPY: 0.6492556, RATIO_AVERAGE_POPULARITY: 2.5109644, RATIO_NOVELTY: 0.0249137, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 160 of 500. Elapsed time 37.43 min\n",
      "LightFMItemHybridRecommender: Epoch 161 of 500. Elapsed time 37.54 min\n",
      "LightFMItemHybridRecommender: Epoch 162 of 500. Elapsed time 37.66 min\n",
      "LightFMItemHybridRecommender: Epoch 163 of 500. Elapsed time 37.77 min\n",
      "LightFMItemHybridRecommender: Epoch 164 of 500. Elapsed time 37.88 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.99 sec. Users per second: 359\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2818142, PRECISION_RECALL_MIN_DEN: 0.2833645, RECALL: 0.0613905, MAP: 0.1568564, MAP_MIN_DEN: 0.1575074, MRR: 0.5333043, NDCG: 0.2967348, F1: 0.1008186, HIT_RATE: 0.9142040, ARHR_ALL_HITS: 0.9039128, NOVELTY: 0.0056240, AVERAGE_POPULARITY: 0.5113787, DIVERSITY_MEAN_INTER_LIST: 0.9234498, DIVERSITY_HERFINDAHL: 0.9923382, COVERAGE_ITEM: 0.0868265, COVERAGE_ITEM_CORRECT: 0.0580874, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9133333, DIVERSITY_GINI: 0.0124050, SHANNON_ENTROPY: 8.0401481, RATIO_DIVERSITY_HERFINDAHL: 0.9927212, RATIO_DIVERSITY_GINI: 0.0500289, RATIO_SHANNON_ENTROPY: 0.6489106, RATIO_AVERAGE_POPULARITY: 2.5161091, RATIO_NOVELTY: 0.0249044, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 165 of 500. Elapsed time 38.63 min\n",
      "LightFMItemHybridRecommender: Epoch 166 of 500. Elapsed time 38.74 min\n",
      "LightFMItemHybridRecommender: Epoch 167 of 500. Elapsed time 38.86 min\n",
      "LightFMItemHybridRecommender: Epoch 168 of 500. Elapsed time 38.97 min\n",
      "LightFMItemHybridRecommender: Epoch 169 of 500. Elapsed time 39.09 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.52 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2821002, PRECISION_RECALL_MIN_DEN: 0.2836660, RECALL: 0.0615501, MAP: 0.1567417, MAP_MIN_DEN: 0.1574029, MRR: 0.5330028, NDCG: 0.2967326, F1: 0.1010521, HIT_RATE: 0.9142773, ARHR_ALL_HITS: 0.9031347, NOVELTY: 0.0056265, AVERAGE_POPULARITY: 0.5097330, DIVERSITY_MEAN_INTER_LIST: 0.9243087, DIVERSITY_HERFINDAHL: 0.9924241, COVERAGE_ITEM: 0.0871034, COVERAGE_ITEM_CORRECT: 0.0581981, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134066, DIVERSITY_GINI: 0.0124520, SHANNON_ENTROPY: 8.0495877, RATIO_DIVERSITY_HERFINDAHL: 0.9928071, RATIO_DIVERSITY_GINI: 0.0502184, RATIO_SHANNON_ENTROPY: 0.6496724, RATIO_AVERAGE_POPULARITY: 2.5080117, RATIO_NOVELTY: 0.0249153, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 170 of 500. Elapsed time 39.83 min\n",
      "LightFMItemHybridRecommender: Epoch 171 of 500. Elapsed time 39.94 min\n",
      "LightFMItemHybridRecommender: Epoch 172 of 500. Elapsed time 40.04 min\n",
      "LightFMItemHybridRecommender: Epoch 173 of 500. Elapsed time 40.15 min\n",
      "LightFMItemHybridRecommender: Epoch 174 of 500. Elapsed time 40.26 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.82 sec. Users per second: 351\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2823935, PRECISION_RECALL_MIN_DEN: 0.2839717, RECALL: 0.0615861, MAP: 0.1572792, MAP_MIN_DEN: 0.1579209, MRR: 0.5355129, NDCG: 0.2974130, F1: 0.1011195, HIT_RATE: 0.9142773, ARHR_ALL_HITS: 0.9064021, NOVELTY: 0.0056242, AVERAGE_POPULARITY: 0.5116291, DIVERSITY_MEAN_INTER_LIST: 0.9231032, DIVERSITY_HERFINDAHL: 0.9923035, COVERAGE_ITEM: 0.0868819, COVERAGE_ITEM_CORRECT: 0.0588072, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134066, DIVERSITY_GINI: 0.0124031, SHANNON_ENTROPY: 8.0377049, RATIO_DIVERSITY_HERFINDAHL: 0.9926865, RATIO_DIVERSITY_GINI: 0.0500214, RATIO_SHANNON_ENTROPY: 0.6487134, RATIO_AVERAGE_POPULARITY: 2.5173410, RATIO_NOVELTY: 0.0249051, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 175 of 500. Elapsed time 41.02 min\n",
      "LightFMItemHybridRecommender: Epoch 176 of 500. Elapsed time 41.12 min\n",
      "LightFMItemHybridRecommender: Epoch 177 of 500. Elapsed time 41.23 min\n",
      "LightFMItemHybridRecommender: Epoch 178 of 500. Elapsed time 41.34 min\n",
      "LightFMItemHybridRecommender: Epoch 179 of 500. Elapsed time 41.45 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.61 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2824815, PRECISION_RECALL_MIN_DEN: 0.2840787, RECALL: 0.0616396, MAP: 0.1573029, MAP_MIN_DEN: 0.1580029, MRR: 0.5350159, NDCG: 0.2974776, F1: 0.1011972, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9063034, NOVELTY: 0.0056251, AVERAGE_POPULARITY: 0.5112088, DIVERSITY_MEAN_INTER_LIST: 0.9233019, DIVERSITY_HERFINDAHL: 0.9923234, COVERAGE_ITEM: 0.0874356, COVERAGE_ITEM_CORRECT: 0.0584750, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0124617, SHANNON_ENTROPY: 8.0433304, RATIO_DIVERSITY_HERFINDAHL: 0.9927064, RATIO_DIVERSITY_GINI: 0.0502575, RATIO_SHANNON_ENTROPY: 0.6491674, RATIO_AVERAGE_POPULARITY: 2.5152730, RATIO_NOVELTY: 0.0249090, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 180 of 500. Elapsed time 42.19 min\n",
      "LightFMItemHybridRecommender: Epoch 181 of 500. Elapsed time 42.31 min\n",
      "LightFMItemHybridRecommender: Epoch 182 of 500. Elapsed time 42.42 min\n",
      "LightFMItemHybridRecommender: Epoch 183 of 500. Elapsed time 42.54 min\n",
      "LightFMItemHybridRecommender: Epoch 184 of 500. Elapsed time 42.65 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.43 sec. Users per second: 337\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825841, PRECISION_RECALL_MIN_DEN: 0.2842464, RECALL: 0.0617252, MAP: 0.1571948, MAP_MIN_DEN: 0.1578606, MRR: 0.5348434, NDCG: 0.2974317, F1: 0.1013192, HIT_RATE: 0.9144240, ARHR_ALL_HITS: 0.9057773, NOVELTY: 0.0056266, AVERAGE_POPULARITY: 0.5104579, DIVERSITY_MEAN_INTER_LIST: 0.9236804, DIVERSITY_HERFINDAHL: 0.9923613, COVERAGE_ITEM: 0.0876017, COVERAGE_ITEM_CORRECT: 0.0586411, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9135531, DIVERSITY_GINI: 0.0125074, SHANNON_ENTROPY: 8.0505011, RATIO_DIVERSITY_HERFINDAHL: 0.9927443, RATIO_DIVERSITY_GINI: 0.0504419, RATIO_SHANNON_ENTROPY: 0.6497461, RATIO_AVERAGE_POPULARITY: 2.5115786, RATIO_NOVELTY: 0.0249159, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 185 of 500. Elapsed time 43.45 min\n",
      "LightFMItemHybridRecommender: Epoch 186 of 500. Elapsed time 43.57 min\n",
      "LightFMItemHybridRecommender: Epoch 187 of 500. Elapsed time 43.68 min\n",
      "LightFMItemHybridRecommender: Epoch 188 of 500. Elapsed time 43.79 min\n",
      "LightFMItemHybridRecommender: Epoch 189 of 500. Elapsed time 43.90 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.41 sec. Users per second: 355\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2817995, PRECISION_RECALL_MIN_DEN: 0.2833625, RECALL: 0.0613736, MAP: 0.1563194, MAP_MIN_DEN: 0.1569471, MRR: 0.5303187, NDCG: 0.2959881, F1: 0.1007949, HIT_RATE: 0.9136174, ARHR_ALL_HITS: 0.8998043, NOVELTY: 0.0056304, AVERAGE_POPULARITY: 0.5079644, DIVERSITY_MEAN_INTER_LIST: 0.9252628, DIVERSITY_HERFINDAHL: 0.9925195, COVERAGE_ITEM: 0.0879894, COVERAGE_ITEM_CORRECT: 0.0584196, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9127473, DIVERSITY_GINI: 0.0126154, SHANNON_ENTROPY: 8.0675314, RATIO_DIVERSITY_HERFINDAHL: 0.9929026, RATIO_DIVERSITY_GINI: 0.0508774, RATIO_SHANNON_ENTROPY: 0.6511206, RATIO_AVERAGE_POPULARITY: 2.4993097, RATIO_NOVELTY: 0.0249328, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 190 of 500. Elapsed time 44.64 min\n",
      "LightFMItemHybridRecommender: Epoch 191 of 500. Elapsed time 44.76 min\n",
      "LightFMItemHybridRecommender: Epoch 192 of 500. Elapsed time 44.87 min\n",
      "LightFMItemHybridRecommender: Epoch 193 of 500. Elapsed time 44.99 min\n",
      "LightFMItemHybridRecommender: Epoch 194 of 500. Elapsed time 45.10 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.88 sec. Users per second: 360\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2823788, PRECISION_RECALL_MIN_DEN: 0.2840304, RECALL: 0.0616770, MAP: 0.1572720, MAP_MIN_DEN: 0.1579714, MRR: 0.5350132, NDCG: 0.2974394, F1: 0.1012410, HIT_RATE: 0.9140573, ARHR_ALL_HITS: 0.9062505, NOVELTY: 0.0056297, AVERAGE_POPULARITY: 0.5091283, DIVERSITY_MEAN_INTER_LIST: 0.9242696, DIVERSITY_HERFINDAHL: 0.9924202, COVERAGE_ITEM: 0.0881555, COVERAGE_ITEM_CORRECT: 0.0585304, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9131868, DIVERSITY_GINI: 0.0126153, SHANNON_ENTROPY: 8.0631434, RATIO_DIVERSITY_HERFINDAHL: 0.9928032, RATIO_DIVERSITY_GINI: 0.0508771, RATIO_SHANNON_ENTROPY: 0.6507665, RATIO_AVERAGE_POPULARITY: 2.5050364, RATIO_NOVELTY: 0.0249296, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 195 of 500. Elapsed time 45.84 min\n",
      "LightFMItemHybridRecommender: Epoch 196 of 500. Elapsed time 45.96 min\n",
      "LightFMItemHybridRecommender: Epoch 197 of 500. Elapsed time 46.07 min\n",
      "LightFMItemHybridRecommender: Epoch 198 of 500. Elapsed time 46.19 min\n",
      "LightFMItemHybridRecommender: Epoch 199 of 500. Elapsed time 46.30 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.77 sec. Users per second: 352\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825841, PRECISION_RECALL_MIN_DEN: 0.2842384, RECALL: 0.0616378, MAP: 0.1566855, MAP_MIN_DEN: 0.1573271, MRR: 0.5318904, NDCG: 0.2967088, F1: 0.1012014, HIT_RATE: 0.9144973, ARHR_ALL_HITS: 0.9017920, NOVELTY: 0.0056300, AVERAGE_POPULARITY: 0.5077996, DIVERSITY_MEAN_INTER_LIST: 0.9255934, DIVERSITY_HERFINDAHL: 0.9925525, COVERAGE_ITEM: 0.0878232, COVERAGE_ITEM_CORRECT: 0.0586411, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9136264, DIVERSITY_GINI: 0.0126075, SHANNON_ENTROPY: 8.0685722, RATIO_DIVERSITY_HERFINDAHL: 0.9929356, RATIO_DIVERSITY_GINI: 0.0508455, RATIO_SHANNON_ENTROPY: 0.6512046, RATIO_AVERAGE_POPULARITY: 2.4984991, RATIO_NOVELTY: 0.0249306, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 200 of 500. Elapsed time 47.06 min\n",
      "LightFMItemHybridRecommender: Epoch 201 of 500. Elapsed time 47.17 min\n",
      "LightFMItemHybridRecommender: Epoch 202 of 500. Elapsed time 47.28 min\n",
      "LightFMItemHybridRecommender: Epoch 203 of 500. Elapsed time 47.40 min\n",
      "LightFMItemHybridRecommender: Epoch 204 of 500. Elapsed time 47.51 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.48 sec. Users per second: 354\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832588, PRECISION_RECALL_MIN_DEN: 0.2849684, RECALL: 0.0618976, MAP: 0.1575666, MAP_MIN_DEN: 0.1582033, MRR: 0.5350440, NDCG: 0.2979908, F1: 0.1015947, HIT_RATE: 0.9150840, ARHR_ALL_HITS: 0.9072359, NOVELTY: 0.0056260, AVERAGE_POPULARITY: 0.5109833, DIVERSITY_MEAN_INTER_LIST: 0.9232410, DIVERSITY_HERFINDAHL: 0.9923173, COVERAGE_ITEM: 0.0887092, COVERAGE_ITEM_CORRECT: 0.0589734, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9142125, DIVERSITY_GINI: 0.0124767, SHANNON_ENTROPY: 8.0436209, RATIO_DIVERSITY_HERFINDAHL: 0.9927003, RATIO_DIVERSITY_GINI: 0.0503180, RATIO_SHANNON_ENTROPY: 0.6491908, RATIO_AVERAGE_POPULARITY: 2.5141634, RATIO_NOVELTY: 0.0249132, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 205 of 500. Elapsed time 48.27 min\n",
      "LightFMItemHybridRecommender: Epoch 206 of 500. Elapsed time 48.38 min\n",
      "LightFMItemHybridRecommender: Epoch 207 of 500. Elapsed time 48.50 min\n",
      "LightFMItemHybridRecommender: Epoch 208 of 500. Elapsed time 48.61 min\n",
      "LightFMItemHybridRecommender: Epoch 209 of 500. Elapsed time 48.72 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.66 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829508, PRECISION_RECALL_MIN_DEN: 0.2846033, RECALL: 0.0616131, MAP: 0.1574470, MAP_MIN_DEN: 0.1581193, MRR: 0.5360555, NDCG: 0.2978271, F1: 0.1011915, HIT_RATE: 0.9148640, ARHR_ALL_HITS: 0.9072757, NOVELTY: 0.0056288, AVERAGE_POPULARITY: 0.5095644, DIVERSITY_MEAN_INTER_LIST: 0.9240126, DIVERSITY_HERFINDAHL: 0.9923945, COVERAGE_ITEM: 0.0888754, COVERAGE_ITEM_CORRECT: 0.0593610, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9139927, DIVERSITY_GINI: 0.0125699, SHANNON_ENTROPY: 8.0570949, RATIO_DIVERSITY_HERFINDAHL: 0.9927775, RATIO_DIVERSITY_GINI: 0.0506939, RATIO_SHANNON_ENTROPY: 0.6502783, RATIO_AVERAGE_POPULARITY: 2.5071824, RATIO_NOVELTY: 0.0249256, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 210 of 500. Elapsed time 49.46 min\n",
      "LightFMItemHybridRecommender: Epoch 211 of 500. Elapsed time 49.57 min\n",
      "LightFMItemHybridRecommender: Epoch 212 of 500. Elapsed time 49.68 min\n",
      "LightFMItemHybridRecommender: Epoch 213 of 500. Elapsed time 49.80 min\n",
      "LightFMItemHybridRecommender: Epoch 214 of 500. Elapsed time 49.91 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.79 sec. Users per second: 352\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2821442, PRECISION_RECALL_MIN_DEN: 0.2837462, RECALL: 0.0613177, MAP: 0.1569574, MAP_MIN_DEN: 0.1575796, MRR: 0.5329011, NDCG: 0.2967924, F1: 0.1007415, HIT_RATE: 0.9137640, ARHR_ALL_HITS: 0.9035906, NOVELTY: 0.0056301, AVERAGE_POPULARITY: 0.5082510, DIVERSITY_MEAN_INTER_LIST: 0.9250144, DIVERSITY_HERFINDAHL: 0.9924947, COVERAGE_ITEM: 0.0890415, COVERAGE_ITEM_CORRECT: 0.0595271, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128938, DIVERSITY_GINI: 0.0126177, SHANNON_ENTROPY: 8.0666582, RATIO_DIVERSITY_HERFINDAHL: 0.9928777, RATIO_DIVERSITY_GINI: 0.0508869, RATIO_SHANNON_ENTROPY: 0.6510502, RATIO_AVERAGE_POPULARITY: 2.5007200, RATIO_NOVELTY: 0.0249313, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 215 of 500. Elapsed time 50.67 min\n",
      "LightFMItemHybridRecommender: Epoch 216 of 500. Elapsed time 50.79 min\n",
      "LightFMItemHybridRecommender: Epoch 217 of 500. Elapsed time 50.90 min\n",
      "LightFMItemHybridRecommender: Epoch 218 of 500. Elapsed time 51.02 min\n",
      "LightFMItemHybridRecommender: Epoch 219 of 500. Elapsed time 51.13 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.81 sec. Users per second: 334\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825475, PRECISION_RECALL_MIN_DEN: 0.2841655, RECALL: 0.0615456, MAP: 0.1570822, MAP_MIN_DEN: 0.1577153, MRR: 0.5341668, NDCG: 0.2972162, F1: 0.1010747, HIT_RATE: 0.9145707, ARHR_ALL_HITS: 0.9048571, NOVELTY: 0.0056284, AVERAGE_POPULARITY: 0.5091543, DIVERSITY_MEAN_INTER_LIST: 0.9247288, DIVERSITY_HERFINDAHL: 0.9924661, COVERAGE_ITEM: 0.0890415, COVERAGE_ITEM_CORRECT: 0.0594717, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9136996, DIVERSITY_GINI: 0.0125891, SHANNON_ENTROPY: 8.0618828, RATIO_DIVERSITY_HERFINDAHL: 0.9928492, RATIO_DIVERSITY_GINI: 0.0507713, RATIO_SHANNON_ENTROPY: 0.6506647, RATIO_AVERAGE_POPULARITY: 2.5051644, RATIO_NOVELTY: 0.0249236, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 220 of 500. Elapsed time 51.93 min\n",
      "LightFMItemHybridRecommender: Epoch 221 of 500. Elapsed time 52.04 min\n",
      "LightFMItemHybridRecommender: Epoch 222 of 500. Elapsed time 52.16 min\n",
      "LightFMItemHybridRecommender: Epoch 223 of 500. Elapsed time 52.27 min\n",
      "LightFMItemHybridRecommender: Epoch 224 of 500. Elapsed time 52.38 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.05 sec. Users per second: 349\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2823275, PRECISION_RECALL_MIN_DEN: 0.2839713, RECALL: 0.0614713, MAP: 0.1569794, MAP_MIN_DEN: 0.1576119, MRR: 0.5340291, NDCG: 0.2970686, F1: 0.1009604, HIT_RATE: 0.9135440, ARHR_ALL_HITS: 0.9046188, NOVELTY: 0.0056304, AVERAGE_POPULARITY: 0.5084804, DIVERSITY_MEAN_INTER_LIST: 0.9249529, DIVERSITY_HERFINDAHL: 0.9924885, COVERAGE_ITEM: 0.0898167, COVERAGE_ITEM_CORRECT: 0.0593610, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126740, DIVERSITY_GINI: 0.0126457, SHANNON_ENTROPY: 8.0677941, RATIO_DIVERSITY_HERFINDAHL: 0.9928716, RATIO_DIVERSITY_GINI: 0.0509997, RATIO_SHANNON_ENTROPY: 0.6511418, RATIO_AVERAGE_POPULARITY: 2.5018487, RATIO_NOVELTY: 0.0249325, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 225 of 500. Elapsed time 53.14 min\n",
      "LightFMItemHybridRecommender: Epoch 226 of 500. Elapsed time 53.27 min\n",
      "LightFMItemHybridRecommender: Epoch 227 of 500. Elapsed time 53.39 min\n",
      "LightFMItemHybridRecommender: Epoch 228 of 500. Elapsed time 53.51 min\n",
      "LightFMItemHybridRecommender: Epoch 229 of 500. Elapsed time 53.64 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.11 sec. Users per second: 340\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2824815, PRECISION_RECALL_MIN_DEN: 0.2841558, RECALL: 0.0616286, MAP: 0.1572709, MAP_MIN_DEN: 0.1579634, MRR: 0.5355954, NDCG: 0.2975307, F1: 0.1011823, HIT_RATE: 0.9151573, ARHR_ALL_HITS: 0.9066245, NOVELTY: 0.0056305, AVERAGE_POPULARITY: 0.5088286, DIVERSITY_MEAN_INTER_LIST: 0.9244131, DIVERSITY_HERFINDAHL: 0.9924345, COVERAGE_ITEM: 0.0893737, COVERAGE_ITEM_CORRECT: 0.0591395, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9142857, DIVERSITY_GINI: 0.0126259, SHANNON_ENTROPY: 8.0640127, RATIO_DIVERSITY_HERFINDAHL: 0.9928176, RATIO_DIVERSITY_GINI: 0.0509200, RATIO_SHANNON_ENTROPY: 0.6508366, RATIO_AVERAGE_POPULARITY: 2.5035618, RATIO_NOVELTY: 0.0249332, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 230 of 500. Elapsed time 54.44 min\n",
      "LightFMItemHybridRecommender: Epoch 231 of 500. Elapsed time 54.55 min\n",
      "LightFMItemHybridRecommender: Epoch 232 of 500. Elapsed time 54.66 min\n",
      "LightFMItemHybridRecommender: Epoch 233 of 500. Elapsed time 54.78 min\n",
      "LightFMItemHybridRecommender: Epoch 234 of 500. Elapsed time 54.89 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.63 sec. Users per second: 353\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825108, PRECISION_RECALL_MIN_DEN: 0.2841901, RECALL: 0.0615581, MAP: 0.1570766, MAP_MIN_DEN: 0.1577679, MRR: 0.5341906, NDCG: 0.2972909, F1: 0.1010893, HIT_RATE: 0.9136907, ARHR_ALL_HITS: 0.9050763, NOVELTY: 0.0056305, AVERAGE_POPULARITY: 0.5085975, DIVERSITY_MEAN_INTER_LIST: 0.9246311, DIVERSITY_HERFINDAHL: 0.9924563, COVERAGE_ITEM: 0.0895398, COVERAGE_ITEM_CORRECT: 0.0594164, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128205, DIVERSITY_GINI: 0.0126619, SHANNON_ENTROPY: 8.0681939, RATIO_DIVERSITY_HERFINDAHL: 0.9928394, RATIO_DIVERSITY_GINI: 0.0510652, RATIO_SHANNON_ENTROPY: 0.6511741, RATIO_AVERAGE_POPULARITY: 2.5024249, RATIO_NOVELTY: 0.0249332, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 235 of 500. Elapsed time 55.65 min\n",
      "LightFMItemHybridRecommender: Epoch 236 of 500. Elapsed time 55.77 min\n",
      "LightFMItemHybridRecommender: Epoch 237 of 500. Elapsed time 55.88 min\n",
      "LightFMItemHybridRecommender: Epoch 238 of 500. Elapsed time 55.99 min\n",
      "LightFMItemHybridRecommender: Epoch 239 of 500. Elapsed time 56.10 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.34 sec. Users per second: 347\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2826061, PRECISION_RECALL_MIN_DEN: 0.2842506, RECALL: 0.0615932, MAP: 0.1570691, MAP_MIN_DEN: 0.1577416, MRR: 0.5343318, NDCG: 0.2972542, F1: 0.1011426, HIT_RATE: 0.9139107, ARHR_ALL_HITS: 0.9048831, NOVELTY: 0.0056311, AVERAGE_POPULARITY: 0.5081893, DIVERSITY_MEAN_INTER_LIST: 0.9249430, DIVERSITY_HERFINDAHL: 0.9924875, COVERAGE_ITEM: 0.0898167, COVERAGE_ITEM_CORRECT: 0.0598040, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9130403, DIVERSITY_GINI: 0.0126861, SHANNON_ENTROPY: 8.0707466, RATIO_DIVERSITY_HERFINDAHL: 0.9928706, RATIO_DIVERSITY_GINI: 0.0511625, RATIO_SHANNON_ENTROPY: 0.6513801, RATIO_AVERAGE_POPULARITY: 2.5004164, RATIO_NOVELTY: 0.0249358, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 240 of 500. Elapsed time 56.87 min\n",
      "LightFMItemHybridRecommender: Epoch 241 of 500. Elapsed time 56.97 min\n",
      "LightFMItemHybridRecommender: Epoch 242 of 500. Elapsed time 57.08 min\n",
      "LightFMItemHybridRecommender: Epoch 243 of 500. Elapsed time 57.19 min\n",
      "LightFMItemHybridRecommender: Epoch 244 of 500. Elapsed time 57.30 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.13 sec. Users per second: 358\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2820268, PRECISION_RECALL_MIN_DEN: 0.2836258, RECALL: 0.0614090, MAP: 0.1566866, MAP_MIN_DEN: 0.1573332, MRR: 0.5320373, NDCG: 0.2965311, F1: 0.1008572, HIT_RATE: 0.9133240, ARHR_ALL_HITS: 0.9023254, NOVELTY: 0.0056353, AVERAGE_POPULARITY: 0.5064897, DIVERSITY_MEAN_INTER_LIST: 0.9255015, DIVERSITY_HERFINDAHL: 0.9925434, COVERAGE_ITEM: 0.0902597, COVERAGE_ITEM_CORRECT: 0.0600808, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9124542, DIVERSITY_GINI: 0.0128099, SHANNON_ENTROPY: 8.0832932, RATIO_DIVERSITY_HERFINDAHL: 0.9929264, RATIO_DIVERSITY_GINI: 0.0516619, RATIO_SHANNON_ENTROPY: 0.6523927, RATIO_AVERAGE_POPULARITY: 2.4920538, RATIO_NOVELTY: 0.0249545, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 245 of 500. Elapsed time 58.06 min\n",
      "LightFMItemHybridRecommender: Epoch 246 of 500. Elapsed time 58.16 min\n",
      "LightFMItemHybridRecommender: Epoch 247 of 500. Elapsed time 58.27 min\n",
      "LightFMItemHybridRecommender: Epoch 248 of 500. Elapsed time 58.38 min\n",
      "LightFMItemHybridRecommender: Epoch 249 of 500. Elapsed time 58.49 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.00 sec. Users per second: 359\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2822615, PRECISION_RECALL_MIN_DEN: 0.2838988, RECALL: 0.0615110, MAP: 0.1568779, MAP_MIN_DEN: 0.1575041, MRR: 0.5329145, NDCG: 0.2968621, F1: 0.1010098, HIT_RATE: 0.9139107, ARHR_ALL_HITS: 0.9035448, NOVELTY: 0.0056318, AVERAGE_POPULARITY: 0.5084599, DIVERSITY_MEAN_INTER_LIST: 0.9245422, DIVERSITY_HERFINDAHL: 0.9924474, COVERAGE_ITEM: 0.0906473, COVERAGE_ITEM_CORRECT: 0.0599701, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9130403, DIVERSITY_GINI: 0.0127342, SHANNON_ENTROPY: 8.0714080, RATIO_DIVERSITY_HERFINDAHL: 0.9928305, RATIO_DIVERSITY_GINI: 0.0513565, RATIO_SHANNON_ENTROPY: 0.6514335, RATIO_AVERAGE_POPULARITY: 2.5017480, RATIO_NOVELTY: 0.0249387, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 250 of 500. Elapsed time 59.23 min\n",
      "LightFMItemHybridRecommender: Epoch 251 of 500. Elapsed time 59.34 min\n",
      "LightFMItemHybridRecommender: Epoch 252 of 500. Elapsed time 59.44 min\n",
      "LightFMItemHybridRecommender: Epoch 253 of 500. Elapsed time 59.55 min\n",
      "LightFMItemHybridRecommender: Epoch 254 of 500. Elapsed time 59.66 min\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.09 sec. Users per second: 368\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2827308, PRECISION_RECALL_MIN_DEN: 0.2843412, RECALL: 0.0615959, MAP: 0.1570544, MAP_MIN_DEN: 0.1576710, MRR: 0.5333736, NDCG: 0.2971670, F1: 0.1011543, HIT_RATE: 0.9142773, ARHR_ALL_HITS: 0.9042741, NOVELTY: 0.0056325, AVERAGE_POPULARITY: 0.5080943, DIVERSITY_MEAN_INTER_LIST: 0.9247561, DIVERSITY_HERFINDAHL: 0.9924688, COVERAGE_ITEM: 0.0905366, COVERAGE_ITEM_CORRECT: 0.0596932, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9134066, DIVERSITY_GINI: 0.0127458, SHANNON_ENTROPY: 8.0744480, RATIO_DIVERSITY_HERFINDAHL: 0.9928519, RATIO_DIVERSITY_GINI: 0.0514034, RATIO_SHANNON_ENTROPY: 0.6516789, RATIO_AVERAGE_POPULARITY: 2.4999489, RATIO_NOVELTY: 0.0249421, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 255 of 500. Elapsed time 1.01 hour\n",
      "LightFMItemHybridRecommender: Epoch 256 of 500. Elapsed time 1.01 hour\n",
      "LightFMItemHybridRecommender: Epoch 257 of 500. Elapsed time 1.01 hour\n",
      "LightFMItemHybridRecommender: Epoch 258 of 500. Elapsed time 1.01 hour\n",
      "LightFMItemHybridRecommender: Epoch 259 of 500. Elapsed time 1.01 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.93 sec. Users per second: 360\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825841, PRECISION_RECALL_MIN_DEN: 0.2842253, RECALL: 0.0616090, MAP: 0.1570479, MAP_MIN_DEN: 0.1576619, MRR: 0.5339625, NDCG: 0.2971301, F1: 0.1011626, HIT_RATE: 0.9139107, ARHR_ALL_HITS: 0.9044586, NOVELTY: 0.0056313, AVERAGE_POPULARITY: 0.5086242, DIVERSITY_MEAN_INTER_LIST: 0.9246811, DIVERSITY_HERFINDAHL: 0.9924613, COVERAGE_ITEM: 0.0908134, COVERAGE_ITEM_CORRECT: 0.0594717, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9130403, DIVERSITY_GINI: 0.0127519, SHANNON_ENTROPY: 8.0736874, RATIO_DIVERSITY_HERFINDAHL: 0.9928444, RATIO_DIVERSITY_GINI: 0.0514281, RATIO_SHANNON_ENTROPY: 0.6516175, RATIO_AVERAGE_POPULARITY: 2.5025559, RATIO_NOVELTY: 0.0249368, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 260 of 500. Elapsed time 1.03 hour\n",
      "LightFMItemHybridRecommender: Epoch 261 of 500. Elapsed time 1.03 hour\n",
      "LightFMItemHybridRecommender: Epoch 262 of 500. Elapsed time 1.03 hour\n",
      "LightFMItemHybridRecommender: Epoch 263 of 500. Elapsed time 1.03 hour\n",
      "LightFMItemHybridRecommender: Epoch 264 of 500. Elapsed time 1.03 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.19 sec. Users per second: 357\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825108, PRECISION_RECALL_MIN_DEN: 0.2841520, RECALL: 0.0615787, MAP: 0.1570340, MAP_MIN_DEN: 0.1576687, MRR: 0.5353098, NDCG: 0.2973110, F1: 0.1011170, HIT_RATE: 0.9127374, ARHR_ALL_HITS: 0.9056525, NOVELTY: 0.0056321, AVERAGE_POPULARITY: 0.5083580, DIVERSITY_MEAN_INTER_LIST: 0.9246183, DIVERSITY_HERFINDAHL: 0.9924551, COVERAGE_ITEM: 0.0907027, COVERAGE_ITEM_CORRECT: 0.0593056, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9118681, DIVERSITY_GINI: 0.0127502, SHANNON_ENTROPY: 8.0733557, RATIO_DIVERSITY_HERFINDAHL: 0.9928381, RATIO_DIVERSITY_GINI: 0.0514210, RATIO_SHANNON_ENTROPY: 0.6515907, RATIO_AVERAGE_POPULARITY: 2.5012462, RATIO_NOVELTY: 0.0249402, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 265 of 500. Elapsed time 1.05 hour\n",
      "LightFMItemHybridRecommender: Epoch 266 of 500. Elapsed time 1.05 hour\n",
      "LightFMItemHybridRecommender: Epoch 267 of 500. Elapsed time 1.05 hour\n",
      "LightFMItemHybridRecommender: Epoch 268 of 500. Elapsed time 1.05 hour\n",
      "LightFMItemHybridRecommender: Epoch 269 of 500. Elapsed time 1.05 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.69 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829435, PRECISION_RECALL_MIN_DEN: 0.2844961, RECALL: 0.0615805, MAP: 0.1571944, MAP_MIN_DEN: 0.1578056, MRR: 0.5339616, NDCG: 0.2974314, F1: 0.1011470, HIT_RATE: 0.9126641, ARHR_ALL_HITS: 0.9052506, NOVELTY: 0.0056306, AVERAGE_POPULARITY: 0.5090595, DIVERSITY_MEAN_INTER_LIST: 0.9240205, DIVERSITY_HERFINDAHL: 0.9923953, COVERAGE_ITEM: 0.0902043, COVERAGE_ITEM_CORRECT: 0.0590841, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9117949, DIVERSITY_GINI: 0.0127399, SHANNON_ENTROPY: 8.0694514, RATIO_DIVERSITY_HERFINDAHL: 0.9927783, RATIO_DIVERSITY_GINI: 0.0513795, RATIO_SHANNON_ENTROPY: 0.6512756, RATIO_AVERAGE_POPULARITY: 2.5046981, RATIO_NOVELTY: 0.0249334, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 270 of 500. Elapsed time 1.07 hour\n",
      "LightFMItemHybridRecommender: Epoch 271 of 500. Elapsed time 1.07 hour\n",
      "LightFMItemHybridRecommender: Epoch 272 of 500. Elapsed time 1.07 hour\n",
      "LightFMItemHybridRecommender: Epoch 273 of 500. Elapsed time 1.07 hour\n",
      "LightFMItemHybridRecommender: Epoch 274 of 500. Elapsed time 1.07 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.53 sec. Users per second: 354\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2827015, PRECISION_RECALL_MIN_DEN: 0.2842339, RECALL: 0.0614395, MAP: 0.1569752, MAP_MIN_DEN: 0.1575641, MRR: 0.5326415, NDCG: 0.2969959, F1: 0.1009415, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9034858, NOVELTY: 0.0056327, AVERAGE_POPULARITY: 0.5078895, DIVERSITY_MEAN_INTER_LIST: 0.9249534, DIVERSITY_HERFINDAHL: 0.9924886, COVERAGE_ITEM: 0.0910903, COVERAGE_ITEM_CORRECT: 0.0600255, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0128035, SHANNON_ENTROPY: 8.0798778, RATIO_DIVERSITY_HERFINDAHL: 0.9928716, RATIO_DIVERSITY_GINI: 0.0516360, RATIO_SHANNON_ENTROPY: 0.6521171, RATIO_AVERAGE_POPULARITY: 2.4989413, RATIO_NOVELTY: 0.0249428, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 275 of 500. Elapsed time 1.09 hour\n",
      "LightFMItemHybridRecommender: Epoch 276 of 500. Elapsed time 1.09 hour\n",
      "LightFMItemHybridRecommender: Epoch 277 of 500. Elapsed time 1.09 hour\n",
      "LightFMItemHybridRecommender: Epoch 278 of 500. Elapsed time 1.09 hour\n",
      "LightFMItemHybridRecommender: Epoch 279 of 500. Elapsed time 1.09 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.04 sec. Users per second: 349\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2827015, PRECISION_RECALL_MIN_DEN: 0.2842912, RECALL: 0.0615064, MAP: 0.1569152, MAP_MIN_DEN: 0.1575136, MRR: 0.5316568, NDCG: 0.2968514, F1: 0.1010317, HIT_RATE: 0.9145707, ARHR_ALL_HITS: 0.9025129, NOVELTY: 0.0056352, AVERAGE_POPULARITY: 0.5063161, DIVERSITY_MEAN_INTER_LIST: 0.9257988, DIVERSITY_HERFINDAHL: 0.9925731, COVERAGE_ITEM: 0.0910349, COVERAGE_ITEM_CORRECT: 0.0600255, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9136996, DIVERSITY_GINI: 0.0128580, SHANNON_ENTROPY: 8.0890820, RATIO_DIVERSITY_HERFINDAHL: 0.9929562, RATIO_DIVERSITY_GINI: 0.0518560, RATIO_SHANNON_ENTROPY: 0.6528600, RATIO_AVERAGE_POPULARITY: 2.4911999, RATIO_NOVELTY: 0.0249541, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 280 of 500. Elapsed time 1.11 hour\n",
      "LightFMItemHybridRecommender: Epoch 281 of 500. Elapsed time 1.11 hour\n",
      "LightFMItemHybridRecommender: Epoch 282 of 500. Elapsed time 1.11 hour\n",
      "LightFMItemHybridRecommender: Epoch 283 of 500. Elapsed time 1.11 hour\n",
      "LightFMItemHybridRecommender: Epoch 284 of 500. Elapsed time 1.11 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.43 sec. Users per second: 364\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2826721, PRECISION_RECALL_MIN_DEN: 0.2842978, RECALL: 0.0614714, MAP: 0.1569650, MAP_MIN_DEN: 0.1576032, MRR: 0.5332819, NDCG: 0.2970994, F1: 0.1009826, HIT_RATE: 0.9133974, ARHR_ALL_HITS: 0.9039149, NOVELTY: 0.0056355, AVERAGE_POPULARITY: 0.5062824, DIVERSITY_MEAN_INTER_LIST: 0.9260213, DIVERSITY_HERFINDAHL: 0.9925953, COVERAGE_ITEM: 0.0909242, COVERAGE_ITEM_CORRECT: 0.0598040, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9125275, DIVERSITY_GINI: 0.0128874, SHANNON_ENTROPY: 8.0939034, RATIO_DIVERSITY_HERFINDAHL: 0.9929784, RATIO_DIVERSITY_GINI: 0.0519743, RATIO_SHANNON_ENTROPY: 0.6532491, RATIO_AVERAGE_POPULARITY: 2.4910339, RATIO_NOVELTY: 0.0249551, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 285 of 500. Elapsed time 1.13 hour\n",
      "LightFMItemHybridRecommender: Epoch 286 of 500. Elapsed time 1.13 hour\n",
      "LightFMItemHybridRecommender: Epoch 287 of 500. Elapsed time 1.13 hour\n",
      "LightFMItemHybridRecommender: Epoch 288 of 500. Elapsed time 1.13 hour\n",
      "LightFMItemHybridRecommender: Epoch 289 of 500. Elapsed time 1.13 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.52 sec. Users per second: 354\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2827821, PRECISION_RECALL_MIN_DEN: 0.2843007, RECALL: 0.0614257, MAP: 0.1567763, MAP_MIN_DEN: 0.1573689, MRR: 0.5323058, NDCG: 0.2968265, F1: 0.1009280, HIT_RATE: 0.9147906, ARHR_ALL_HITS: 0.9023730, NOVELTY: 0.0056378, AVERAGE_POPULARITY: 0.5050330, DIVERSITY_MEAN_INTER_LIST: 0.9264904, DIVERSITY_HERFINDAHL: 0.9926422, COVERAGE_ITEM: 0.0909796, COVERAGE_ITEM_CORRECT: 0.0604131, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9139194, DIVERSITY_GINI: 0.0129083, SHANNON_ENTROPY: 8.0975518, RATIO_DIVERSITY_HERFINDAHL: 0.9930254, RATIO_DIVERSITY_GINI: 0.0520586, RATIO_SHANNON_ENTROPY: 0.6535435, RATIO_AVERAGE_POPULARITY: 2.4848867, RATIO_NOVELTY: 0.0249653, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 290 of 500. Elapsed time 1.15 hour\n",
      "LightFMItemHybridRecommender: Epoch 291 of 500. Elapsed time 1.15 hour\n",
      "LightFMItemHybridRecommender: Epoch 292 of 500. Elapsed time 1.15 hour\n",
      "LightFMItemHybridRecommender: Epoch 293 of 500. Elapsed time 1.15 hour\n",
      "LightFMItemHybridRecommender: Epoch 294 of 500. Elapsed time 1.15 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.92 sec. Users per second: 360\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830168, PRECISION_RECALL_MIN_DEN: 0.2846123, RECALL: 0.0615837, MAP: 0.1570846, MAP_MIN_DEN: 0.1577277, MRR: 0.5329533, NDCG: 0.2972448, F1: 0.1011561, HIT_RATE: 0.9140573, ARHR_ALL_HITS: 0.9037951, NOVELTY: 0.0056352, AVERAGE_POPULARITY: 0.5068933, DIVERSITY_MEAN_INTER_LIST: 0.9254928, DIVERSITY_HERFINDAHL: 0.9925425, COVERAGE_ITEM: 0.0912564, COVERAGE_ITEM_CORRECT: 0.0601916, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9131868, DIVERSITY_GINI: 0.0128861, SHANNON_ENTROPY: 8.0885201, RATIO_DIVERSITY_HERFINDAHL: 0.9929256, RATIO_DIVERSITY_GINI: 0.0519694, RATIO_SHANNON_ENTROPY: 0.6528146, RATIO_AVERAGE_POPULARITY: 2.4940396, RATIO_NOVELTY: 0.0249538, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 295 of 500. Elapsed time 1.16 hour\n",
      "LightFMItemHybridRecommender: Epoch 296 of 500. Elapsed time 1.17 hour\n",
      "LightFMItemHybridRecommender: Epoch 297 of 500. Elapsed time 1.17 hour\n",
      "LightFMItemHybridRecommender: Epoch 298 of 500. Elapsed time 1.17 hour\n",
      "LightFMItemHybridRecommender: Epoch 299 of 500. Elapsed time 1.17 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.52 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2833394, PRECISION_RECALL_MIN_DEN: 0.2848414, RECALL: 0.0615457, MAP: 0.1573926, MAP_MIN_DEN: 0.1579947, MRR: 0.5351043, NDCG: 0.2978700, F1: 0.1011254, HIT_RATE: 0.9144973, ARHR_ALL_HITS: 0.9067940, NOVELTY: 0.0056320, AVERAGE_POPULARITY: 0.5079871, DIVERSITY_MEAN_INTER_LIST: 0.9250401, DIVERSITY_HERFINDAHL: 0.9924972, COVERAGE_ITEM: 0.0911457, COVERAGE_ITEM_CORRECT: 0.0600255, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9136264, DIVERSITY_GINI: 0.0128059, SHANNON_ENTROPY: 8.0799740, RATIO_DIVERSITY_HERFINDAHL: 0.9928803, RATIO_DIVERSITY_GINI: 0.0516460, RATIO_SHANNON_ENTROPY: 0.6521249, RATIO_AVERAGE_POPULARITY: 2.4994216, RATIO_NOVELTY: 0.0249396, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 300 of 500. Elapsed time 1.18 hour\n",
      "LightFMItemHybridRecommender: Epoch 301 of 500. Elapsed time 1.19 hour\n",
      "LightFMItemHybridRecommender: Epoch 302 of 500. Elapsed time 1.19 hour\n",
      "LightFMItemHybridRecommender: Epoch 303 of 500. Elapsed time 1.19 hour\n",
      "LightFMItemHybridRecommender: Epoch 304 of 500. Elapsed time 1.19 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.70 sec. Users per second: 362\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830535, PRECISION_RECALL_MIN_DEN: 0.2845864, RECALL: 0.0615511, MAP: 0.1575549, MAP_MIN_DEN: 0.1582310, MRR: 0.5363578, NDCG: 0.2980113, F1: 0.1011144, HIT_RATE: 0.9135440, ARHR_ALL_HITS: 0.9080431, NOVELTY: 0.0056305, AVERAGE_POPULARITY: 0.5090904, DIVERSITY_MEAN_INTER_LIST: 0.9243385, DIVERSITY_HERFINDAHL: 0.9924271, COVERAGE_ITEM: 0.0912564, COVERAGE_ITEM_CORRECT: 0.0599147, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126740, DIVERSITY_GINI: 0.0127636, SHANNON_ENTROPY: 8.0718911, RATIO_DIVERSITY_HERFINDAHL: 0.9928101, RATIO_DIVERSITY_GINI: 0.0514753, RATIO_SHANNON_ENTROPY: 0.6514725, RATIO_AVERAGE_POPULARITY: 2.5048499, RATIO_NOVELTY: 0.0249330, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 305 of 500. Elapsed time 1.20 hour\n",
      "LightFMItemHybridRecommender: Epoch 306 of 500. Elapsed time 1.21 hour\n",
      "LightFMItemHybridRecommender: Epoch 307 of 500. Elapsed time 1.21 hour\n",
      "LightFMItemHybridRecommender: Epoch 308 of 500. Elapsed time 1.21 hour\n",
      "LightFMItemHybridRecommender: Epoch 309 of 500. Elapsed time 1.21 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.47 sec. Users per second: 354\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2836401, PRECISION_RECALL_MIN_DEN: 0.2851527, RECALL: 0.0616528, MAP: 0.1576066, MAP_MIN_DEN: 0.1582090, MRR: 0.5352105, NDCG: 0.2980628, F1: 0.1012891, HIT_RATE: 0.9144240, ARHR_ALL_HITS: 0.9071150, NOVELTY: 0.0056305, AVERAGE_POPULARITY: 0.5089692, DIVERSITY_MEAN_INTER_LIST: 0.9245179, DIVERSITY_HERFINDAHL: 0.9924450, COVERAGE_ITEM: 0.0914779, COVERAGE_ITEM_CORRECT: 0.0604131, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9135531, DIVERSITY_GINI: 0.0127854, SHANNON_ENTROPY: 8.0738404, RATIO_DIVERSITY_HERFINDAHL: 0.9928281, RATIO_DIVERSITY_GINI: 0.0515633, RATIO_SHANNON_ENTROPY: 0.6516298, RATIO_AVERAGE_POPULARITY: 2.5042537, RATIO_NOVELTY: 0.0249332, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 310 of 500. Elapsed time 1.22 hour\n",
      "LightFMItemHybridRecommender: Epoch 311 of 500. Elapsed time 1.23 hour\n",
      "LightFMItemHybridRecommender: Epoch 312 of 500. Elapsed time 1.23 hour\n",
      "LightFMItemHybridRecommender: Epoch 313 of 500. Elapsed time 1.23 hour\n",
      "LightFMItemHybridRecommender: Epoch 314 of 500. Elapsed time 1.23 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.81 sec. Users per second: 343\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2834201, PRECISION_RECALL_MIN_DEN: 0.2849062, RECALL: 0.0615186, MAP: 0.1575646, MAP_MIN_DEN: 0.1581746, MRR: 0.5351276, NDCG: 0.2979196, F1: 0.1010940, HIT_RATE: 0.9137640, ARHR_ALL_HITS: 0.9068501, NOVELTY: 0.0056334, AVERAGE_POPULARITY: 0.5078504, DIVERSITY_MEAN_INTER_LIST: 0.9249172, DIVERSITY_HERFINDAHL: 0.9924849, COVERAGE_ITEM: 0.0913672, COVERAGE_ITEM_CORRECT: 0.0603023, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128938, DIVERSITY_GINI: 0.0128644, SHANNON_ENTROPY: 8.0839004, RATIO_DIVERSITY_HERFINDAHL: 0.9928680, RATIO_DIVERSITY_GINI: 0.0518816, RATIO_SHANNON_ENTROPY: 0.6524417, RATIO_AVERAGE_POPULARITY: 2.4987489, RATIO_NOVELTY: 0.0249457, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 315 of 500. Elapsed time 1.25 hour\n",
      "LightFMItemHybridRecommender: Epoch 316 of 500. Elapsed time 1.25 hour\n",
      "LightFMItemHybridRecommender: Epoch 317 of 500. Elapsed time 1.25 hour\n",
      "LightFMItemHybridRecommender: Epoch 318 of 500. Elapsed time 1.25 hour\n",
      "LightFMItemHybridRecommender: Epoch 319 of 500. Elapsed time 1.25 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.43 sec. Users per second: 355\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2831855, PRECISION_RECALL_MIN_DEN: 0.2846318, RECALL: 0.0614630, MAP: 0.1573650, MAP_MIN_DEN: 0.1579698, MRR: 0.5355424, NDCG: 0.2977390, F1: 0.1010039, HIT_RATE: 0.9133974, ARHR_ALL_HITS: 0.9066096, NOVELTY: 0.0056352, AVERAGE_POPULARITY: 0.5068449, DIVERSITY_MEAN_INTER_LIST: 0.9254841, DIVERSITY_HERFINDAHL: 0.9925416, COVERAGE_ITEM: 0.0913118, COVERAGE_ITEM_CORRECT: 0.0599701, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9125275, DIVERSITY_GINI: 0.0128632, SHANNON_ENTROPY: 8.0881353, RATIO_DIVERSITY_HERFINDAHL: 0.9929247, RATIO_DIVERSITY_GINI: 0.0518767, RATIO_SHANNON_ENTROPY: 0.6527835, RATIO_AVERAGE_POPULARITY: 2.4938017, RATIO_NOVELTY: 0.0249539, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 320 of 500. Elapsed time 1.27 hour\n",
      "LightFMItemHybridRecommender: Epoch 321 of 500. Elapsed time 1.27 hour\n",
      "LightFMItemHybridRecommender: Epoch 322 of 500. Elapsed time 1.27 hour\n",
      "LightFMItemHybridRecommender: Epoch 323 of 500. Elapsed time 1.27 hour\n",
      "LightFMItemHybridRecommender: Epoch 324 of 500. Elapsed time 1.27 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.65 sec. Users per second: 353\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830168, PRECISION_RECALL_MIN_DEN: 0.2844983, RECALL: 0.0614319, MAP: 0.1573793, MAP_MIN_DEN: 0.1580654, MRR: 0.5354825, NDCG: 0.2977421, F1: 0.1009513, HIT_RATE: 0.9135440, ARHR_ALL_HITS: 0.9066545, NOVELTY: 0.0056342, AVERAGE_POPULARITY: 0.5074373, DIVERSITY_MEAN_INTER_LIST: 0.9250208, DIVERSITY_HERFINDAHL: 0.9924953, COVERAGE_ITEM: 0.0918102, COVERAGE_ITEM_CORRECT: 0.0602470, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126740, DIVERSITY_GINI: 0.0128813, SHANNON_ENTROPY: 8.0844235, RATIO_DIVERSITY_HERFINDAHL: 0.9928784, RATIO_DIVERSITY_GINI: 0.0519500, RATIO_SHANNON_ENTROPY: 0.6524840, RATIO_AVERAGE_POPULARITY: 2.4967164, RATIO_NOVELTY: 0.0249496, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 325 of 500. Elapsed time 1.29 hour\n",
      "LightFMItemHybridRecommender: Epoch 326 of 500. Elapsed time 1.29 hour\n",
      "LightFMItemHybridRecommender: Epoch 327 of 500. Elapsed time 1.29 hour\n",
      "LightFMItemHybridRecommender: Epoch 328 of 500. Elapsed time 1.29 hour\n",
      "LightFMItemHybridRecommender: Epoch 329 of 500. Elapsed time 1.29 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.97 sec. Users per second: 359\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2828775, PRECISION_RECALL_MIN_DEN: 0.2843764, RECALL: 0.0613824, MAP: 0.1572140, MAP_MIN_DEN: 0.1578458, MRR: 0.5340034, NDCG: 0.2974035, F1: 0.1008755, HIT_RATE: 0.9130307, ARHR_ALL_HITS: 0.9051795, NOVELTY: 0.0056341, AVERAGE_POPULARITY: 0.5074035, DIVERSITY_MEAN_INTER_LIST: 0.9251674, DIVERSITY_HERFINDAHL: 0.9925100, COVERAGE_ITEM: 0.0919209, COVERAGE_ITEM_CORRECT: 0.0603023, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9121612, DIVERSITY_GINI: 0.0128776, SHANNON_ENTROPY: 8.0846607, RATIO_DIVERSITY_HERFINDAHL: 0.9928930, RATIO_DIVERSITY_GINI: 0.0519351, RATIO_SHANNON_ENTROPY: 0.6525031, RATIO_AVERAGE_POPULARITY: 2.4965498, RATIO_NOVELTY: 0.0249492, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 330 of 500. Elapsed time 1.30 hour\n",
      "LightFMItemHybridRecommender: Epoch 331 of 500. Elapsed time 1.31 hour\n",
      "LightFMItemHybridRecommender: Epoch 332 of 500. Elapsed time 1.31 hour\n",
      "LightFMItemHybridRecommender: Epoch 333 of 500. Elapsed time 1.31 hour\n",
      "LightFMItemHybridRecommender: Epoch 334 of 500. Elapsed time 1.31 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 37.57 sec. Users per second: 363\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829508, PRECISION_RECALL_MIN_DEN: 0.2843531, RECALL: 0.0613711, MAP: 0.1574613, MAP_MIN_DEN: 0.1580830, MRR: 0.5351800, NDCG: 0.2976861, F1: 0.1008649, HIT_RATE: 0.9131041, ARHR_ALL_HITS: 0.9067421, NOVELTY: 0.0056328, AVERAGE_POPULARITY: 0.5078108, DIVERSITY_MEAN_INTER_LIST: 0.9251612, DIVERSITY_HERFINDAHL: 0.9925093, COVERAGE_ITEM: 0.0920870, COVERAGE_ITEM_CORRECT: 0.0601916, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9122344, DIVERSITY_GINI: 0.0128090, SHANNON_ENTROPY: 8.0791766, RATIO_DIVERSITY_HERFINDAHL: 0.9928924, RATIO_DIVERSITY_GINI: 0.0516584, RATIO_SHANNON_ENTROPY: 0.6520605, RATIO_AVERAGE_POPULARITY: 2.4985541, RATIO_NOVELTY: 0.0249432, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 335 of 500. Elapsed time 1.32 hour\n",
      "LightFMItemHybridRecommender: Epoch 336 of 500. Elapsed time 1.33 hour\n",
      "LightFMItemHybridRecommender: Epoch 337 of 500. Elapsed time 1.33 hour\n",
      "LightFMItemHybridRecommender: Epoch 338 of 500. Elapsed time 1.33 hour\n",
      "LightFMItemHybridRecommender: Epoch 339 of 500. Elapsed time 1.33 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.12 sec. Users per second: 340\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2833028, PRECISION_RECALL_MIN_DEN: 0.2848944, RECALL: 0.0616487, MAP: 0.1575342, MAP_MIN_DEN: 0.1581420, MRR: 0.5347925, NDCG: 0.2978330, F1: 0.1012620, HIT_RATE: 0.9129574, ARHR_ALL_HITS: 0.9065092, NOVELTY: 0.0056336, AVERAGE_POPULARITY: 0.5076950, DIVERSITY_MEAN_INTER_LIST: 0.9250952, DIVERSITY_HERFINDAHL: 0.9925027, COVERAGE_ITEM: 0.0915333, COVERAGE_ITEM_CORRECT: 0.0596932, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9120879, DIVERSITY_GINI: 0.0128350, SHANNON_ENTROPY: 8.0818074, RATIO_DIVERSITY_HERFINDAHL: 0.9928858, RATIO_DIVERSITY_GINI: 0.0517633, RATIO_SHANNON_ENTROPY: 0.6522728, RATIO_AVERAGE_POPULARITY: 2.4979843, RATIO_NOVELTY: 0.0249469, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 340 of 500. Elapsed time 1.34 hour\n",
      "LightFMItemHybridRecommender: Epoch 341 of 500. Elapsed time 1.35 hour\n",
      "LightFMItemHybridRecommender: Epoch 342 of 500. Elapsed time 1.35 hour\n",
      "LightFMItemHybridRecommender: Epoch 343 of 500. Elapsed time 1.35 hour\n",
      "LightFMItemHybridRecommender: Epoch 344 of 500. Elapsed time 1.35 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.14 sec. Users per second: 348\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2833468, PRECISION_RECALL_MIN_DEN: 0.2848669, RECALL: 0.0616133, MAP: 0.1572972, MAP_MIN_DEN: 0.1578912, MRR: 0.5352419, NDCG: 0.2977248, F1: 0.1012171, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9059953, NOVELTY: 0.0056351, AVERAGE_POPULARITY: 0.5070939, DIVERSITY_MEAN_INTER_LIST: 0.9252948, DIVERSITY_HERFINDAHL: 0.9925227, COVERAGE_ITEM: 0.0920870, COVERAGE_ITEM_CORRECT: 0.0603577, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0129145, SHANNON_ENTROPY: 8.0900147, RATIO_DIVERSITY_HERFINDAHL: 0.9929058, RATIO_DIVERSITY_GINI: 0.0520840, RATIO_SHANNON_ENTROPY: 0.6529352, RATIO_AVERAGE_POPULARITY: 2.4950266, RATIO_NOVELTY: 0.0249534, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 345 of 500. Elapsed time 1.36 hour\n",
      "LightFMItemHybridRecommender: Epoch 346 of 500. Elapsed time 1.37 hour\n",
      "LightFMItemHybridRecommender: Epoch 347 of 500. Elapsed time 1.37 hour\n",
      "LightFMItemHybridRecommender: Epoch 348 of 500. Elapsed time 1.37 hour\n",
      "LightFMItemHybridRecommender: Epoch 349 of 500. Elapsed time 1.37 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.41 sec. Users per second: 346\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2834128, PRECISION_RECALL_MIN_DEN: 0.2849245, RECALL: 0.0615959, MAP: 0.1576734, MAP_MIN_DEN: 0.1582795, MRR: 0.5359274, NDCG: 0.2981377, F1: 0.1011978, HIT_RATE: 0.9147906, ARHR_ALL_HITS: 0.9080503, NOVELTY: 0.0056331, AVERAGE_POPULARITY: 0.5079945, DIVERSITY_MEAN_INTER_LIST: 0.9248679, DIVERSITY_HERFINDAHL: 0.9924800, COVERAGE_ITEM: 0.0918656, COVERAGE_ITEM_CORRECT: 0.0605238, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9139194, DIVERSITY_GINI: 0.0128420, SHANNON_ENTROPY: 8.0796674, RATIO_DIVERSITY_HERFINDAHL: 0.9928631, RATIO_DIVERSITY_GINI: 0.0517914, RATIO_SHANNON_ENTROPY: 0.6521001, RATIO_AVERAGE_POPULARITY: 2.4994580, RATIO_NOVELTY: 0.0249446, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 350 of 500. Elapsed time 1.39 hour\n",
      "LightFMItemHybridRecommender: Epoch 351 of 500. Elapsed time 1.39 hour\n",
      "LightFMItemHybridRecommender: Epoch 352 of 500. Elapsed time 1.39 hour\n",
      "LightFMItemHybridRecommender: Epoch 353 of 500. Elapsed time 1.39 hour\n",
      "LightFMItemHybridRecommender: Epoch 354 of 500. Elapsed time 1.39 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.21 sec. Users per second: 348\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2831635, PRECISION_RECALL_MIN_DEN: 0.2846759, RECALL: 0.0615657, MAP: 0.1574181, MAP_MIN_DEN: 0.1580108, MRR: 0.5354432, NDCG: 0.2977986, F1: 0.1011412, HIT_RATE: 0.9136907, ARHR_ALL_HITS: 0.9069028, NOVELTY: 0.0056347, AVERAGE_POPULARITY: 0.5073639, DIVERSITY_MEAN_INTER_LIST: 0.9251298, DIVERSITY_HERFINDAHL: 0.9925062, COVERAGE_ITEM: 0.0919209, COVERAGE_ITEM_CORRECT: 0.0604685, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128205, DIVERSITY_GINI: 0.0129036, SHANNON_ENTROPY: 8.0865931, RATIO_DIVERSITY_HERFINDAHL: 0.9928893, RATIO_DIVERSITY_GINI: 0.0520400, RATIO_SHANNON_ENTROPY: 0.6526591, RATIO_AVERAGE_POPULARITY: 2.4963554, RATIO_NOVELTY: 0.0249519, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 355 of 500. Elapsed time 1.41 hour\n",
      "LightFMItemHybridRecommender: Epoch 356 of 500. Elapsed time 1.41 hour\n",
      "LightFMItemHybridRecommender: Epoch 357 of 500. Elapsed time 1.41 hour\n",
      "LightFMItemHybridRecommender: Epoch 358 of 500. Elapsed time 1.41 hour\n",
      "LightFMItemHybridRecommender: Epoch 359 of 500. Elapsed time 1.41 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.97 sec. Users per second: 350\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2834714, PRECISION_RECALL_MIN_DEN: 0.2849220, RECALL: 0.0616194, MAP: 0.1575073, MAP_MIN_DEN: 0.1581091, MRR: 0.5353629, NDCG: 0.2979526, F1: 0.1012332, HIT_RATE: 0.9130307, ARHR_ALL_HITS: 0.9069520, NOVELTY: 0.0056332, AVERAGE_POPULARITY: 0.5083982, DIVERSITY_MEAN_INTER_LIST: 0.9242596, DIVERSITY_HERFINDAHL: 0.9924192, COVERAGE_ITEM: 0.0914779, COVERAGE_ITEM_CORRECT: 0.0601916, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9121612, DIVERSITY_GINI: 0.0128086, SHANNON_ENTROPY: 8.0734938, RATIO_DIVERSITY_HERFINDAHL: 0.9928022, RATIO_DIVERSITY_GINI: 0.0516566, RATIO_SHANNON_ENTROPY: 0.6516018, RATIO_AVERAGE_POPULARITY: 2.5014441, RATIO_NOVELTY: 0.0249449, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 360 of 500. Elapsed time 1.43 hour\n",
      "LightFMItemHybridRecommender: Epoch 361 of 500. Elapsed time 1.43 hour\n",
      "LightFMItemHybridRecommender: Epoch 362 of 500. Elapsed time 1.43 hour\n",
      "LightFMItemHybridRecommender: Epoch 363 of 500. Elapsed time 1.43 hour\n",
      "LightFMItemHybridRecommender: Epoch 364 of 500. Elapsed time 1.43 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.49 sec. Users per second: 345\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830828, PRECISION_RECALL_MIN_DEN: 0.2846751, RECALL: 0.0616708, MAP: 0.1572641, MAP_MIN_DEN: 0.1578663, MRR: 0.5345415, NDCG: 0.2975582, F1: 0.1012778, HIT_RATE: 0.9135440, ARHR_ALL_HITS: 0.9056096, NOVELTY: 0.0056346, AVERAGE_POPULARITY: 0.5074297, DIVERSITY_MEAN_INTER_LIST: 0.9250698, DIVERSITY_HERFINDAHL: 0.9925002, COVERAGE_ITEM: 0.0920317, COVERAGE_ITEM_CORRECT: 0.0598593, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126740, DIVERSITY_GINI: 0.0128949, SHANNON_ENTROPY: 8.0860405, RATIO_DIVERSITY_HERFINDAHL: 0.9928833, RATIO_DIVERSITY_GINI: 0.0520046, RATIO_SHANNON_ENTROPY: 0.6526145, RATIO_AVERAGE_POPULARITY: 2.4966788, RATIO_NOVELTY: 0.0249512, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 365 of 500. Elapsed time 1.45 hour\n",
      "LightFMItemHybridRecommender: Epoch 366 of 500. Elapsed time 1.45 hour\n",
      "LightFMItemHybridRecommender: Epoch 367 of 500. Elapsed time 1.45 hour\n",
      "LightFMItemHybridRecommender: Epoch 368 of 500. Elapsed time 1.45 hour\n",
      "LightFMItemHybridRecommender: Epoch 369 of 500. Elapsed time 1.45 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.07 sec. Users per second: 340\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832221, PRECISION_RECALL_MIN_DEN: 0.2847201, RECALL: 0.0614910, MAP: 0.1572794, MAP_MIN_DEN: 0.1578623, MRR: 0.5341218, NDCG: 0.2974770, F1: 0.1010442, HIT_RATE: 0.9130307, ARHR_ALL_HITS: 0.9050092, NOVELTY: 0.0056381, AVERAGE_POPULARITY: 0.5054870, DIVERSITY_MEAN_INTER_LIST: 0.9263577, DIVERSITY_HERFINDAHL: 0.9926290, COVERAGE_ITEM: 0.0921424, COVERAGE_ITEM_CORRECT: 0.0608007, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9121612, DIVERSITY_GINI: 0.0129899, SHANNON_ENTROPY: 8.1013642, RATIO_DIVERSITY_HERFINDAHL: 0.9930121, RATIO_DIVERSITY_GINI: 0.0523877, RATIO_SHANNON_ENTROPY: 0.6538512, RATIO_AVERAGE_POPULARITY: 2.4871205, RATIO_NOVELTY: 0.0249665, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 370 of 500. Elapsed time 1.47 hour\n",
      "LightFMItemHybridRecommender: Epoch 371 of 500. Elapsed time 1.47 hour\n",
      "LightFMItemHybridRecommender: Epoch 372 of 500. Elapsed time 1.47 hour\n",
      "LightFMItemHybridRecommender: Epoch 373 of 500. Elapsed time 1.47 hour\n",
      "LightFMItemHybridRecommender: Epoch 374 of 500. Elapsed time 1.48 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.97 sec. Users per second: 341\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832148, PRECISION_RECALL_MIN_DEN: 0.2847574, RECALL: 0.0614478, MAP: 0.1570869, MAP_MIN_DEN: 0.1576700, MRR: 0.5321201, NDCG: 0.2971863, F1: 0.1009853, HIT_RATE: 0.9127374, ARHR_ALL_HITS: 0.9032474, NOVELTY: 0.0056364, AVERAGE_POPULARITY: 0.5061423, DIVERSITY_MEAN_INTER_LIST: 0.9262286, DIVERSITY_HERFINDAHL: 0.9926161, COVERAGE_ITEM: 0.0916994, COVERAGE_ITEM_CORRECT: 0.0608561, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9118681, DIVERSITY_GINI: 0.0129246, SHANNON_ENTROPY: 8.0941433, RATIO_DIVERSITY_HERFINDAHL: 0.9929992, RATIO_DIVERSITY_GINI: 0.0521244, RATIO_SHANNON_ENTROPY: 0.6532684, RATIO_AVERAGE_POPULARITY: 2.4903444, RATIO_NOVELTY: 0.0249592, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 375 of 500. Elapsed time 1.49 hour\n",
      "LightFMItemHybridRecommender: Epoch 376 of 500. Elapsed time 1.49 hour\n",
      "LightFMItemHybridRecommender: Epoch 377 of 500. Elapsed time 1.49 hour\n",
      "LightFMItemHybridRecommender: Epoch 378 of 500. Elapsed time 1.49 hour\n",
      "LightFMItemHybridRecommender: Epoch 379 of 500. Elapsed time 1.50 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.85 sec. Users per second: 351\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829141, PRECISION_RECALL_MIN_DEN: 0.2845078, RECALL: 0.0615257, MAP: 0.1570870, MAP_MIN_DEN: 0.1576757, MRR: 0.5343609, NDCG: 0.2973339, F1: 0.1010712, HIT_RATE: 0.9131774, ARHR_ALL_HITS: 0.9048862, NOVELTY: 0.0056388, AVERAGE_POPULARITY: 0.5052001, DIVERSITY_MEAN_INTER_LIST: 0.9262141, DIVERSITY_HERFINDAHL: 0.9926146, COVERAGE_ITEM: 0.0924193, COVERAGE_ITEM_CORRECT: 0.0601916, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9123077, DIVERSITY_GINI: 0.0130146, SHANNON_ENTROPY: 8.1022652, RATIO_DIVERSITY_HERFINDAHL: 0.9929977, RATIO_DIVERSITY_GINI: 0.0524876, RATIO_SHANNON_ENTROPY: 0.6539240, RATIO_AVERAGE_POPULARITY: 2.4857086, RATIO_NOVELTY: 0.0249699, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 380 of 500. Elapsed time 1.51 hour\n",
      "LightFMItemHybridRecommender: Epoch 381 of 500. Elapsed time 1.51 hour\n",
      "LightFMItemHybridRecommender: Epoch 382 of 500. Elapsed time 1.51 hour\n",
      "LightFMItemHybridRecommender: Epoch 383 of 500. Elapsed time 1.51 hour\n",
      "LightFMItemHybridRecommender: Epoch 384 of 500. Elapsed time 1.52 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.27 sec. Users per second: 347\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830535, PRECISION_RECALL_MIN_DEN: 0.2845194, RECALL: 0.0614108, MAP: 0.1570132, MAP_MIN_DEN: 0.1575749, MRR: 0.5318969, NDCG: 0.2970191, F1: 0.1009250, HIT_RATE: 0.9134707, ARHR_ALL_HITS: 0.9028365, NOVELTY: 0.0056391, AVERAGE_POPULARITY: 0.5046741, DIVERSITY_MEAN_INTER_LIST: 0.9267636, DIVERSITY_HERFINDAHL: 0.9926696, COVERAGE_ITEM: 0.0924193, COVERAGE_ITEM_CORRECT: 0.0608561, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126007, DIVERSITY_GINI: 0.0130317, SHANNON_ENTROPY: 8.1060189, RATIO_DIVERSITY_HERFINDAHL: 0.9930527, RATIO_DIVERSITY_GINI: 0.0525565, RATIO_SHANNON_ENTROPY: 0.6542269, RATIO_AVERAGE_POPULARITY: 2.4831206, RATIO_NOVELTY: 0.0249710, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 385 of 500. Elapsed time 1.53 hour\n",
      "LightFMItemHybridRecommender: Epoch 386 of 500. Elapsed time 1.53 hour\n",
      "LightFMItemHybridRecommender: Epoch 387 of 500. Elapsed time 1.53 hour\n",
      "LightFMItemHybridRecommender: Epoch 388 of 500. Elapsed time 1.54 hour\n",
      "LightFMItemHybridRecommender: Epoch 389 of 500. Elapsed time 1.54 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.92 sec. Users per second: 342\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2835961, PRECISION_RECALL_MIN_DEN: 0.2851805, RECALL: 0.0617192, MAP: 0.1578085, MAP_MIN_DEN: 0.1584025, MRR: 0.5355939, NDCG: 0.2982015, F1: 0.1013760, HIT_RATE: 0.9136174, ARHR_ALL_HITS: 0.9079912, NOVELTY: 0.0056365, AVERAGE_POPULARITY: 0.5063115, DIVERSITY_MEAN_INTER_LIST: 0.9259372, DIVERSITY_HERFINDAHL: 0.9925869, COVERAGE_ITEM: 0.0918102, COVERAGE_ITEM_CORRECT: 0.0602470, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9127473, DIVERSITY_GINI: 0.0129687, SHANNON_ENTROPY: 8.0977607, RATIO_DIVERSITY_HERFINDAHL: 0.9929700, RATIO_DIVERSITY_GINI: 0.0523022, RATIO_SHANNON_ENTROPY: 0.6535604, RATIO_AVERAGE_POPULARITY: 2.4911770, RATIO_NOVELTY: 0.0249596, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 390 of 500. Elapsed time 1.55 hour\n",
      "LightFMItemHybridRecommender: Epoch 391 of 500. Elapsed time 1.55 hour\n",
      "LightFMItemHybridRecommender: Epoch 392 of 500. Elapsed time 1.55 hour\n",
      "LightFMItemHybridRecommender: Epoch 393 of 500. Elapsed time 1.56 hour\n",
      "LightFMItemHybridRecommender: Epoch 394 of 500. Elapsed time 1.56 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.62 sec. Users per second: 344\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832588, PRECISION_RECALL_MIN_DEN: 0.2847580, RECALL: 0.0614735, MAP: 0.1576242, MAP_MIN_DEN: 0.1582428, MRR: 0.5351892, NDCG: 0.2979287, F1: 0.1010229, HIT_RATE: 0.9136174, ARHR_ALL_HITS: 0.9072596, NOVELTY: 0.0056359, AVERAGE_POPULARITY: 0.5065344, DIVERSITY_MEAN_INTER_LIST: 0.9257463, DIVERSITY_HERFINDAHL: 0.9925678, COVERAGE_ITEM: 0.0921424, COVERAGE_ITEM_CORRECT: 0.0606900, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9127473, DIVERSITY_GINI: 0.0129475, SHANNON_ENTROPY: 8.0938089, RATIO_DIVERSITY_HERFINDAHL: 0.9929509, RATIO_DIVERSITY_GINI: 0.0522169, RATIO_SHANNON_ENTROPY: 0.6532414, RATIO_AVERAGE_POPULARITY: 2.4922740, RATIO_NOVELTY: 0.0249571, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 395 of 500. Elapsed time 1.57 hour\n",
      "LightFMItemHybridRecommender: Epoch 396 of 500. Elapsed time 1.57 hour\n",
      "LightFMItemHybridRecommender: Epoch 397 of 500. Elapsed time 1.57 hour\n",
      "LightFMItemHybridRecommender: Epoch 398 of 500. Elapsed time 1.58 hour\n",
      "LightFMItemHybridRecommender: Epoch 399 of 500. Elapsed time 1.58 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.35 sec. Users per second: 347\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832075, PRECISION_RECALL_MIN_DEN: 0.2847074, RECALL: 0.0615041, MAP: 0.1575253, MAP_MIN_DEN: 0.1581169, MRR: 0.5349957, NDCG: 0.2978728, F1: 0.1010608, HIT_RATE: 0.9134707, ARHR_ALL_HITS: 0.9071657, NOVELTY: 0.0056375, AVERAGE_POPULARITY: 0.5060785, DIVERSITY_MEAN_INTER_LIST: 0.9256627, DIVERSITY_HERFINDAHL: 0.9925595, COVERAGE_ITEM: 0.0923085, COVERAGE_ITEM_CORRECT: 0.0611883, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126007, DIVERSITY_GINI: 0.0130119, SHANNON_ENTROPY: 8.0991054, RATIO_DIVERSITY_HERFINDAHL: 0.9929426, RATIO_DIVERSITY_GINI: 0.0524764, RATIO_SHANNON_ENTROPY: 0.6536689, RATIO_AVERAGE_POPULARITY: 2.4900308, RATIO_NOVELTY: 0.0249642, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 400 of 500. Elapsed time 1.59 hour\n",
      "LightFMItemHybridRecommender: Epoch 401 of 500. Elapsed time 1.59 hour\n",
      "LightFMItemHybridRecommender: Epoch 402 of 500. Elapsed time 1.60 hour\n",
      "LightFMItemHybridRecommender: Epoch 403 of 500. Elapsed time 1.60 hour\n",
      "LightFMItemHybridRecommender: Epoch 404 of 500. Elapsed time 1.60 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.79 sec. Users per second: 343\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829508, PRECISION_RECALL_MIN_DEN: 0.2844088, RECALL: 0.0614398, MAP: 0.1573647, MAP_MIN_DEN: 0.1579395, MRR: 0.5344296, NDCG: 0.2975314, F1: 0.1009577, HIT_RATE: 0.9125907, ARHR_ALL_HITS: 0.9060781, NOVELTY: 0.0056396, AVERAGE_POPULARITY: 0.5050900, DIVERSITY_MEAN_INTER_LIST: 0.9262057, DIVERSITY_HERFINDAHL: 0.9926138, COVERAGE_ITEM: 0.0924193, COVERAGE_ITEM_CORRECT: 0.0609115, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9117216, DIVERSITY_GINI: 0.0130405, SHANNON_ENTROPY: 8.1050658, RATIO_DIVERSITY_HERFINDAHL: 0.9929969, RATIO_DIVERSITY_GINI: 0.0525921, RATIO_SHANNON_ENTROPY: 0.6541500, RATIO_AVERAGE_POPULARITY: 2.4851672, RATIO_NOVELTY: 0.0249732, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 405 of 500. Elapsed time 1.61 hour\n",
      "LightFMItemHybridRecommender: Epoch 406 of 500. Elapsed time 1.61 hour\n",
      "LightFMItemHybridRecommender: Epoch 407 of 500. Elapsed time 1.62 hour\n",
      "LightFMItemHybridRecommender: Epoch 408 of 500. Elapsed time 1.62 hour\n",
      "LightFMItemHybridRecommender: Epoch 409 of 500. Elapsed time 1.62 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.60 sec. Users per second: 344\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2828775, PRECISION_RECALL_MIN_DEN: 0.2843829, RECALL: 0.0614899, MAP: 0.1572292, MAP_MIN_DEN: 0.1578083, MRR: 0.5343043, NDCG: 0.2974064, F1: 0.1010207, HIT_RATE: 0.9128841, ARHR_ALL_HITS: 0.9054816, NOVELTY: 0.0056400, AVERAGE_POPULARITY: 0.5048573, DIVERSITY_MEAN_INTER_LIST: 0.9263472, DIVERSITY_HERFINDAHL: 0.9926279, COVERAGE_ITEM: 0.0934160, COVERAGE_ITEM_CORRECT: 0.0606900, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9120147, DIVERSITY_GINI: 0.0130865, SHANNON_ENTROPY: 8.1092923, RATIO_DIVERSITY_HERFINDAHL: 0.9930110, RATIO_DIVERSITY_GINI: 0.0527775, RATIO_SHANNON_ENTROPY: 0.6544911, RATIO_AVERAGE_POPULARITY: 2.4840223, RATIO_NOVELTY: 0.0249750, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 410 of 500. Elapsed time 1.63 hour\n",
      "LightFMItemHybridRecommender: Epoch 411 of 500. Elapsed time 1.63 hour\n",
      "LightFMItemHybridRecommender: Epoch 412 of 500. Elapsed time 1.64 hour\n",
      "LightFMItemHybridRecommender: Epoch 413 of 500. Elapsed time 1.64 hour\n",
      "LightFMItemHybridRecommender: Epoch 414 of 500. Elapsed time 1.64 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.86 sec. Users per second: 334\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2828481, PRECISION_RECALL_MIN_DEN: 0.2844662, RECALL: 0.0616680, MAP: 0.1575176, MAP_MIN_DEN: 0.1581362, MRR: 0.5364135, NDCG: 0.2978870, F1: 0.1012591, HIT_RATE: 0.9130307, ARHR_ALL_HITS: 0.9081030, NOVELTY: 0.0056381, AVERAGE_POPULARITY: 0.5060823, DIVERSITY_MEAN_INTER_LIST: 0.9255737, DIVERSITY_HERFINDAHL: 0.9925506, COVERAGE_ITEM: 0.0930838, COVERAGE_ITEM_CORRECT: 0.0608561, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9121612, DIVERSITY_GINI: 0.0130235, SHANNON_ENTROPY: 8.0989191, RATIO_DIVERSITY_HERFINDAHL: 0.9929337, RATIO_DIVERSITY_GINI: 0.0525233, RATIO_SHANNON_ENTROPY: 0.6536539, RATIO_AVERAGE_POPULARITY: 2.4900495, RATIO_NOVELTY: 0.0249666, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 415 of 500. Elapsed time 1.65 hour\n",
      "LightFMItemHybridRecommender: Epoch 416 of 500. Elapsed time 1.66 hour\n",
      "LightFMItemHybridRecommender: Epoch 417 of 500. Elapsed time 1.66 hour\n",
      "LightFMItemHybridRecommender: Epoch 418 of 500. Elapsed time 1.66 hour\n",
      "LightFMItemHybridRecommender: Epoch 419 of 500. Elapsed time 1.66 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.54 sec. Users per second: 336\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830535, PRECISION_RECALL_MIN_DEN: 0.2844717, RECALL: 0.0614737, MAP: 0.1574507, MAP_MIN_DEN: 0.1580265, MRR: 0.5360620, NDCG: 0.2978083, F1: 0.1010100, HIT_RATE: 0.9131041, ARHR_ALL_HITS: 0.9075248, NOVELTY: 0.0056379, AVERAGE_POPULARITY: 0.5062490, DIVERSITY_MEAN_INTER_LIST: 0.9254920, DIVERSITY_HERFINDAHL: 0.9925424, COVERAGE_ITEM: 0.0931945, COVERAGE_ITEM_CORRECT: 0.0608007, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9122344, DIVERSITY_GINI: 0.0130165, SHANNON_ENTROPY: 8.0984430, RATIO_DIVERSITY_HERFINDAHL: 0.9929255, RATIO_DIVERSITY_GINI: 0.0524949, RATIO_SHANNON_ENTROPY: 0.6536155, RATIO_AVERAGE_POPULARITY: 2.4908695, RATIO_NOVELTY: 0.0249656, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 420 of 500. Elapsed time 1.67 hour\n",
      "LightFMItemHybridRecommender: Epoch 421 of 500. Elapsed time 1.68 hour\n",
      "LightFMItemHybridRecommender: Epoch 422 of 500. Elapsed time 1.68 hour\n",
      "LightFMItemHybridRecommender: Epoch 423 of 500. Elapsed time 1.68 hour\n",
      "LightFMItemHybridRecommender: Epoch 424 of 500. Elapsed time 1.68 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.88 sec. Users per second: 342\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830681, PRECISION_RECALL_MIN_DEN: 0.2845615, RECALL: 0.0615414, MAP: 0.1571143, MAP_MIN_DEN: 0.1576976, MRR: 0.5349272, NDCG: 0.2975217, F1: 0.1011022, HIT_RATE: 0.9144240, ARHR_ALL_HITS: 0.9056657, NOVELTY: 0.0056391, AVERAGE_POPULARITY: 0.5055860, DIVERSITY_MEAN_INTER_LIST: 0.9256752, DIVERSITY_HERFINDAHL: 0.9925607, COVERAGE_ITEM: 0.0923639, COVERAGE_ITEM_CORRECT: 0.0613544, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9135531, DIVERSITY_GINI: 0.0130634, SHANNON_ENTROPY: 8.1037057, RATIO_DIVERSITY_HERFINDAHL: 0.9929438, RATIO_DIVERSITY_GINI: 0.0526843, RATIO_SHANNON_ENTROPY: 0.6540402, RATIO_AVERAGE_POPULARITY: 2.4876076, RATIO_NOVELTY: 0.0249710, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 425 of 500. Elapsed time 1.70 hour\n",
      "LightFMItemHybridRecommender: Epoch 426 of 500. Elapsed time 1.70 hour\n",
      "LightFMItemHybridRecommender: Epoch 427 of 500. Elapsed time 1.70 hour\n",
      "LightFMItemHybridRecommender: Epoch 428 of 500. Elapsed time 1.70 hour\n",
      "LightFMItemHybridRecommender: Epoch 429 of 500. Elapsed time 1.70 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.49 sec. Users per second: 337\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2827748, PRECISION_RECALL_MIN_DEN: 0.2842218, RECALL: 0.0613054, MAP: 0.1572071, MAP_MIN_DEN: 0.1577904, MRR: 0.5356664, NDCG: 0.2974779, F1: 0.1007650, HIT_RATE: 0.9137640, ARHR_ALL_HITS: 0.9062963, NOVELTY: 0.0056393, AVERAGE_POPULARITY: 0.5055391, DIVERSITY_MEAN_INTER_LIST: 0.9259022, DIVERSITY_HERFINDAHL: 0.9925834, COVERAGE_ITEM: 0.0932499, COVERAGE_ITEM_CORRECT: 0.0612437, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128938, DIVERSITY_GINI: 0.0130793, SHANNON_ENTROPY: 8.1057677, RATIO_DIVERSITY_HERFINDAHL: 0.9929665, RATIO_DIVERSITY_GINI: 0.0527486, RATIO_SHANNON_ENTROPY: 0.6542066, RATIO_AVERAGE_POPULARITY: 2.4873768, RATIO_NOVELTY: 0.0249719, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 430 of 500. Elapsed time 1.72 hour\n",
      "LightFMItemHybridRecommender: Epoch 431 of 500. Elapsed time 1.72 hour\n",
      "LightFMItemHybridRecommender: Epoch 432 of 500. Elapsed time 1.72 hour\n",
      "LightFMItemHybridRecommender: Epoch 433 of 500. Elapsed time 1.72 hour\n",
      "LightFMItemHybridRecommender: Epoch 434 of 500. Elapsed time 1.72 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.03 sec. Users per second: 341\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2824375, PRECISION_RECALL_MIN_DEN: 0.2839612, RECALL: 0.0613462, MAP: 0.1572811, MAP_MIN_DEN: 0.1578820, MRR: 0.5367608, NDCG: 0.2975750, F1: 0.1007987, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9076212, NOVELTY: 0.0056370, AVERAGE_POPULARITY: 0.5064836, DIVERSITY_MEAN_INTER_LIST: 0.9256255, DIVERSITY_HERFINDAHL: 0.9925558, COVERAGE_ITEM: 0.0931945, COVERAGE_ITEM_CORRECT: 0.0611330, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0130253, SHANNON_ENTROPY: 8.0990816, RATIO_DIVERSITY_HERFINDAHL: 0.9929389, RATIO_DIVERSITY_GINI: 0.0525306, RATIO_SHANNON_ENTROPY: 0.6536670, RATIO_AVERAGE_POPULARITY: 2.4920240, RATIO_NOVELTY: 0.0249617, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 435 of 500. Elapsed time 1.74 hour\n",
      "LightFMItemHybridRecommender: Epoch 436 of 500. Elapsed time 1.74 hour\n",
      "LightFMItemHybridRecommender: Epoch 437 of 500. Elapsed time 1.74 hour\n",
      "LightFMItemHybridRecommender: Epoch 438 of 500. Elapsed time 1.74 hour\n",
      "LightFMItemHybridRecommender: Epoch 439 of 500. Elapsed time 1.75 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.96 sec. Users per second: 341\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2829361, PRECISION_RECALL_MIN_DEN: 0.2844668, RECALL: 0.0615166, MAP: 0.1574264, MAP_MIN_DEN: 0.1580164, MRR: 0.5363214, NDCG: 0.2978064, F1: 0.1010604, HIT_RATE: 0.9141307, ARHR_ALL_HITS: 0.9075914, NOVELTY: 0.0056378, AVERAGE_POPULARITY: 0.5061746, DIVERSITY_MEAN_INTER_LIST: 0.9257676, DIVERSITY_HERFINDAHL: 0.9925700, COVERAGE_ITEM: 0.0932499, COVERAGE_ITEM_CORRECT: 0.0609115, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9132601, DIVERSITY_GINI: 0.0130315, SHANNON_ENTROPY: 8.1011532, RATIO_DIVERSITY_HERFINDAHL: 0.9929531, RATIO_DIVERSITY_GINI: 0.0525556, RATIO_SHANNON_ENTROPY: 0.6538342, RATIO_AVERAGE_POPULARITY: 2.4905035, RATIO_NOVELTY: 0.0249654, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 440 of 500. Elapsed time 1.76 hour\n",
      "LightFMItemHybridRecommender: Epoch 441 of 500. Elapsed time 1.76 hour\n",
      "LightFMItemHybridRecommender: Epoch 442 of 500. Elapsed time 1.76 hour\n",
      "LightFMItemHybridRecommender: Epoch 443 of 500. Elapsed time 1.76 hour\n",
      "LightFMItemHybridRecommender: Epoch 444 of 500. Elapsed time 1.77 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 40.14 sec. Users per second: 340\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2825768, PRECISION_RECALL_MIN_DEN: 0.2841618, RECALL: 0.0614874, MAP: 0.1570716, MAP_MIN_DEN: 0.1576802, MRR: 0.5346507, NDCG: 0.2972617, F1: 0.1009981, HIT_RATE: 0.9134707, ARHR_ALL_HITS: 0.9053059, NOVELTY: 0.0056375, AVERAGE_POPULARITY: 0.5056941, DIVERSITY_MEAN_INTER_LIST: 0.9261797, DIVERSITY_HERFINDAHL: 0.9926112, COVERAGE_ITEM: 0.0929177, COVERAGE_ITEM_CORRECT: 0.0610222, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126007, DIVERSITY_GINI: 0.0130786, SHANNON_ENTROPY: 8.1070683, RATIO_DIVERSITY_HERFINDAHL: 0.9929943, RATIO_DIVERSITY_GINI: 0.0527458, RATIO_SHANNON_ENTROPY: 0.6543116, RATIO_AVERAGE_POPULARITY: 2.4881395, RATIO_NOVELTY: 0.0249643, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 445 of 500. Elapsed time 1.78 hour\n",
      "LightFMItemHybridRecommender: Epoch 446 of 500. Elapsed time 1.78 hour\n",
      "LightFMItemHybridRecommender: Epoch 447 of 500. Elapsed time 1.78 hour\n",
      "LightFMItemHybridRecommender: Epoch 448 of 500. Elapsed time 1.78 hour\n",
      "LightFMItemHybridRecommender: Epoch 449 of 500. Elapsed time 1.79 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.86 sec. Users per second: 342\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830021, PRECISION_RECALL_MIN_DEN: 0.2845377, RECALL: 0.0615236, MAP: 0.1575495, MAP_MIN_DEN: 0.1581329, MRR: 0.5362650, NDCG: 0.2978770, F1: 0.1010741, HIT_RATE: 0.9138374, ARHR_ALL_HITS: 0.9078062, NOVELTY: 0.0056385, AVERAGE_POPULARITY: 0.5054393, DIVERSITY_MEAN_INTER_LIST: 0.9264160, DIVERSITY_HERFINDAHL: 0.9926348, COVERAGE_ITEM: 0.0929177, COVERAGE_ITEM_CORRECT: 0.0613544, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9129670, DIVERSITY_GINI: 0.0130721, SHANNON_ENTROPY: 8.1086745, RATIO_DIVERSITY_HERFINDAHL: 0.9930179, RATIO_DIVERSITY_GINI: 0.0527193, RATIO_SHANNON_ENTROPY: 0.6544412, RATIO_AVERAGE_POPULARITY: 2.4868857, RATIO_NOVELTY: 0.0249685, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 450 of 500. Elapsed time 1.80 hour\n",
      "LightFMItemHybridRecommender: Epoch 451 of 500. Elapsed time 1.80 hour\n",
      "LightFMItemHybridRecommender: Epoch 452 of 500. Elapsed time 1.80 hour\n",
      "LightFMItemHybridRecommender: Epoch 453 of 500. Elapsed time 1.80 hour\n",
      "LightFMItemHybridRecommender: Epoch 454 of 500. Elapsed time 1.81 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.67 sec. Users per second: 344\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2831048, PRECISION_RECALL_MIN_DEN: 0.2846369, RECALL: 0.0615110, MAP: 0.1575233, MAP_MIN_DEN: 0.1581001, MRR: 0.5352732, NDCG: 0.2977713, F1: 0.1010636, HIT_RATE: 0.9136907, ARHR_ALL_HITS: 0.9069759, NOVELTY: 0.0056375, AVERAGE_POPULARITY: 0.5062856, DIVERSITY_MEAN_INTER_LIST: 0.9255068, DIVERSITY_HERFINDAHL: 0.9925439, COVERAGE_ITEM: 0.0938036, COVERAGE_ITEM_CORRECT: 0.0613544, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9128205, DIVERSITY_GINI: 0.0130045, SHANNON_ENTROPY: 8.0970045, RATIO_DIVERSITY_HERFINDAHL: 0.9929270, RATIO_DIVERSITY_GINI: 0.0524467, RATIO_SHANNON_ENTROPY: 0.6534994, RATIO_AVERAGE_POPULARITY: 2.4910495, RATIO_NOVELTY: 0.0249642, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 455 of 500. Elapsed time 1.82 hour\n",
      "LightFMItemHybridRecommender: Epoch 456 of 500. Elapsed time 1.82 hour\n",
      "LightFMItemHybridRecommender: Epoch 457 of 500. Elapsed time 1.82 hour\n",
      "LightFMItemHybridRecommender: Epoch 458 of 500. Elapsed time 1.83 hour\n",
      "LightFMItemHybridRecommender: Epoch 459 of 500. Elapsed time 1.83 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.92 sec. Users per second: 342\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830535, PRECISION_RECALL_MIN_DEN: 0.2844926, RECALL: 0.0614173, MAP: 0.1575209, MAP_MIN_DEN: 0.1581168, MRR: 0.5362903, NDCG: 0.2979179, F1: 0.1009339, HIT_RATE: 0.9145707, ARHR_ALL_HITS: 0.9079999, NOVELTY: 0.0056362, AVERAGE_POPULARITY: 0.5068949, DIVERSITY_MEAN_INTER_LIST: 0.9251860, DIVERSITY_HERFINDAHL: 0.9925118, COVERAGE_ITEM: 0.0938036, COVERAGE_ITEM_CORRECT: 0.0608561, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9136996, DIVERSITY_GINI: 0.0130173, SHANNON_ENTROPY: 8.0968154, RATIO_DIVERSITY_HERFINDAHL: 0.9928949, RATIO_DIVERSITY_GINI: 0.0524985, RATIO_SHANNON_ENTROPY: 0.6534841, RATIO_AVERAGE_POPULARITY: 2.4940477, RATIO_NOVELTY: 0.0249585, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 460 of 500. Elapsed time 1.84 hour\n",
      "LightFMItemHybridRecommender: Epoch 461 of 500. Elapsed time 1.84 hour\n",
      "LightFMItemHybridRecommender: Epoch 462 of 500. Elapsed time 1.84 hour\n",
      "LightFMItemHybridRecommender: Epoch 463 of 500. Elapsed time 1.85 hour\n",
      "LightFMItemHybridRecommender: Epoch 464 of 500. Elapsed time 1.85 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.74 sec. Users per second: 352\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832441, PRECISION_RECALL_MIN_DEN: 0.2847896, RECALL: 0.0615172, MAP: 0.1574343, MAP_MIN_DEN: 0.1580285, MRR: 0.5348758, NDCG: 0.2977338, F1: 0.1010808, HIT_RATE: 0.9132507, ARHR_ALL_HITS: 0.9062652, NOVELTY: 0.0056372, AVERAGE_POPULARITY: 0.5062069, DIVERSITY_MEAN_INTER_LIST: 0.9256169, DIVERSITY_HERFINDAHL: 0.9925549, COVERAGE_ITEM: 0.0939144, COVERAGE_ITEM_CORRECT: 0.0605238, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9123810, DIVERSITY_GINI: 0.0130618, SHANNON_ENTROPY: 8.1020442, RATIO_DIVERSITY_HERFINDAHL: 0.9929380, RATIO_DIVERSITY_GINI: 0.0526778, RATIO_SHANNON_ENTROPY: 0.6539061, RATIO_AVERAGE_POPULARITY: 2.4906625, RATIO_NOVELTY: 0.0249628, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 465 of 500. Elapsed time 1.86 hour\n",
      "LightFMItemHybridRecommender: Epoch 466 of 500. Elapsed time 1.86 hour\n",
      "LightFMItemHybridRecommender: Epoch 467 of 500. Elapsed time 1.86 hour\n",
      "LightFMItemHybridRecommender: Epoch 468 of 500. Elapsed time 1.87 hour\n",
      "LightFMItemHybridRecommender: Epoch 469 of 500. Elapsed time 1.87 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.61 sec. Users per second: 353\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2835374, PRECISION_RECALL_MIN_DEN: 0.2850725, RECALL: 0.0616532, MAP: 0.1578890, MAP_MIN_DEN: 0.1585214, MRR: 0.5379428, NDCG: 0.2985597, F1: 0.1012832, HIT_RATE: 0.9140573, ARHR_ALL_HITS: 0.9101829, NOVELTY: 0.0056366, AVERAGE_POPULARITY: 0.5069709, DIVERSITY_MEAN_INTER_LIST: 0.9250521, DIVERSITY_HERFINDAHL: 0.9924984, COVERAGE_ITEM: 0.0937483, COVERAGE_ITEM_CORRECT: 0.0607453, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9131868, DIVERSITY_GINI: 0.0130128, SHANNON_ENTROPY: 8.0945108, RATIO_DIVERSITY_HERFINDAHL: 0.9928815, RATIO_DIVERSITY_GINI: 0.0524802, RATIO_SHANNON_ENTROPY: 0.6532981, RATIO_AVERAGE_POPULARITY: 2.4944213, RATIO_NOVELTY: 0.0249600, \n",
      "\n",
      "LightFMItemHybridRecommender: New best model found! Updating.\n",
      "LightFMItemHybridRecommender: Epoch 470 of 500. Elapsed time 1.88 hour\n",
      "LightFMItemHybridRecommender: Epoch 471 of 500. Elapsed time 1.88 hour\n",
      "LightFMItemHybridRecommender: Epoch 472 of 500. Elapsed time 1.88 hour\n",
      "LightFMItemHybridRecommender: Epoch 473 of 500. Elapsed time 1.89 hour\n",
      "LightFMItemHybridRecommender: Epoch 474 of 500. Elapsed time 1.89 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.53 sec. Users per second: 345\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2832001, PRECISION_RECALL_MIN_DEN: 0.2847406, RECALL: 0.0615851, MAP: 0.1574564, MAP_MIN_DEN: 0.1580260, MRR: 0.5347984, NDCG: 0.2977341, F1: 0.1011697, HIT_RATE: 0.9133974, ARHR_ALL_HITS: 0.9064987, NOVELTY: 0.0056376, AVERAGE_POPULARITY: 0.5064057, DIVERSITY_MEAN_INTER_LIST: 0.9254551, DIVERSITY_HERFINDAHL: 0.9925387, COVERAGE_ITEM: 0.0939144, COVERAGE_ITEM_CORRECT: 0.0607453, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9125275, DIVERSITY_GINI: 0.0130429, SHANNON_ENTROPY: 8.0988745, RATIO_DIVERSITY_HERFINDAHL: 0.9929218, RATIO_DIVERSITY_GINI: 0.0526016, RATIO_SHANNON_ENTROPY: 0.6536503, RATIO_AVERAGE_POPULARITY: 2.4916407, RATIO_NOVELTY: 0.0249644, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 475 of 500. Elapsed time 1.90 hour\n",
      "LightFMItemHybridRecommender: Epoch 476 of 500. Elapsed time 1.90 hour\n",
      "LightFMItemHybridRecommender: Epoch 477 of 500. Elapsed time 1.91 hour\n",
      "LightFMItemHybridRecommender: Epoch 478 of 500. Elapsed time 1.91 hour\n",
      "LightFMItemHybridRecommender: Epoch 479 of 500. Elapsed time 1.91 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.40 sec. Users per second: 355\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2830755, PRECISION_RECALL_MIN_DEN: 0.2845649, RECALL: 0.0614697, MAP: 0.1576143, MAP_MIN_DEN: 0.1581812, MRR: 0.5361473, NDCG: 0.2978508, F1: 0.1010060, HIT_RATE: 0.9134707, ARHR_ALL_HITS: 0.9076203, NOVELTY: 0.0056391, AVERAGE_POPULARITY: 0.5056950, DIVERSITY_MEAN_INTER_LIST: 0.9258067, DIVERSITY_HERFINDAHL: 0.9925739, COVERAGE_ITEM: 0.0937483, COVERAGE_ITEM_CORRECT: 0.0612991, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126007, DIVERSITY_GINI: 0.0131041, SHANNON_ENTROPY: 8.1061359, RATIO_DIVERSITY_HERFINDAHL: 0.9929570, RATIO_DIVERSITY_GINI: 0.0528486, RATIO_SHANNON_ENTROPY: 0.6542363, RATIO_AVERAGE_POPULARITY: 2.4881438, RATIO_NOVELTY: 0.0249712, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 480 of 500. Elapsed time 1.92 hour\n",
      "LightFMItemHybridRecommender: Epoch 481 of 500. Elapsed time 1.92 hour\n",
      "LightFMItemHybridRecommender: Epoch 482 of 500. Elapsed time 1.93 hour\n",
      "LightFMItemHybridRecommender: Epoch 483 of 500. Elapsed time 1.93 hour\n",
      "LightFMItemHybridRecommender: Epoch 484 of 500. Elapsed time 1.93 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.33 sec. Users per second: 347\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2831635, PRECISION_RECALL_MIN_DEN: 0.2845637, RECALL: 0.0614238, MAP: 0.1576077, MAP_MIN_DEN: 0.1581581, MRR: 0.5358346, NDCG: 0.2978784, F1: 0.1009497, HIT_RATE: 0.9139840, ARHR_ALL_HITS: 0.9076533, NOVELTY: 0.0056375, AVERAGE_POPULARITY: 0.5064694, DIVERSITY_MEAN_INTER_LIST: 0.9254513, DIVERSITY_HERFINDAHL: 0.9925383, COVERAGE_ITEM: 0.0944128, COVERAGE_ITEM_CORRECT: 0.0611330, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9131136, DIVERSITY_GINI: 0.0130945, SHANNON_ENTROPY: 8.1030815, RATIO_DIVERSITY_HERFINDAHL: 0.9929214, RATIO_DIVERSITY_GINI: 0.0528096, RATIO_SHANNON_ENTROPY: 0.6539898, RATIO_AVERAGE_POPULARITY: 2.4919540, RATIO_NOVELTY: 0.0249642, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 485 of 500. Elapsed time 1.94 hour\n",
      "LightFMItemHybridRecommender: Epoch 486 of 500. Elapsed time 1.94 hour\n",
      "LightFMItemHybridRecommender: Epoch 487 of 500. Elapsed time 1.95 hour\n",
      "LightFMItemHybridRecommender: Epoch 488 of 500. Elapsed time 1.95 hour\n",
      "LightFMItemHybridRecommender: Epoch 489 of 500. Elapsed time 1.95 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.22 sec. Users per second: 348\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2826721, PRECISION_RECALL_MIN_DEN: 0.2841140, RECALL: 0.0613642, MAP: 0.1569537, MAP_MIN_DEN: 0.1575051, MRR: 0.5334513, NDCG: 0.2969249, F1: 0.1008379, HIT_RATE: 0.9138374, ARHR_ALL_HITS: 0.9034445, NOVELTY: 0.0056404, AVERAGE_POPULARITY: 0.5045717, DIVERSITY_MEAN_INTER_LIST: 0.9266334, DIVERSITY_HERFINDAHL: 0.9926565, COVERAGE_ITEM: 0.0933607, COVERAGE_ITEM_CORRECT: 0.0611330, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9129670, DIVERSITY_GINI: 0.0131283, SHANNON_ENTROPY: 8.1128585, RATIO_DIVERSITY_HERFINDAHL: 0.9930397, RATIO_DIVERSITY_GINI: 0.0529459, RATIO_SHANNON_ENTROPY: 0.6547789, RATIO_AVERAGE_POPULARITY: 2.4826169, RATIO_NOVELTY: 0.0249768, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 490 of 500. Elapsed time 1.96 hour\n",
      "LightFMItemHybridRecommender: Epoch 491 of 500. Elapsed time 1.96 hour\n",
      "LightFMItemHybridRecommender: Epoch 492 of 500. Elapsed time 1.97 hour\n",
      "LightFMItemHybridRecommender: Epoch 493 of 500. Elapsed time 1.97 hour\n",
      "LightFMItemHybridRecommender: Epoch 494 of 500. Elapsed time 1.97 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 39.87 sec. Users per second: 342\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2835594, PRECISION_RECALL_MIN_DEN: 0.2849846, RECALL: 0.0615519, MAP: 0.1577254, MAP_MIN_DEN: 0.1582900, MRR: 0.5354527, NDCG: 0.2981095, F1: 0.1011477, HIT_RATE: 0.9135440, ARHR_ALL_HITS: 0.9077852, NOVELTY: 0.0056384, AVERAGE_POPULARITY: 0.5060756, DIVERSITY_MEAN_INTER_LIST: 0.9256571, DIVERSITY_HERFINDAHL: 0.9925589, COVERAGE_ITEM: 0.0937483, COVERAGE_ITEM_CORRECT: 0.0613544, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9126740, DIVERSITY_GINI: 0.0130986, SHANNON_ENTROPY: 8.1047587, RATIO_DIVERSITY_HERFINDAHL: 0.9929420, RATIO_DIVERSITY_GINI: 0.0528264, RATIO_SHANNON_ENTROPY: 0.6541252, RATIO_AVERAGE_POPULARITY: 2.4900166, RATIO_NOVELTY: 0.0249682, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 495 of 500. Elapsed time 1.98 hour\n",
      "LightFMItemHybridRecommender: Epoch 496 of 500. Elapsed time 1.98 hour\n",
      "LightFMItemHybridRecommender: Epoch 497 of 500. Elapsed time 1.99 hour\n",
      "LightFMItemHybridRecommender: Epoch 498 of 500. Elapsed time 1.99 hour\n",
      "LightFMItemHybridRecommender: Epoch 499 of 500. Elapsed time 1.99 hour\n",
      "LightFMItemHybridRecommender: Validation begins...\n",
      "EvaluatorHoldout: Processed 13637 (100.0%) in 38.75 sec. Users per second: 352\n",
      "LightFMItemHybridRecommender: CUTOFF: 10 - PRECISION: 0.2828555, PRECISION_RECALL_MIN_DEN: 0.2842707, RECALL: 0.0613368, MAP: 0.1571565, MAP_MIN_DEN: 0.1577184, MRR: 0.5335131, NDCG: 0.2971868, F1: 0.1008125, HIT_RATE: 0.9128841, ARHR_ALL_HITS: 0.9044579, NOVELTY: 0.0056415, AVERAGE_POPULARITY: 0.5041638, DIVERSITY_MEAN_INTER_LIST: 0.9268986, DIVERSITY_HERFINDAHL: 0.9926831, COVERAGE_ITEM: 0.0943020, COVERAGE_ITEM_CORRECT: 0.0610222, COVERAGE_USER: 0.9990476, COVERAGE_USER_CORRECT: 0.9120147, DIVERSITY_GINI: 0.0132112, SHANNON_ENTROPY: 8.1217857, RATIO_DIVERSITY_HERFINDAHL: 0.9930662, RATIO_DIVERSITY_GINI: 0.0532802, RATIO_SHANNON_ENTROPY: 0.6554994, RATIO_AVERAGE_POPULARITY: 2.4806096, RATIO_NOVELTY: 0.0249820, \n",
      "\n",
      "LightFMItemHybridRecommender: Epoch 500 of 500. Elapsed time 2.00 hour\n",
      "LightFMItemHybridRecommender: Terminating at epoch 500. Best value for 'MAP' at epoch 470 is 0.1579. Elapsed time 2.00 hour\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.FactorizationMachines.LightFMRecommender import LightFMItemHybridRecommender\n",
    "LightFMrecommender = LightFMItemHybridRecommender(urm_train, icm_stacked_all)\n",
    "LightFMrecommender.fit(epochs=500, loss='warp', evaluator_object=evaluator_validation, validation_every_n = 5,\n",
    "                       lower_validations_allowed=10, validation_metric =\"MAP\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "837639c3",
   "metadata": {
    "papermill": {
     "duration": 0.223723,
     "end_time": "2022-01-07T13:50:52.922368",
     "exception": false,
     "start_time": "2022-01-07T13:50:52.698645",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**RP3Beta** MAP(Locale) = 0.17 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "6d120c12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T13:50:53.366610Z",
     "iopub.status.busy": "2022-01-07T13:50:53.365939Z",
     "iopub.status.idle": "2022-01-07T13:51:55.999445Z",
     "shell.execute_reply": "2022-01-07T13:51:55.998659Z"
    },
    "papermill": {
     "duration": 62.859604,
     "end_time": "2022-01-07T13:51:55.999701",
     "exception": false,
     "start_time": "2022-01-07T13:50:53.140097",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from Recommenders.GraphBased.RP3betaRecommender import RP3betaRecommender\n",
    "\n",
    "RP3betaRecommender = RP3betaRecommender(urm_train_validation) \n",
    "RP3betaRecommender.fit(alpha=0.7547636977587721, beta=0.6473567289958607, min_rating=0, topK=989, implicit=True, normalize_similarity = True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "90b9daca",
   "metadata": {
    "papermill": {
     "duration": 0.227728,
     "end_time": "2022-01-07T13:51:56.463624",
     "exception": false,
     "start_time": "2022-01-07T13:51:56.235896",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**P3Alpha** MAP(Locale) = 0.15 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "24e966d6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T13:51:56.902844Z",
     "iopub.status.busy": "2022-01-07T13:51:56.902210Z",
     "iopub.status.idle": "2022-01-07T13:52:32.561202Z",
     "shell.execute_reply": "2022-01-07T13:52:32.561953Z"
    },
    "papermill": {
     "duration": 35.880065,
     "end_time": "2022-01-07T13:52:32.562162",
     "exception": false,
     "start_time": "2022-01-07T13:51:56.682097",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from Recommenders.GraphBased.P3alphaRecommender import P3alphaRecommender\n",
    "\n",
    "P3alphaRecommender = P3alphaRecommender(urm_train_validation) \n",
    "P3alphaRecommender.fit(topK=98, alpha=0.7532805488803477, min_rating=0, implicit=True, normalize_similarity = False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2db6926",
   "metadata": {
    "papermill": {
     "duration": 0.250074,
     "end_time": "2022-01-07T13:52:33.054904",
     "exception": false,
     "start_time": "2022-01-07T13:52:32.804830",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**USER KNN CF** MAP(locale) = 0.177 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "52168ab6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T13:52:33.534716Z",
     "iopub.status.busy": "2022-01-07T13:52:33.534011Z",
     "iopub.status.idle": "2022-01-07T13:53:27.194209Z",
     "shell.execute_reply": "2022-01-07T13:53:27.193654Z"
    },
    "papermill": {
     "duration": 53.895483,
     "end_time": "2022-01-07T13:53:27.194359",
     "exception": false,
     "start_time": "2022-01-07T13:52:33.298876",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Similarity column 13650 (100.0%), 259.91 column/sec. Elapsed time 52.52 sec\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.KNN.UserKNNCFRecommender import UserKNNCFRecommender\n",
    "\n",
    "UserKNNCFRecommender = UserKNNCFRecommender(urm_train_validation) \n",
    "UserKNNCFRecommender.fit(topK=463, shrink=0, similarity='tversky', normalize=True, tversky_alpha = 1.558730312825966, tversky_beta = 0.8720310634476225)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a6dbbfd",
   "metadata": {
    "papermill": {
     "duration": 0.231852,
     "end_time": "2022-01-07T13:53:27.649672",
     "exception": false,
     "start_time": "2022-01-07T13:53:27.417820",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**ITEM KNN CF** MAP(locale) = 0.175 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0561ffe4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T13:53:28.120325Z",
     "iopub.status.busy": "2022-01-07T13:53:28.119682Z",
     "iopub.status.idle": "2022-01-07T13:53:50.623091Z",
     "shell.execute_reply": "2022-01-07T13:53:50.622526Z"
    },
    "papermill": {
     "duration": 22.740266,
     "end_time": "2022-01-07T13:53:50.623235",
     "exception": false,
     "start_time": "2022-01-07T13:53:27.882969",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Similarity column 18059 (100.0%), 835.00 column/sec. Elapsed time 21.63 sec\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.KNN.ItemKNNCFRecommender import ItemKNNCFRecommender\n",
    "\n",
    "ItemKNNCFRecommender = ItemKNNCFRecommender(urm_train_validation) \n",
    "ItemKNNCFRecommender.fit(topK=27, shrink=1000, similarity='tversky', normalize=True, tversky_alpha = 0.0, tversky_beta = 2.0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ad10f30",
   "metadata": {
    "papermill": {
     "duration": 0.238267,
     "end_time": "2022-01-07T13:53:51.088941",
     "exception": false,
     "start_time": "2022-01-07T13:53:50.850674",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**SLIM BPR** MAP(locale) = 0.17 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "e218ed24",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T13:53:51.568161Z",
     "iopub.status.busy": "2022-01-07T13:53:51.565250Z",
     "iopub.status.idle": "2022-01-07T14:05:49.290604Z",
     "shell.execute_reply": "2022-01-07T14:05:49.291086Z"
    },
    "papermill": {
     "duration": 717.962137,
     "end_time": "2022-01-07T14:05:49.291266",
     "exception": false,
     "start_time": "2022-01-07T13:53:51.329129",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SLIM_BPR_Recommender: Automatic selection of fastest train mode. Available RAM is 16083.00 MB (89.35%) of 18001.00 MB, required is 1304.51 MB. Using dense matrix.\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.42E-02. Sample per second: 9891\n",
      "SLIM_BPR_Recommender: Epoch 1 of 795. Elapsed time 0.88 sec\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 8.01E-02. Sample per second: 10826\n",
      "SLIM_BPR_Recommender: Epoch 2 of 795. Elapsed time 1.76 sec\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 1.85E-01. Sample per second: 12131\n",
      "SLIM_BPR_Recommender: Epoch 3 of 795. Elapsed time 2.63 sec\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 3.09E-01. Sample per second: 13942\n",
      "SLIM_BPR_Recommender: Epoch 4 of 795. Elapsed time 3.48 sec\n",
      "Processed 13650 (100.0%) in 1.96 sec. BPR loss is 4.46E-01. Sample per second: 6958\n",
      "SLIM_BPR_Recommender: Epoch 5 of 795. Elapsed time 4.47 sec\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 5.91E-01. Sample per second: 7617\n",
      "SLIM_BPR_Recommender: Epoch 6 of 795. Elapsed time 5.30 sec\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 7.43E-01. Sample per second: 8259\n",
      "SLIM_BPR_Recommender: Epoch 7 of 795. Elapsed time 6.16 sec\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 8.68E-01. Sample per second: 9123\n",
      "SLIM_BPR_Recommender: Epoch 8 of 795. Elapsed time 7.00 sec\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.03E+00. Sample per second: 9870\n",
      "SLIM_BPR_Recommender: Epoch 9 of 795. Elapsed time 7.89 sec\n",
      "Processed 13650 (100.0%) in 1.22 sec. BPR loss is 1.18E+00. Sample per second: 11178\n",
      "SLIM_BPR_Recommender: Epoch 10 of 795. Elapsed time 8.73 sec\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.32E+00. Sample per second: 13112\n",
      "SLIM_BPR_Recommender: Epoch 11 of 795. Elapsed time 9.54 sec\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.49E+00. Sample per second: 15557\n",
      "SLIM_BPR_Recommender: Epoch 12 of 795. Elapsed time 10.38 sec\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.59E+00. Sample per second: 7963\n",
      "SLIM_BPR_Recommender: Epoch 13 of 795. Elapsed time 11.22 sec\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.75E+00. Sample per second: 8749\n",
      "SLIM_BPR_Recommender: Epoch 14 of 795. Elapsed time 12.06 sec\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.88E+00. Sample per second: 9679\n",
      "SLIM_BPR_Recommender: Epoch 15 of 795. Elapsed time 12.91 sec\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 2.09E+00. Sample per second: 10677\n",
      "SLIM_BPR_Recommender: Epoch 16 of 795. Elapsed time 13.78 sec\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 2.16E+00. Sample per second: 11813\n",
      "SLIM_BPR_Recommender: Epoch 17 of 795. Elapsed time 14.66 sec\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 2.31E+00. Sample per second: 13841\n",
      "SLIM_BPR_Recommender: Epoch 18 of 795. Elapsed time 15.49 sec\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 2.43E+00. Sample per second: 7514\n",
      "SLIM_BPR_Recommender: Epoch 19 of 795. Elapsed time 16.32 sec\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 2.55E+00. Sample per second: 8314\n",
      "SLIM_BPR_Recommender: Epoch 20 of 795. Elapsed time 17.15 sec\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.65E+00. Sample per second: 9149\n",
      "SLIM_BPR_Recommender: Epoch 21 of 795. Elapsed time 18.00 sec\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 2.93E+00. Sample per second: 10306\n",
      "SLIM_BPR_Recommender: Epoch 22 of 795. Elapsed time 18.83 sec\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 2.94E+00. Sample per second: 11799\n",
      "SLIM_BPR_Recommender: Epoch 23 of 795. Elapsed time 19.66 sec\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 3.08E+00. Sample per second: 13659\n",
      "SLIM_BPR_Recommender: Epoch 24 of 795. Elapsed time 20.50 sec\n",
      "Processed 13650 (100.0%) in 0.85 sec. BPR loss is 3.18E+00. Sample per second: 15971\n",
      "SLIM_BPR_Recommender: Epoch 25 of 795. Elapsed time 21.36 sec\n",
      "Processed 13650 (100.0%) in 1.69 sec. BPR loss is 3.40E+00. Sample per second: 8093\n",
      "SLIM_BPR_Recommender: Epoch 26 of 795. Elapsed time 22.19 sec\n",
      "Processed 13650 (100.0%) in 1.53 sec. BPR loss is 3.35E+00. Sample per second: 8923\n",
      "SLIM_BPR_Recommender: Epoch 27 of 795. Elapsed time 23.03 sec\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 3.56E+00. Sample per second: 10044\n",
      "SLIM_BPR_Recommender: Epoch 28 of 795. Elapsed time 23.86 sec\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 3.66E+00. Sample per second: 11339\n",
      "SLIM_BPR_Recommender: Epoch 29 of 795. Elapsed time 24.71 sec\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 3.80E+00. Sample per second: 13136\n",
      "SLIM_BPR_Recommender: Epoch 30 of 795. Elapsed time 25.54 sec\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 3.89E+00. Sample per second: 15026\n",
      "SLIM_BPR_Recommender: Epoch 31 of 795. Elapsed time 26.41 sec\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 3.95E+00. Sample per second: 7729\n",
      "SLIM_BPR_Recommender: Epoch 32 of 795. Elapsed time 27.27 sec\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 4.09E+00. Sample per second: 8368\n",
      "SLIM_BPR_Recommender: Epoch 33 of 795. Elapsed time 28.14 sec\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 4.31E+00. Sample per second: 9348\n",
      "SLIM_BPR_Recommender: Epoch 34 of 795. Elapsed time 28.96 sec\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 4.25E+00. Sample per second: 10832\n",
      "SLIM_BPR_Recommender: Epoch 35 of 795. Elapsed time 29.76 sec\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 4.41E+00. Sample per second: 12363\n",
      "SLIM_BPR_Recommender: Epoch 36 of 795. Elapsed time 30.61 sec\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 4.63E+00. Sample per second: 14644\n",
      "SLIM_BPR_Recommender: Epoch 37 of 795. Elapsed time 31.44 sec\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 4.71E+00. Sample per second: 7807\n",
      "SLIM_BPR_Recommender: Epoch 38 of 795. Elapsed time 32.25 sec\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 4.75E+00. Sample per second: 8772\n",
      "SLIM_BPR_Recommender: Epoch 39 of 795. Elapsed time 33.06 sec\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 4.80E+00. Sample per second: 9843\n",
      "SLIM_BPR_Recommender: Epoch 40 of 795. Elapsed time 33.89 sec\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 4.92E+00. Sample per second: 10920\n",
      "SLIM_BPR_Recommender: Epoch 41 of 795. Elapsed time 34.75 sec\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 5.07E+00. Sample per second: 12694\n",
      "SLIM_BPR_Recommender: Epoch 42 of 795. Elapsed time 35.58 sec\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 5.33E+00. Sample per second: 14366\n",
      "SLIM_BPR_Recommender: Epoch 43 of 795. Elapsed time 36.46 sec\n",
      "Processed 13650 (100.0%) in 1.84 sec. BPR loss is 5.30E+00. Sample per second: 7430\n",
      "SLIM_BPR_Recommender: Epoch 44 of 795. Elapsed time 37.34 sec\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 5.39E+00. Sample per second: 8142\n",
      "SLIM_BPR_Recommender: Epoch 45 of 795. Elapsed time 38.18 sec\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 5.46E+00. Sample per second: 9079\n",
      "SLIM_BPR_Recommender: Epoch 46 of 795. Elapsed time 39.01 sec\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 5.60E+00. Sample per second: 10513\n",
      "SLIM_BPR_Recommender: Epoch 47 of 795. Elapsed time 39.80 sec\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 5.64E+00. Sample per second: 12133\n",
      "SLIM_BPR_Recommender: Epoch 48 of 795. Elapsed time 40.63 sec\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 5.73E+00. Sample per second: 14986\n",
      "SLIM_BPR_Recommender: Epoch 49 of 795. Elapsed time 41.42 sec\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 5.81E+00. Sample per second: 7969\n",
      "SLIM_BPR_Recommender: Epoch 50 of 795. Elapsed time 42.22 sec\n",
      "Processed 13650 (100.0%) in 1.52 sec. BPR loss is 6.02E+00. Sample per second: 8971\n",
      "SLIM_BPR_Recommender: Epoch 51 of 795. Elapsed time 43.03 sec\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 5.94E+00. Sample per second: 10382\n",
      "SLIM_BPR_Recommender: Epoch 52 of 795. Elapsed time 43.82 sec\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 6.04E+00. Sample per second: 12089\n",
      "SLIM_BPR_Recommender: Epoch 53 of 795. Elapsed time 44.63 sec\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 6.23E+00. Sample per second: 14671\n",
      "SLIM_BPR_Recommender: Epoch 54 of 795. Elapsed time 45.43 sec\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 6.34E+00. Sample per second: 7727\n",
      "SLIM_BPR_Recommender: Epoch 55 of 795. Elapsed time 46.27 sec\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 6.66E+00. Sample per second: 8445\n",
      "SLIM_BPR_Recommender: Epoch 56 of 795. Elapsed time 47.12 sec\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 6.47E+00. Sample per second: 9289\n",
      "SLIM_BPR_Recommender: Epoch 57 of 795. Elapsed time 47.97 sec\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 6.50E+00. Sample per second: 10375\n",
      "SLIM_BPR_Recommender: Epoch 58 of 795. Elapsed time 48.82 sec\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 6.77E+00. Sample per second: 12069\n",
      "SLIM_BPR_Recommender: Epoch 59 of 795. Elapsed time 49.63 sec\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 6.68E+00. Sample per second: 14154\n",
      "SLIM_BPR_Recommender: Epoch 60 of 795. Elapsed time 50.47 sec\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 6.94E+00. Sample per second: 7498\n",
      "SLIM_BPR_Recommender: Epoch 61 of 795. Elapsed time 51.32 sec\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 6.76E+00. Sample per second: 7942\n",
      "SLIM_BPR_Recommender: Epoch 62 of 795. Elapsed time 52.22 sec\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 6.78E+00. Sample per second: 8573\n",
      "SLIM_BPR_Recommender: Epoch 63 of 795. Elapsed time 53.10 sec\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 7.08E+00. Sample per second: 9477\n",
      "SLIM_BPR_Recommender: Epoch 64 of 795. Elapsed time 53.95 sec\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 7.03E+00. Sample per second: 10532\n",
      "SLIM_BPR_Recommender: Epoch 65 of 795. Elapsed time 54.80 sec\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 7.09E+00. Sample per second: 11940\n",
      "SLIM_BPR_Recommender: Epoch 66 of 795. Elapsed time 55.65 sec\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 7.23E+00. Sample per second: 14264\n",
      "SLIM_BPR_Recommender: Epoch 67 of 795. Elapsed time 56.46 sec\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 7.39E+00. Sample per second: 7661\n",
      "SLIM_BPR_Recommender: Epoch 68 of 795. Elapsed time 57.29 sec\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 7.27E+00. Sample per second: 8440\n",
      "SLIM_BPR_Recommender: Epoch 69 of 795. Elapsed time 58.12 sec\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 7.35E+00. Sample per second: 9355\n",
      "SLIM_BPR_Recommender: Epoch 70 of 795. Elapsed time 58.96 sec\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 7.51E+00. Sample per second: 10483\n",
      "SLIM_BPR_Recommender: Epoch 71 of 795. Elapsed time 59.81 sec\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 7.47E+00. Sample per second: 12218\n",
      "SLIM_BPR_Recommender: Epoch 72 of 795. Elapsed time 1.01 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 7.49E+00. Sample per second: 14423\n",
      "SLIM_BPR_Recommender: Epoch 73 of 795. Elapsed time 1.02 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 7.90E+00. Sample per second: 7769\n",
      "SLIM_BPR_Recommender: Epoch 74 of 795. Elapsed time 1.04 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 7.76E+00. Sample per second: 8742\n",
      "SLIM_BPR_Recommender: Epoch 75 of 795. Elapsed time 1.05 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 7.80E+00. Sample per second: 10045\n",
      "SLIM_BPR_Recommender: Epoch 76 of 795. Elapsed time 1.06 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 7.97E+00. Sample per second: 11601\n",
      "SLIM_BPR_Recommender: Epoch 77 of 795. Elapsed time 1.08 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 8.14E+00. Sample per second: 14019\n",
      "SLIM_BPR_Recommender: Epoch 78 of 795. Elapsed time 1.09 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 7.97E+00. Sample per second: 7604\n",
      "SLIM_BPR_Recommender: Epoch 79 of 795. Elapsed time 1.10 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 8.35E+00. Sample per second: 8513\n",
      "SLIM_BPR_Recommender: Epoch 80 of 795. Elapsed time 1.12 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 8.15E+00. Sample per second: 7894\n",
      "SLIM_BPR_Recommender: Epoch 81 of 795. Elapsed time 1.14 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 7.99E+00. Sample per second: 8463\n",
      "SLIM_BPR_Recommender: Epoch 82 of 795. Elapsed time 1.15 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 8.27E+00. Sample per second: 8601\n",
      "SLIM_BPR_Recommender: Epoch 83 of 795. Elapsed time 1.17 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 8.35E+00. Sample per second: 9624\n",
      "SLIM_BPR_Recommender: Epoch 84 of 795. Elapsed time 1.18 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 8.36E+00. Sample per second: 10854\n",
      "SLIM_BPR_Recommender: Epoch 85 of 795. Elapsed time 1.20 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 8.54E+00. Sample per second: 12694\n",
      "SLIM_BPR_Recommender: Epoch 86 of 795. Elapsed time 1.21 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 8.39E+00. Sample per second: 14986\n",
      "SLIM_BPR_Recommender: Epoch 87 of 795. Elapsed time 1.22 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 8.50E+00. Sample per second: 7864\n",
      "SLIM_BPR_Recommender: Epoch 88 of 795. Elapsed time 1.24 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 8.87E+00. Sample per second: 8767\n",
      "SLIM_BPR_Recommender: Epoch 89 of 795. Elapsed time 1.25 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 8.65E+00. Sample per second: 9864\n",
      "SLIM_BPR_Recommender: Epoch 90 of 795. Elapsed time 1.26 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 8.93E+00. Sample per second: 11274\n",
      "SLIM_BPR_Recommender: Epoch 91 of 795. Elapsed time 1.28 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 9.00E+00. Sample per second: 13309\n",
      "SLIM_BPR_Recommender: Epoch 92 of 795. Elapsed time 1.29 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 8.98E+00. Sample per second: 15937\n",
      "SLIM_BPR_Recommender: Epoch 93 of 795. Elapsed time 1.31 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 9.15E+00. Sample per second: 8170\n",
      "SLIM_BPR_Recommender: Epoch 94 of 795. Elapsed time 1.32 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 9.29E+00. Sample per second: 9230\n",
      "SLIM_BPR_Recommender: Epoch 95 of 795. Elapsed time 1.33 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 9.18E+00. Sample per second: 10115\n",
      "SLIM_BPR_Recommender: Epoch 96 of 795. Elapsed time 1.35 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 9.01E+00. Sample per second: 11502\n",
      "SLIM_BPR_Recommender: Epoch 97 of 795. Elapsed time 1.36 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 8.96E+00. Sample per second: 13512\n",
      "SLIM_BPR_Recommender: Epoch 98 of 795. Elapsed time 1.38 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 9.23E+00. Sample per second: 15906\n",
      "SLIM_BPR_Recommender: Epoch 99 of 795. Elapsed time 1.39 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 9.36E+00. Sample per second: 8021\n",
      "SLIM_BPR_Recommender: Epoch 100 of 795. Elapsed time 1.40 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 9.35E+00. Sample per second: 8886\n",
      "SLIM_BPR_Recommender: Epoch 101 of 795. Elapsed time 1.42 min\n",
      "Processed 13650 (100.0%) in 1.37 sec. BPR loss is 9.47E+00. Sample per second: 9994\n",
      "SLIM_BPR_Recommender: Epoch 102 of 795. Elapsed time 1.43 min\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 9.64E+00. Sample per second: 11418\n",
      "SLIM_BPR_Recommender: Epoch 103 of 795. Elapsed time 1.44 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 9.62E+00. Sample per second: 12931\n",
      "SLIM_BPR_Recommender: Epoch 104 of 795. Elapsed time 1.46 min\n",
      "Processed 13650 (100.0%) in 0.89 sec. BPR loss is 9.35E+00. Sample per second: 15245\n",
      "SLIM_BPR_Recommender: Epoch 105 of 795. Elapsed time 1.47 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 9.93E+00. Sample per second: 7948\n",
      "SLIM_BPR_Recommender: Epoch 106 of 795. Elapsed time 1.49 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 9.54E+00. Sample per second: 8595\n",
      "SLIM_BPR_Recommender: Epoch 107 of 795. Elapsed time 1.50 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 9.63E+00. Sample per second: 9344\n",
      "SLIM_BPR_Recommender: Epoch 108 of 795. Elapsed time 1.52 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 9.86E+00. Sample per second: 10265\n",
      "SLIM_BPR_Recommender: Epoch 109 of 795. Elapsed time 1.53 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 1.00E+01. Sample per second: 11627\n",
      "SLIM_BPR_Recommender: Epoch 110 of 795. Elapsed time 1.54 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 9.88E+00. Sample per second: 13244\n",
      "SLIM_BPR_Recommender: Epoch 111 of 795. Elapsed time 1.56 min\n",
      "Processed 13650 (100.0%) in 0.89 sec. BPR loss is 9.92E+00. Sample per second: 15331\n",
      "SLIM_BPR_Recommender: Epoch 112 of 795. Elapsed time 1.57 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.03E+01. Sample per second: 7584\n",
      "SLIM_BPR_Recommender: Epoch 113 of 795. Elapsed time 1.59 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 1.02E+01. Sample per second: 8214\n",
      "SLIM_BPR_Recommender: Epoch 114 of 795. Elapsed time 1.60 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.03E+01. Sample per second: 8843\n",
      "SLIM_BPR_Recommender: Epoch 115 of 795. Elapsed time 1.62 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.01E+01. Sample per second: 9895\n",
      "SLIM_BPR_Recommender: Epoch 116 of 795. Elapsed time 1.63 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.02E+01. Sample per second: 11232\n",
      "SLIM_BPR_Recommender: Epoch 117 of 795. Elapsed time 1.65 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.02E+01. Sample per second: 12984\n",
      "SLIM_BPR_Recommender: Epoch 118 of 795. Elapsed time 1.66 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.04E+01. Sample per second: 15500\n",
      "SLIM_BPR_Recommender: Epoch 119 of 795. Elapsed time 1.67 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.04E+01. Sample per second: 7843\n",
      "SLIM_BPR_Recommender: Epoch 120 of 795. Elapsed time 1.69 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.00E+01. Sample per second: 8454\n",
      "SLIM_BPR_Recommender: Epoch 121 of 795. Elapsed time 1.70 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.05E+01. Sample per second: 8558\n",
      "SLIM_BPR_Recommender: Epoch 122 of 795. Elapsed time 1.72 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.04E+01. Sample per second: 9364\n",
      "SLIM_BPR_Recommender: Epoch 123 of 795. Elapsed time 1.73 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.06E+01. Sample per second: 10568\n",
      "SLIM_BPR_Recommender: Epoch 124 of 795. Elapsed time 1.75 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.05E+01. Sample per second: 12022\n",
      "SLIM_BPR_Recommender: Epoch 125 of 795. Elapsed time 1.76 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 1.09E+01. Sample per second: 14103\n",
      "SLIM_BPR_Recommender: Epoch 126 of 795. Elapsed time 1.77 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 1.06E+01. Sample per second: 7609\n",
      "SLIM_BPR_Recommender: Epoch 127 of 795. Elapsed time 1.79 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.09E+01. Sample per second: 8278\n",
      "SLIM_BPR_Recommender: Epoch 128 of 795. Elapsed time 1.80 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.08E+01. Sample per second: 9156\n",
      "SLIM_BPR_Recommender: Epoch 129 of 795. Elapsed time 1.82 min\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 1.10E+01. Sample per second: 10390\n",
      "SLIM_BPR_Recommender: Epoch 130 of 795. Elapsed time 1.83 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 1.08E+01. Sample per second: 11646\n",
      "SLIM_BPR_Recommender: Epoch 131 of 795. Elapsed time 1.84 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 1.11E+01. Sample per second: 12049\n",
      "SLIM_BPR_Recommender: Epoch 132 of 795. Elapsed time 1.86 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 1.10E+01. Sample per second: 13288\n",
      "SLIM_BPR_Recommender: Epoch 133 of 795. Elapsed time 1.88 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.09E+01. Sample per second: 14866\n",
      "SLIM_BPR_Recommender: Epoch 134 of 795. Elapsed time 1.89 min\n",
      "Processed 13650 (100.0%) in 1.90 sec. BPR loss is 1.16E+01. Sample per second: 7167\n",
      "SLIM_BPR_Recommender: Epoch 135 of 795. Elapsed time 1.91 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.14E+01. Sample per second: 7577\n",
      "SLIM_BPR_Recommender: Epoch 136 of 795. Elapsed time 1.92 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.13E+01. Sample per second: 8303\n",
      "SLIM_BPR_Recommender: Epoch 137 of 795. Elapsed time 1.94 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.12E+01. Sample per second: 9334\n",
      "SLIM_BPR_Recommender: Epoch 138 of 795. Elapsed time 1.95 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.13E+01. Sample per second: 10324\n",
      "SLIM_BPR_Recommender: Epoch 139 of 795. Elapsed time 1.96 min\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 1.11E+01. Sample per second: 11344\n",
      "SLIM_BPR_Recommender: Epoch 140 of 795. Elapsed time 1.98 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 1.11E+01. Sample per second: 13225\n",
      "SLIM_BPR_Recommender: Epoch 141 of 795. Elapsed time 1.99 min\n",
      "Processed 13650 (100.0%) in 0.85 sec. BPR loss is 1.15E+01. Sample per second: 16105\n",
      "SLIM_BPR_Recommender: Epoch 142 of 795. Elapsed time 2.01 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.15E+01. Sample per second: 7872\n",
      "SLIM_BPR_Recommender: Epoch 143 of 795. Elapsed time 2.02 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.17E+01. Sample per second: 8594\n",
      "SLIM_BPR_Recommender: Epoch 144 of 795. Elapsed time 2.03 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.14E+01. Sample per second: 9445\n",
      "SLIM_BPR_Recommender: Epoch 145 of 795. Elapsed time 2.05 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 1.20E+01. Sample per second: 10534\n",
      "SLIM_BPR_Recommender: Epoch 146 of 795. Elapsed time 2.06 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 1.19E+01. Sample per second: 12386\n",
      "SLIM_BPR_Recommender: Epoch 147 of 795. Elapsed time 2.08 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 1.18E+01. Sample per second: 13577\n",
      "SLIM_BPR_Recommender: Epoch 148 of 795. Elapsed time 2.09 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.17E+01. Sample per second: 14491\n",
      "SLIM_BPR_Recommender: Epoch 149 of 795. Elapsed time 2.11 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.16E+01. Sample per second: 7596\n",
      "SLIM_BPR_Recommender: Epoch 150 of 795. Elapsed time 2.12 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.18E+01. Sample per second: 8491\n",
      "SLIM_BPR_Recommender: Epoch 151 of 795. Elapsed time 2.14 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 1.20E+01. Sample per second: 9532\n",
      "SLIM_BPR_Recommender: Epoch 152 of 795. Elapsed time 2.15 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 1.20E+01. Sample per second: 10728\n",
      "SLIM_BPR_Recommender: Epoch 153 of 795. Elapsed time 2.16 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 1.20E+01. Sample per second: 11622\n",
      "SLIM_BPR_Recommender: Epoch 154 of 795. Elapsed time 2.18 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 1.22E+01. Sample per second: 12784\n",
      "SLIM_BPR_Recommender: Epoch 155 of 795. Elapsed time 2.19 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.19E+01. Sample per second: 14295\n",
      "SLIM_BPR_Recommender: Epoch 156 of 795. Elapsed time 2.21 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.25E+01. Sample per second: 7491\n",
      "SLIM_BPR_Recommender: Epoch 157 of 795. Elapsed time 2.22 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 1.22E+01. Sample per second: 8028\n",
      "SLIM_BPR_Recommender: Epoch 158 of 795. Elapsed time 2.24 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.25E+01. Sample per second: 8749\n",
      "SLIM_BPR_Recommender: Epoch 159 of 795. Elapsed time 2.25 min\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 1.23E+01. Sample per second: 8425\n",
      "SLIM_BPR_Recommender: Epoch 160 of 795. Elapsed time 2.27 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.24E+01. Sample per second: 9168\n",
      "SLIM_BPR_Recommender: Epoch 161 of 795. Elapsed time 2.28 min\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 1.27E+01. Sample per second: 10438\n",
      "SLIM_BPR_Recommender: Epoch 162 of 795. Elapsed time 2.30 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.24E+01. Sample per second: 11884\n",
      "SLIM_BPR_Recommender: Epoch 163 of 795. Elapsed time 2.31 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.27E+01. Sample per second: 14356\n",
      "SLIM_BPR_Recommender: Epoch 164 of 795. Elapsed time 2.32 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 1.23E+01. Sample per second: 7687\n",
      "SLIM_BPR_Recommender: Epoch 165 of 795. Elapsed time 2.34 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.23E+01. Sample per second: 8571\n",
      "SLIM_BPR_Recommender: Epoch 166 of 795. Elapsed time 2.35 min\n",
      "Processed 13650 (100.0%) in 1.45 sec. BPR loss is 1.23E+01. Sample per second: 9431\n",
      "SLIM_BPR_Recommender: Epoch 167 of 795. Elapsed time 2.37 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 1.20E+01. Sample per second: 10687\n",
      "SLIM_BPR_Recommender: Epoch 168 of 795. Elapsed time 2.38 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 1.26E+01. Sample per second: 12479\n",
      "SLIM_BPR_Recommender: Epoch 169 of 795. Elapsed time 2.39 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.22E+01. Sample per second: 14584\n",
      "SLIM_BPR_Recommender: Epoch 170 of 795. Elapsed time 2.41 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.23E+01. Sample per second: 7809\n",
      "SLIM_BPR_Recommender: Epoch 171 of 795. Elapsed time 2.42 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 1.28E+01. Sample per second: 8541\n",
      "SLIM_BPR_Recommender: Epoch 172 of 795. Elapsed time 2.44 min\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 1.28E+01. Sample per second: 9291\n",
      "SLIM_BPR_Recommender: Epoch 173 of 795. Elapsed time 2.45 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 1.29E+01. Sample per second: 10274\n",
      "SLIM_BPR_Recommender: Epoch 174 of 795. Elapsed time 2.46 min\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 1.29E+01. Sample per second: 11799\n",
      "SLIM_BPR_Recommender: Epoch 175 of 795. Elapsed time 2.48 min\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 1.32E+01. Sample per second: 13613\n",
      "SLIM_BPR_Recommender: Epoch 176 of 795. Elapsed time 2.49 min\n",
      "Processed 13650 (100.0%) in 0.83 sec. BPR loss is 1.27E+01. Sample per second: 16350\n",
      "SLIM_BPR_Recommender: Epoch 177 of 795. Elapsed time 2.51 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 1.26E+01. Sample per second: 8134\n",
      "SLIM_BPR_Recommender: Epoch 178 of 795. Elapsed time 2.52 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.30E+01. Sample per second: 8685\n",
      "SLIM_BPR_Recommender: Epoch 179 of 795. Elapsed time 2.53 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.26E+01. Sample per second: 9674\n",
      "SLIM_BPR_Recommender: Epoch 180 of 795. Elapsed time 2.55 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.30E+01. Sample per second: 10813\n",
      "SLIM_BPR_Recommender: Epoch 181 of 795. Elapsed time 2.56 min\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 1.25E+01. Sample per second: 12237\n",
      "SLIM_BPR_Recommender: Epoch 182 of 795. Elapsed time 2.58 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 1.27E+01. Sample per second: 14269\n",
      "SLIM_BPR_Recommender: Epoch 183 of 795. Elapsed time 2.59 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.32E+01. Sample per second: 7504\n",
      "SLIM_BPR_Recommender: Epoch 184 of 795. Elapsed time 2.61 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 1.32E+01. Sample per second: 8184\n",
      "SLIM_BPR_Recommender: Epoch 185 of 795. Elapsed time 2.62 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 1.29E+01. Sample per second: 8238\n",
      "SLIM_BPR_Recommender: Epoch 186 of 795. Elapsed time 2.64 min\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 1.31E+01. Sample per second: 9095\n",
      "SLIM_BPR_Recommender: Epoch 187 of 795. Elapsed time 2.65 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 1.32E+01. Sample per second: 10241\n",
      "SLIM_BPR_Recommender: Epoch 188 of 795. Elapsed time 2.66 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.33E+01. Sample per second: 11912\n",
      "SLIM_BPR_Recommender: Epoch 189 of 795. Elapsed time 2.68 min\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 1.29E+01. Sample per second: 13759\n",
      "SLIM_BPR_Recommender: Epoch 190 of 795. Elapsed time 2.69 min\n",
      "Processed 13650 (100.0%) in 1.84 sec. BPR loss is 1.37E+01. Sample per second: 7427\n",
      "SLIM_BPR_Recommender: Epoch 191 of 795. Elapsed time 2.71 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 1.35E+01. Sample per second: 8212\n",
      "SLIM_BPR_Recommender: Epoch 192 of 795. Elapsed time 2.72 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 1.35E+01. Sample per second: 9200\n",
      "SLIM_BPR_Recommender: Epoch 193 of 795. Elapsed time 2.73 min\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 1.36E+01. Sample per second: 10390\n",
      "SLIM_BPR_Recommender: Epoch 194 of 795. Elapsed time 2.75 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.35E+01. Sample per second: 11253\n",
      "SLIM_BPR_Recommender: Epoch 195 of 795. Elapsed time 2.76 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.32E+01. Sample per second: 11837\n",
      "SLIM_BPR_Recommender: Epoch 196 of 795. Elapsed time 2.78 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 1.37E+01. Sample per second: 14016\n",
      "SLIM_BPR_Recommender: Epoch 197 of 795. Elapsed time 2.79 min\n",
      "Processed 13650 (100.0%) in 1.91 sec. BPR loss is 1.36E+01. Sample per second: 7163\n",
      "SLIM_BPR_Recommender: Epoch 198 of 795. Elapsed time 2.81 min\n",
      "Processed 13650 (100.0%) in 1.87 sec. BPR loss is 1.38E+01. Sample per second: 7311\n",
      "SLIM_BPR_Recommender: Epoch 199 of 795. Elapsed time 2.82 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 1.35E+01. Sample per second: 8047\n",
      "SLIM_BPR_Recommender: Epoch 200 of 795. Elapsed time 2.84 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.37E+01. Sample per second: 9161\n",
      "SLIM_BPR_Recommender: Epoch 201 of 795. Elapsed time 2.85 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.37E+01. Sample per second: 10329\n",
      "SLIM_BPR_Recommender: Epoch 202 of 795. Elapsed time 2.86 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 1.38E+01. Sample per second: 11066\n",
      "SLIM_BPR_Recommender: Epoch 203 of 795. Elapsed time 2.88 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 1.39E+01. Sample per second: 12368\n",
      "SLIM_BPR_Recommender: Epoch 204 of 795. Elapsed time 2.89 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 1.38E+01. Sample per second: 14251\n",
      "SLIM_BPR_Recommender: Epoch 205 of 795. Elapsed time 2.91 min\n",
      "Processed 13650 (100.0%) in 1.81 sec. BPR loss is 1.37E+01. Sample per second: 7557\n",
      "SLIM_BPR_Recommender: Epoch 206 of 795. Elapsed time 2.92 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.39E+01. Sample per second: 8269\n",
      "SLIM_BPR_Recommender: Epoch 207 of 795. Elapsed time 2.94 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 1.39E+01. Sample per second: 9043\n",
      "SLIM_BPR_Recommender: Epoch 208 of 795. Elapsed time 2.95 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 1.42E+01. Sample per second: 10030\n",
      "SLIM_BPR_Recommender: Epoch 209 of 795. Elapsed time 2.96 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 1.43E+01. Sample per second: 11634\n",
      "SLIM_BPR_Recommender: Epoch 210 of 795. Elapsed time 2.98 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 1.37E+01. Sample per second: 13487\n",
      "SLIM_BPR_Recommender: Epoch 211 of 795. Elapsed time 2.99 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.39E+01. Sample per second: 15754\n",
      "SLIM_BPR_Recommender: Epoch 212 of 795. Elapsed time 3.01 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 1.38E+01. Sample per second: 8034\n",
      "SLIM_BPR_Recommender: Epoch 213 of 795. Elapsed time 3.02 min\n",
      "Processed 13650 (100.0%) in 1.52 sec. BPR loss is 1.37E+01. Sample per second: 8974\n",
      "SLIM_BPR_Recommender: Epoch 214 of 795. Elapsed time 3.03 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.42E+01. Sample per second: 9909\n",
      "SLIM_BPR_Recommender: Epoch 215 of 795. Elapsed time 3.05 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 1.40E+01. Sample per second: 10711\n",
      "SLIM_BPR_Recommender: Epoch 216 of 795. Elapsed time 3.06 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 1.38E+01. Sample per second: 12458\n",
      "SLIM_BPR_Recommender: Epoch 217 of 795. Elapsed time 3.08 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 1.46E+01. Sample per second: 14949\n",
      "SLIM_BPR_Recommender: Epoch 218 of 795. Elapsed time 3.09 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.45E+01. Sample per second: 7861\n",
      "SLIM_BPR_Recommender: Epoch 219 of 795. Elapsed time 3.10 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.41E+01. Sample per second: 8754\n",
      "SLIM_BPR_Recommender: Epoch 220 of 795. Elapsed time 3.12 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.40E+01. Sample per second: 9619\n",
      "SLIM_BPR_Recommender: Epoch 221 of 795. Elapsed time 3.13 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.40E+01. Sample per second: 10829\n",
      "SLIM_BPR_Recommender: Epoch 222 of 795. Elapsed time 3.15 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 1.41E+01. Sample per second: 12089\n",
      "SLIM_BPR_Recommender: Epoch 223 of 795. Elapsed time 3.16 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 1.44E+01. Sample per second: 13854\n",
      "SLIM_BPR_Recommender: Epoch 224 of 795. Elapsed time 3.17 min\n",
      "Processed 13650 (100.0%) in 1.86 sec. BPR loss is 1.44E+01. Sample per second: 7348\n",
      "SLIM_BPR_Recommender: Epoch 225 of 795. Elapsed time 3.19 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.43E+01. Sample per second: 7977\n",
      "SLIM_BPR_Recommender: Epoch 226 of 795. Elapsed time 3.20 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.46E+01. Sample per second: 8323\n",
      "SLIM_BPR_Recommender: Epoch 227 of 795. Elapsed time 3.22 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.46E+01. Sample per second: 8764\n",
      "SLIM_BPR_Recommender: Epoch 228 of 795. Elapsed time 3.23 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.46E+01. Sample per second: 9665\n",
      "SLIM_BPR_Recommender: Epoch 229 of 795. Elapsed time 3.25 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 1.44E+01. Sample per second: 10652\n",
      "SLIM_BPR_Recommender: Epoch 230 of 795. Elapsed time 3.26 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.43E+01. Sample per second: 12015\n",
      "SLIM_BPR_Recommender: Epoch 231 of 795. Elapsed time 3.28 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 1.47E+01. Sample per second: 14177\n",
      "SLIM_BPR_Recommender: Epoch 232 of 795. Elapsed time 3.29 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.46E+01. Sample per second: 7515\n",
      "SLIM_BPR_Recommender: Epoch 233 of 795. Elapsed time 3.31 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.49E+01. Sample per second: 8253\n",
      "SLIM_BPR_Recommender: Epoch 234 of 795. Elapsed time 3.32 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 1.45E+01. Sample per second: 9065\n",
      "SLIM_BPR_Recommender: Epoch 235 of 795. Elapsed time 3.33 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 1.45E+01. Sample per second: 10083\n",
      "SLIM_BPR_Recommender: Epoch 236 of 795. Elapsed time 3.35 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 1.42E+01. Sample per second: 9821\n",
      "SLIM_BPR_Recommender: Epoch 237 of 795. Elapsed time 3.36 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 1.47E+01. Sample per second: 10623\n",
      "SLIM_BPR_Recommender: Epoch 238 of 795. Elapsed time 3.38 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.50E+01. Sample per second: 11539\n",
      "SLIM_BPR_Recommender: Epoch 239 of 795. Elapsed time 3.39 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 1.47E+01. Sample per second: 13382\n",
      "SLIM_BPR_Recommender: Epoch 240 of 795. Elapsed time 3.41 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 1.45E+01. Sample per second: 15924\n",
      "SLIM_BPR_Recommender: Epoch 241 of 795. Elapsed time 3.42 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.47E+01. Sample per second: 7910\n",
      "SLIM_BPR_Recommender: Epoch 242 of 795. Elapsed time 3.44 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.43E+01. Sample per second: 8574\n",
      "SLIM_BPR_Recommender: Epoch 243 of 795. Elapsed time 3.45 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.49E+01. Sample per second: 9496\n",
      "SLIM_BPR_Recommender: Epoch 244 of 795. Elapsed time 3.47 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.52E+01. Sample per second: 10828\n",
      "SLIM_BPR_Recommender: Epoch 245 of 795. Elapsed time 3.48 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 1.50E+01. Sample per second: 12553\n",
      "SLIM_BPR_Recommender: Epoch 246 of 795. Elapsed time 3.49 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.42E+01. Sample per second: 14364\n",
      "SLIM_BPR_Recommender: Epoch 247 of 795. Elapsed time 3.51 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 1.50E+01. Sample per second: 7609\n",
      "SLIM_BPR_Recommender: Epoch 248 of 795. Elapsed time 3.52 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 1.50E+01. Sample per second: 8231\n",
      "SLIM_BPR_Recommender: Epoch 249 of 795. Elapsed time 3.54 min\n",
      "Processed 13650 (100.0%) in 1.55 sec. BPR loss is 1.47E+01. Sample per second: 8826\n",
      "SLIM_BPR_Recommender: Epoch 250 of 795. Elapsed time 3.55 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.49E+01. Sample per second: 9503\n",
      "SLIM_BPR_Recommender: Epoch 251 of 795. Elapsed time 3.57 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 1.49E+01. Sample per second: 10511\n",
      "SLIM_BPR_Recommender: Epoch 252 of 795. Elapsed time 3.58 min\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 1.45E+01. Sample per second: 11733\n",
      "SLIM_BPR_Recommender: Epoch 253 of 795. Elapsed time 3.59 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 1.49E+01. Sample per second: 13323\n",
      "SLIM_BPR_Recommender: Epoch 254 of 795. Elapsed time 3.61 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.52E+01. Sample per second: 15687\n",
      "SLIM_BPR_Recommender: Epoch 255 of 795. Elapsed time 3.62 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.51E+01. Sample per second: 7984\n",
      "SLIM_BPR_Recommender: Epoch 256 of 795. Elapsed time 3.64 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.56E+01. Sample per second: 8696\n",
      "SLIM_BPR_Recommender: Epoch 257 of 795. Elapsed time 3.65 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 1.57E+01. Sample per second: 9844\n",
      "SLIM_BPR_Recommender: Epoch 258 of 795. Elapsed time 3.66 min\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 1.50E+01. Sample per second: 11328\n",
      "SLIM_BPR_Recommender: Epoch 259 of 795. Elapsed time 3.68 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 1.51E+01. Sample per second: 13534\n",
      "SLIM_BPR_Recommender: Epoch 260 of 795. Elapsed time 3.69 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 1.53E+01. Sample per second: 15924\n",
      "SLIM_BPR_Recommender: Epoch 261 of 795. Elapsed time 3.71 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.50E+01. Sample per second: 7882\n",
      "SLIM_BPR_Recommender: Epoch 262 of 795. Elapsed time 3.72 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.47E+01. Sample per second: 8458\n",
      "SLIM_BPR_Recommender: Epoch 263 of 795. Elapsed time 3.74 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.51E+01. Sample per second: 9443\n",
      "SLIM_BPR_Recommender: Epoch 264 of 795. Elapsed time 3.75 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 1.49E+01. Sample per second: 10524\n",
      "SLIM_BPR_Recommender: Epoch 265 of 795. Elapsed time 3.76 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 1.50E+01. Sample per second: 12121\n",
      "SLIM_BPR_Recommender: Epoch 266 of 795. Elapsed time 3.78 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.55E+01. Sample per second: 14353\n",
      "SLIM_BPR_Recommender: Epoch 267 of 795. Elapsed time 3.79 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 1.58E+01. Sample per second: 7678\n",
      "SLIM_BPR_Recommender: Epoch 268 of 795. Elapsed time 3.80 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.53E+01. Sample per second: 8495\n",
      "SLIM_BPR_Recommender: Epoch 269 of 795. Elapsed time 3.82 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.54E+01. Sample per second: 9657\n",
      "SLIM_BPR_Recommender: Epoch 270 of 795. Elapsed time 3.83 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 1.51E+01. Sample per second: 11073\n",
      "SLIM_BPR_Recommender: Epoch 271 of 795. Elapsed time 3.85 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 1.55E+01. Sample per second: 12670\n",
      "SLIM_BPR_Recommender: Epoch 272 of 795. Elapsed time 3.86 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 1.55E+01. Sample per second: 15000\n",
      "SLIM_BPR_Recommender: Epoch 273 of 795. Elapsed time 3.87 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.54E+01. Sample per second: 7895\n",
      "SLIM_BPR_Recommender: Epoch 274 of 795. Elapsed time 3.89 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.56E+01. Sample per second: 8729\n",
      "SLIM_BPR_Recommender: Epoch 275 of 795. Elapsed time 3.90 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 1.56E+01. Sample per second: 9019\n",
      "SLIM_BPR_Recommender: Epoch 276 of 795. Elapsed time 3.92 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 1.60E+01. Sample per second: 10039\n",
      "SLIM_BPR_Recommender: Epoch 277 of 795. Elapsed time 3.93 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.54E+01. Sample per second: 11233\n",
      "SLIM_BPR_Recommender: Epoch 278 of 795. Elapsed time 3.95 min\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 1.59E+01. Sample per second: 12213\n",
      "SLIM_BPR_Recommender: Epoch 279 of 795. Elapsed time 3.96 min\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 1.53E+01. Sample per second: 13725\n",
      "SLIM_BPR_Recommender: Epoch 280 of 795. Elapsed time 3.97 min\n",
      "Processed 13650 (100.0%) in 1.85 sec. BPR loss is 1.62E+01. Sample per second: 7362\n",
      "SLIM_BPR_Recommender: Epoch 281 of 795. Elapsed time 3.99 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.58E+01. Sample per second: 7994\n",
      "SLIM_BPR_Recommender: Epoch 282 of 795. Elapsed time 4.00 min\n",
      "Processed 13650 (100.0%) in 1.55 sec. BPR loss is 1.56E+01. Sample per second: 8797\n",
      "SLIM_BPR_Recommender: Epoch 283 of 795. Elapsed time 4.02 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 1.60E+01. Sample per second: 9794\n",
      "SLIM_BPR_Recommender: Epoch 284 of 795. Elapsed time 4.03 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.55E+01. Sample per second: 10974\n",
      "SLIM_BPR_Recommender: Epoch 285 of 795. Elapsed time 4.05 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.60E+01. Sample per second: 11863\n",
      "SLIM_BPR_Recommender: Epoch 286 of 795. Elapsed time 4.06 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 1.55E+01. Sample per second: 13856\n",
      "SLIM_BPR_Recommender: Epoch 287 of 795. Elapsed time 4.07 min\n",
      "Processed 13650 (100.0%) in 1.84 sec. BPR loss is 1.57E+01. Sample per second: 7412\n",
      "SLIM_BPR_Recommender: Epoch 288 of 795. Elapsed time 4.09 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.57E+01. Sample per second: 7950\n",
      "SLIM_BPR_Recommender: Epoch 289 of 795. Elapsed time 4.10 min\n",
      "Processed 13650 (100.0%) in 1.53 sec. BPR loss is 1.55E+01. Sample per second: 8896\n",
      "SLIM_BPR_Recommender: Epoch 290 of 795. Elapsed time 4.12 min\n",
      "Processed 13650 (100.0%) in 1.37 sec. BPR loss is 1.63E+01. Sample per second: 9973\n",
      "SLIM_BPR_Recommender: Epoch 291 of 795. Elapsed time 4.13 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 1.63E+01. Sample per second: 11451\n",
      "SLIM_BPR_Recommender: Epoch 292 of 795. Elapsed time 4.14 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 1.57E+01. Sample per second: 12935\n",
      "SLIM_BPR_Recommender: Epoch 293 of 795. Elapsed time 4.16 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 1.57E+01. Sample per second: 15054\n",
      "SLIM_BPR_Recommender: Epoch 294 of 795. Elapsed time 4.17 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.62E+01. Sample per second: 7829\n",
      "SLIM_BPR_Recommender: Epoch 295 of 795. Elapsed time 4.19 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.55E+01. Sample per second: 8777\n",
      "SLIM_BPR_Recommender: Epoch 296 of 795. Elapsed time 4.20 min\n",
      "Processed 13650 (100.0%) in 1.37 sec. BPR loss is 1.56E+01. Sample per second: 9992\n",
      "SLIM_BPR_Recommender: Epoch 297 of 795. Elapsed time 4.21 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.63E+01. Sample per second: 11300\n",
      "SLIM_BPR_Recommender: Epoch 298 of 795. Elapsed time 4.23 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.61E+01. Sample per second: 13061\n",
      "SLIM_BPR_Recommender: Epoch 299 of 795. Elapsed time 4.24 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.62E+01. Sample per second: 15554\n",
      "SLIM_BPR_Recommender: Epoch 300 of 795. Elapsed time 4.26 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.60E+01. Sample per second: 7754\n",
      "SLIM_BPR_Recommender: Epoch 301 of 795. Elapsed time 4.27 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.66E+01. Sample per second: 8347\n",
      "SLIM_BPR_Recommender: Epoch 302 of 795. Elapsed time 4.29 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.66E+01. Sample per second: 8725\n",
      "SLIM_BPR_Recommender: Epoch 303 of 795. Elapsed time 4.30 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 1.62E+01. Sample per second: 9566\n",
      "SLIM_BPR_Recommender: Epoch 304 of 795. Elapsed time 4.32 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.59E+01. Sample per second: 10870\n",
      "SLIM_BPR_Recommender: Epoch 305 of 795. Elapsed time 4.33 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 1.67E+01. Sample per second: 12817\n",
      "SLIM_BPR_Recommender: Epoch 306 of 795. Elapsed time 4.34 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.60E+01. Sample per second: 15565\n",
      "SLIM_BPR_Recommender: Epoch 307 of 795. Elapsed time 4.36 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.65E+01. Sample per second: 7898\n",
      "SLIM_BPR_Recommender: Epoch 308 of 795. Elapsed time 4.37 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.63E+01. Sample per second: 8713\n",
      "SLIM_BPR_Recommender: Epoch 309 of 795. Elapsed time 4.38 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 1.61E+01. Sample per second: 9738\n",
      "SLIM_BPR_Recommender: Epoch 310 of 795. Elapsed time 4.40 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.59E+01. Sample per second: 10602\n",
      "SLIM_BPR_Recommender: Epoch 311 of 795. Elapsed time 4.41 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.64E+01. Sample per second: 11941\n",
      "SLIM_BPR_Recommender: Epoch 312 of 795. Elapsed time 4.43 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 1.62E+01. Sample per second: 14076\n",
      "SLIM_BPR_Recommender: Epoch 313 of 795. Elapsed time 4.44 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.61E+01. Sample per second: 7511\n",
      "SLIM_BPR_Recommender: Epoch 314 of 795. Elapsed time 4.46 min\n",
      "Processed 13650 (100.0%) in 1.86 sec. BPR loss is 1.63E+01. Sample per second: 7322\n",
      "SLIM_BPR_Recommender: Epoch 315 of 795. Elapsed time 4.47 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.65E+01. Sample per second: 7766\n",
      "SLIM_BPR_Recommender: Epoch 316 of 795. Elapsed time 4.49 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.63E+01. Sample per second: 8491\n",
      "SLIM_BPR_Recommender: Epoch 317 of 795. Elapsed time 4.50 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.64E+01. Sample per second: 9173\n",
      "SLIM_BPR_Recommender: Epoch 318 of 795. Elapsed time 4.52 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.65E+01. Sample per second: 10373\n",
      "SLIM_BPR_Recommender: Epoch 319 of 795. Elapsed time 4.53 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.63E+01. Sample per second: 11830\n",
      "SLIM_BPR_Recommender: Epoch 320 of 795. Elapsed time 4.54 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.63E+01. Sample per second: 13125\n",
      "SLIM_BPR_Recommender: Epoch 321 of 795. Elapsed time 4.56 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 1.63E+01. Sample per second: 14259\n",
      "SLIM_BPR_Recommender: Epoch 322 of 795. Elapsed time 4.57 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.63E+01. Sample per second: 7585\n",
      "SLIM_BPR_Recommender: Epoch 323 of 795. Elapsed time 4.59 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.60E+01. Sample per second: 8459\n",
      "SLIM_BPR_Recommender: Epoch 324 of 795. Elapsed time 4.60 min\n",
      "Processed 13650 (100.0%) in 1.45 sec. BPR loss is 1.65E+01. Sample per second: 9429\n",
      "SLIM_BPR_Recommender: Epoch 325 of 795. Elapsed time 4.62 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.67E+01. Sample per second: 10561\n",
      "SLIM_BPR_Recommender: Epoch 326 of 795. Elapsed time 4.63 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 1.67E+01. Sample per second: 11688\n",
      "SLIM_BPR_Recommender: Epoch 327 of 795. Elapsed time 4.64 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.65E+01. Sample per second: 13160\n",
      "SLIM_BPR_Recommender: Epoch 328 of 795. Elapsed time 4.66 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 1.64E+01. Sample per second: 14680\n",
      "SLIM_BPR_Recommender: Epoch 329 of 795. Elapsed time 4.67 min\n",
      "Processed 13650 (100.0%) in 1.87 sec. BPR loss is 1.64E+01. Sample per second: 7313\n",
      "SLIM_BPR_Recommender: Epoch 330 of 795. Elapsed time 4.69 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.61E+01. Sample per second: 7581\n",
      "SLIM_BPR_Recommender: Epoch 331 of 795. Elapsed time 4.71 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.66E+01. Sample per second: 7750\n",
      "SLIM_BPR_Recommender: Epoch 332 of 795. Elapsed time 4.72 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 1.63E+01. Sample per second: 8121\n",
      "SLIM_BPR_Recommender: Epoch 333 of 795. Elapsed time 4.74 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.63E+01. Sample per second: 8765\n",
      "SLIM_BPR_Recommender: Epoch 334 of 795. Elapsed time 4.75 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.61E+01. Sample per second: 9593\n",
      "SLIM_BPR_Recommender: Epoch 335 of 795. Elapsed time 4.77 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.66E+01. Sample per second: 10845\n",
      "SLIM_BPR_Recommender: Epoch 336 of 795. Elapsed time 4.78 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 1.69E+01. Sample per second: 12591\n",
      "SLIM_BPR_Recommender: Epoch 337 of 795. Elapsed time 4.79 min\n",
      "Processed 13650 (100.0%) in 0.90 sec. BPR loss is 1.63E+01. Sample per second: 15096\n",
      "SLIM_BPR_Recommender: Epoch 338 of 795. Elapsed time 4.81 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.70E+01. Sample per second: 7816\n",
      "SLIM_BPR_Recommender: Epoch 339 of 795. Elapsed time 4.82 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.72E+01. Sample per second: 8611\n",
      "SLIM_BPR_Recommender: Epoch 340 of 795. Elapsed time 4.83 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.64E+01. Sample per second: 9596\n",
      "SLIM_BPR_Recommender: Epoch 341 of 795. Elapsed time 4.85 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.70E+01. Sample per second: 10857\n",
      "SLIM_BPR_Recommender: Epoch 342 of 795. Elapsed time 4.86 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 1.67E+01. Sample per second: 12678\n",
      "SLIM_BPR_Recommender: Epoch 343 of 795. Elapsed time 4.88 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.63E+01. Sample per second: 15777\n",
      "SLIM_BPR_Recommender: Epoch 344 of 795. Elapsed time 4.89 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.68E+01. Sample per second: 7750\n",
      "SLIM_BPR_Recommender: Epoch 345 of 795. Elapsed time 4.90 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.61E+01. Sample per second: 8567\n",
      "SLIM_BPR_Recommender: Epoch 346 of 795. Elapsed time 4.92 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.65E+01. Sample per second: 9588\n",
      "SLIM_BPR_Recommender: Epoch 347 of 795. Elapsed time 4.93 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.67E+01. Sample per second: 11035\n",
      "SLIM_BPR_Recommender: Epoch 348 of 795. Elapsed time 4.95 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 1.66E+01. Sample per second: 12653\n",
      "SLIM_BPR_Recommender: Epoch 349 of 795. Elapsed time 4.96 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.66E+01. Sample per second: 14780\n",
      "SLIM_BPR_Recommender: Epoch 350 of 795. Elapsed time 4.97 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 1.73E+01. Sample per second: 7728\n",
      "SLIM_BPR_Recommender: Epoch 351 of 795. Elapsed time 4.99 min\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 1.66E+01. Sample per second: 8412\n",
      "SLIM_BPR_Recommender: Epoch 352 of 795. Elapsed time 5.00 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 1.76E+01. Sample per second: 8537\n",
      "SLIM_BPR_Recommender: Epoch 353 of 795. Elapsed time 5.02 min\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 1.63E+01. Sample per second: 9306\n",
      "SLIM_BPR_Recommender: Epoch 354 of 795. Elapsed time 5.03 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 1.77E+01. Sample per second: 10034\n",
      "SLIM_BPR_Recommender: Epoch 355 of 795. Elapsed time 5.05 min\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 1.71E+01. Sample per second: 10897\n",
      "SLIM_BPR_Recommender: Epoch 356 of 795. Elapsed time 5.06 min\n",
      "Processed 13650 (100.0%) in 1.11 sec. BPR loss is 1.68E+01. Sample per second: 12299\n",
      "SLIM_BPR_Recommender: Epoch 357 of 795. Elapsed time 5.08 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.70E+01. Sample per second: 14517\n",
      "SLIM_BPR_Recommender: Epoch 358 of 795. Elapsed time 5.09 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 1.69E+01. Sample per second: 7617\n",
      "SLIM_BPR_Recommender: Epoch 359 of 795. Elapsed time 5.10 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 1.68E+01. Sample per second: 8385\n",
      "SLIM_BPR_Recommender: Epoch 360 of 795. Elapsed time 5.12 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.74E+01. Sample per second: 9447\n",
      "SLIM_BPR_Recommender: Epoch 361 of 795. Elapsed time 5.13 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 1.73E+01. Sample per second: 10777\n",
      "SLIM_BPR_Recommender: Epoch 362 of 795. Elapsed time 5.15 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 1.68E+01. Sample per second: 12567\n",
      "SLIM_BPR_Recommender: Epoch 363 of 795. Elapsed time 5.16 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.67E+01. Sample per second: 14781\n",
      "SLIM_BPR_Recommender: Epoch 364 of 795. Elapsed time 5.17 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.74E+01. Sample per second: 7779\n",
      "SLIM_BPR_Recommender: Epoch 365 of 795. Elapsed time 5.19 min\n",
      "Processed 13650 (100.0%) in 1.58 sec. BPR loss is 1.64E+01. Sample per second: 8648\n",
      "SLIM_BPR_Recommender: Epoch 366 of 795. Elapsed time 5.20 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 1.77E+01. Sample per second: 9560\n",
      "SLIM_BPR_Recommender: Epoch 367 of 795. Elapsed time 5.22 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 1.68E+01. Sample per second: 10715\n",
      "SLIM_BPR_Recommender: Epoch 368 of 795. Elapsed time 5.23 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 1.73E+01. Sample per second: 12076\n",
      "SLIM_BPR_Recommender: Epoch 369 of 795. Elapsed time 5.24 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 1.72E+01. Sample per second: 14055\n",
      "SLIM_BPR_Recommender: Epoch 370 of 795. Elapsed time 5.26 min\n",
      "Processed 13650 (100.0%) in 1.83 sec. BPR loss is 1.70E+01. Sample per second: 7466\n",
      "SLIM_BPR_Recommender: Epoch 371 of 795. Elapsed time 5.27 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 1.72E+01. Sample per second: 8236\n",
      "SLIM_BPR_Recommender: Epoch 372 of 795. Elapsed time 5.29 min\n",
      "Processed 13650 (100.0%) in 1.52 sec. BPR loss is 1.73E+01. Sample per second: 8990\n",
      "SLIM_BPR_Recommender: Epoch 373 of 795. Elapsed time 5.30 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.73E+01. Sample per second: 9897\n",
      "SLIM_BPR_Recommender: Epoch 374 of 795. Elapsed time 5.31 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.74E+01. Sample per second: 11242\n",
      "SLIM_BPR_Recommender: Epoch 375 of 795. Elapsed time 5.33 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 1.72E+01. Sample per second: 12832\n",
      "SLIM_BPR_Recommender: Epoch 376 of 795. Elapsed time 5.34 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.71E+01. Sample per second: 14896\n",
      "SLIM_BPR_Recommender: Epoch 377 of 795. Elapsed time 5.36 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.73E+01. Sample per second: 7583\n",
      "SLIM_BPR_Recommender: Epoch 378 of 795. Elapsed time 5.37 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.74E+01. Sample per second: 7925\n",
      "SLIM_BPR_Recommender: Epoch 379 of 795. Elapsed time 5.39 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.78E+01. Sample per second: 8321\n",
      "SLIM_BPR_Recommender: Epoch 380 of 795. Elapsed time 5.40 min\n",
      "Processed 13650 (100.0%) in 1.58 sec. BPR loss is 1.75E+01. Sample per second: 8627\n",
      "SLIM_BPR_Recommender: Epoch 381 of 795. Elapsed time 5.42 min\n",
      "Processed 13650 (100.0%) in 1.45 sec. BPR loss is 1.77E+01. Sample per second: 9394\n",
      "SLIM_BPR_Recommender: Epoch 382 of 795. Elapsed time 5.43 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 1.76E+01. Sample per second: 10077\n",
      "SLIM_BPR_Recommender: Epoch 383 of 795. Elapsed time 5.45 min\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 1.72E+01. Sample per second: 10929\n",
      "SLIM_BPR_Recommender: Epoch 384 of 795. Elapsed time 5.46 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.73E+01. Sample per second: 11843\n",
      "SLIM_BPR_Recommender: Epoch 385 of 795. Elapsed time 5.48 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 1.74E+01. Sample per second: 13476\n",
      "SLIM_BPR_Recommender: Epoch 386 of 795. Elapsed time 5.49 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.78E+01. Sample per second: 14561\n",
      "SLIM_BPR_Recommender: Epoch 387 of 795. Elapsed time 5.51 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.76E+01. Sample per second: 7516\n",
      "SLIM_BPR_Recommender: Epoch 388 of 795. Elapsed time 5.52 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.78E+01. Sample per second: 7890\n",
      "SLIM_BPR_Recommender: Epoch 389 of 795. Elapsed time 5.54 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 1.76E+01. Sample per second: 8355\n",
      "SLIM_BPR_Recommender: Epoch 390 of 795. Elapsed time 5.55 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.74E+01. Sample per second: 8319\n",
      "SLIM_BPR_Recommender: Epoch 391 of 795. Elapsed time 5.57 min\n",
      "Processed 13650 (100.0%) in 1.52 sec. BPR loss is 1.76E+01. Sample per second: 8964\n",
      "SLIM_BPR_Recommender: Epoch 392 of 795. Elapsed time 5.58 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 1.81E+01. Sample per second: 9849\n",
      "SLIM_BPR_Recommender: Epoch 393 of 795. Elapsed time 5.60 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.72E+01. Sample per second: 10834\n",
      "SLIM_BPR_Recommender: Epoch 394 of 795. Elapsed time 5.61 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.76E+01. Sample per second: 11979\n",
      "SLIM_BPR_Recommender: Epoch 395 of 795. Elapsed time 5.63 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.84E+01. Sample per second: 13014\n",
      "SLIM_BPR_Recommender: Epoch 396 of 795. Elapsed time 5.64 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.75E+01. Sample per second: 15486\n",
      "SLIM_BPR_Recommender: Epoch 397 of 795. Elapsed time 5.66 min\n",
      "Processed 13650 (100.0%) in 1.69 sec. BPR loss is 1.77E+01. Sample per second: 8061\n",
      "SLIM_BPR_Recommender: Epoch 398 of 795. Elapsed time 5.67 min\n",
      "Processed 13650 (100.0%) in 1.52 sec. BPR loss is 1.79E+01. Sample per second: 8978\n",
      "SLIM_BPR_Recommender: Epoch 399 of 795. Elapsed time 5.68 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 1.83E+01. Sample per second: 10075\n",
      "SLIM_BPR_Recommender: Epoch 400 of 795. Elapsed time 5.70 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.78E+01. Sample per second: 11540\n",
      "SLIM_BPR_Recommender: Epoch 401 of 795. Elapsed time 5.71 min\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 1.76E+01. Sample per second: 13783\n",
      "SLIM_BPR_Recommender: Epoch 402 of 795. Elapsed time 5.72 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 1.82E+01. Sample per second: 7517\n",
      "SLIM_BPR_Recommender: Epoch 403 of 795. Elapsed time 5.74 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.75E+01. Sample per second: 7839\n",
      "SLIM_BPR_Recommender: Epoch 404 of 795. Elapsed time 5.75 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.74E+01. Sample per second: 8557\n",
      "SLIM_BPR_Recommender: Epoch 405 of 795. Elapsed time 5.77 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.78E+01. Sample per second: 9618\n",
      "SLIM_BPR_Recommender: Epoch 406 of 795. Elapsed time 5.78 min\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 1.78E+01. Sample per second: 10892\n",
      "SLIM_BPR_Recommender: Epoch 407 of 795. Elapsed time 5.80 min\n",
      "Processed 13650 (100.0%) in 1.11 sec. BPR loss is 1.75E+01. Sample per second: 12348\n",
      "SLIM_BPR_Recommender: Epoch 408 of 795. Elapsed time 5.81 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 1.77E+01. Sample per second: 13907\n",
      "SLIM_BPR_Recommender: Epoch 409 of 795. Elapsed time 5.82 min\n",
      "Processed 13650 (100.0%) in 1.85 sec. BPR loss is 1.81E+01. Sample per second: 7366\n",
      "SLIM_BPR_Recommender: Epoch 410 of 795. Elapsed time 5.84 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 1.78E+01. Sample per second: 8029\n",
      "SLIM_BPR_Recommender: Epoch 411 of 795. Elapsed time 5.85 min\n",
      "Processed 13650 (100.0%) in 1.55 sec. BPR loss is 1.72E+01. Sample per second: 8778\n",
      "SLIM_BPR_Recommender: Epoch 412 of 795. Elapsed time 5.87 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.77E+01. Sample per second: 9703\n",
      "SLIM_BPR_Recommender: Epoch 413 of 795. Elapsed time 5.88 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 1.84E+01. Sample per second: 10502\n",
      "SLIM_BPR_Recommender: Epoch 414 of 795. Elapsed time 5.90 min\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 1.82E+01. Sample per second: 11326\n",
      "SLIM_BPR_Recommender: Epoch 415 of 795. Elapsed time 5.91 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.81E+01. Sample per second: 13184\n",
      "SLIM_BPR_Recommender: Epoch 416 of 795. Elapsed time 5.93 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.81E+01. Sample per second: 15448\n",
      "SLIM_BPR_Recommender: Epoch 417 of 795. Elapsed time 5.94 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.78E+01. Sample per second: 7922\n",
      "SLIM_BPR_Recommender: Epoch 418 of 795. Elapsed time 5.95 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.79E+01. Sample per second: 8685\n",
      "SLIM_BPR_Recommender: Epoch 419 of 795. Elapsed time 5.97 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.75E+01. Sample per second: 9697\n",
      "SLIM_BPR_Recommender: Epoch 420 of 795. Elapsed time 5.98 min\n",
      "Processed 13650 (100.0%) in 1.22 sec. BPR loss is 1.76E+01. Sample per second: 11230\n",
      "SLIM_BPR_Recommender: Epoch 421 of 795. Elapsed time 6.00 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.74E+01. Sample per second: 12986\n",
      "SLIM_BPR_Recommender: Epoch 422 of 795. Elapsed time 6.01 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 1.86E+01. Sample per second: 14696\n",
      "SLIM_BPR_Recommender: Epoch 423 of 795. Elapsed time 6.02 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 1.81E+01. Sample per second: 7709\n",
      "SLIM_BPR_Recommender: Epoch 424 of 795. Elapsed time 6.04 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.78E+01. Sample per second: 8308\n",
      "SLIM_BPR_Recommender: Epoch 425 of 795. Elapsed time 6.05 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.83E+01. Sample per second: 9187\n",
      "SLIM_BPR_Recommender: Epoch 426 of 795. Elapsed time 6.07 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.82E+01. Sample per second: 10618\n",
      "SLIM_BPR_Recommender: Epoch 427 of 795. Elapsed time 6.08 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 1.77E+01. Sample per second: 12543\n",
      "SLIM_BPR_Recommender: Epoch 428 of 795. Elapsed time 6.09 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.82E+01. Sample per second: 14808\n",
      "SLIM_BPR_Recommender: Epoch 429 of 795. Elapsed time 6.11 min\n",
      "Processed 13650 (100.0%) in 1.86 sec. BPR loss is 1.79E+01. Sample per second: 7336\n",
      "SLIM_BPR_Recommender: Epoch 430 of 795. Elapsed time 6.12 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.83E+01. Sample per second: 7854\n",
      "SLIM_BPR_Recommender: Epoch 431 of 795. Elapsed time 6.14 min\n",
      "Processed 13650 (100.0%) in 1.58 sec. BPR loss is 1.78E+01. Sample per second: 8624\n",
      "SLIM_BPR_Recommender: Epoch 432 of 795. Elapsed time 6.15 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 1.79E+01. Sample per second: 9532\n",
      "SLIM_BPR_Recommender: Epoch 433 of 795. Elapsed time 6.17 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.77E+01. Sample per second: 10566\n",
      "SLIM_BPR_Recommender: Epoch 434 of 795. Elapsed time 6.18 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.79E+01. Sample per second: 12010\n",
      "SLIM_BPR_Recommender: Epoch 435 of 795. Elapsed time 6.19 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 1.83E+01. Sample per second: 13888\n",
      "SLIM_BPR_Recommender: Epoch 436 of 795. Elapsed time 6.21 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 1.79E+01. Sample per second: 7658\n",
      "SLIM_BPR_Recommender: Epoch 437 of 795. Elapsed time 6.22 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.82E+01. Sample per second: 8488\n",
      "SLIM_BPR_Recommender: Epoch 438 of 795. Elapsed time 6.24 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.85E+01. Sample per second: 9371\n",
      "SLIM_BPR_Recommender: Epoch 439 of 795. Elapsed time 6.25 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 1.74E+01. Sample per second: 10495\n",
      "SLIM_BPR_Recommender: Epoch 440 of 795. Elapsed time 6.26 min\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 1.85E+01. Sample per second: 11771\n",
      "SLIM_BPR_Recommender: Epoch 441 of 795. Elapsed time 6.28 min\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 1.82E+01. Sample per second: 13608\n",
      "SLIM_BPR_Recommender: Epoch 442 of 795. Elapsed time 6.29 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.79E+01. Sample per second: 14824\n",
      "SLIM_BPR_Recommender: Epoch 443 of 795. Elapsed time 6.31 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 1.83E+01. Sample per second: 7657\n",
      "SLIM_BPR_Recommender: Epoch 444 of 795. Elapsed time 6.32 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.83E+01. Sample per second: 8303\n",
      "SLIM_BPR_Recommender: Epoch 445 of 795. Elapsed time 6.34 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 1.80E+01. Sample per second: 9050\n",
      "SLIM_BPR_Recommender: Epoch 446 of 795. Elapsed time 6.35 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 1.83E+01. Sample per second: 9921\n",
      "SLIM_BPR_Recommender: Epoch 447 of 795. Elapsed time 6.36 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 1.77E+01. Sample per second: 11423\n",
      "SLIM_BPR_Recommender: Epoch 448 of 795. Elapsed time 6.38 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 1.86E+01. Sample per second: 13317\n",
      "SLIM_BPR_Recommender: Epoch 449 of 795. Elapsed time 6.39 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.87E+01. Sample per second: 15470\n",
      "SLIM_BPR_Recommender: Epoch 450 of 795. Elapsed time 6.41 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.80E+01. Sample per second: 8003\n",
      "SLIM_BPR_Recommender: Epoch 451 of 795. Elapsed time 6.42 min\n",
      "Processed 13650 (100.0%) in 1.53 sec. BPR loss is 1.82E+01. Sample per second: 8934\n",
      "SLIM_BPR_Recommender: Epoch 452 of 795. Elapsed time 6.43 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 1.87E+01. Sample per second: 10134\n",
      "SLIM_BPR_Recommender: Epoch 453 of 795. Elapsed time 6.45 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.87E+01. Sample per second: 11855\n",
      "SLIM_BPR_Recommender: Epoch 454 of 795. Elapsed time 6.46 min\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 1.84E+01. Sample per second: 13719\n",
      "SLIM_BPR_Recommender: Epoch 455 of 795. Elapsed time 6.47 min\n",
      "Processed 13650 (100.0%) in 1.87 sec. BPR loss is 1.93E+01. Sample per second: 7282\n",
      "SLIM_BPR_Recommender: Epoch 456 of 795. Elapsed time 6.49 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 1.86E+01. Sample per second: 7868\n",
      "SLIM_BPR_Recommender: Epoch 457 of 795. Elapsed time 6.50 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 1.86E+01. Sample per second: 8529\n",
      "SLIM_BPR_Recommender: Epoch 458 of 795. Elapsed time 6.52 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.81E+01. Sample per second: 9357\n",
      "SLIM_BPR_Recommender: Epoch 459 of 795. Elapsed time 6.53 min\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 1.78E+01. Sample per second: 10882\n",
      "SLIM_BPR_Recommender: Epoch 460 of 795. Elapsed time 6.55 min\n",
      "Processed 13650 (100.0%) in 1.11 sec. BPR loss is 1.80E+01. Sample per second: 12277\n",
      "SLIM_BPR_Recommender: Epoch 461 of 795. Elapsed time 6.56 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.86E+01. Sample per second: 14394\n",
      "SLIM_BPR_Recommender: Epoch 462 of 795. Elapsed time 6.57 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.86E+01. Sample per second: 7812\n",
      "SLIM_BPR_Recommender: Epoch 463 of 795. Elapsed time 6.59 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.84E+01. Sample per second: 8676\n",
      "SLIM_BPR_Recommender: Epoch 464 of 795. Elapsed time 6.60 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 1.85E+01. Sample per second: 9763\n",
      "SLIM_BPR_Recommender: Epoch 465 of 795. Elapsed time 6.62 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 1.86E+01. Sample per second: 11270\n",
      "SLIM_BPR_Recommender: Epoch 466 of 795. Elapsed time 6.63 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.82E+01. Sample per second: 13035\n",
      "SLIM_BPR_Recommender: Epoch 467 of 795. Elapsed time 6.64 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.84E+01. Sample per second: 15447\n",
      "SLIM_BPR_Recommender: Epoch 468 of 795. Elapsed time 6.66 min\n",
      "Processed 13650 (100.0%) in 1.80 sec. BPR loss is 1.87E+01. Sample per second: 7590\n",
      "SLIM_BPR_Recommender: Epoch 469 of 795. Elapsed time 6.67 min\n",
      "Processed 13650 (100.0%) in 1.61 sec. BPR loss is 1.88E+01. Sample per second: 8474\n",
      "SLIM_BPR_Recommender: Epoch 470 of 795. Elapsed time 6.69 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.84E+01. Sample per second: 9699\n",
      "SLIM_BPR_Recommender: Epoch 471 of 795. Elapsed time 6.70 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.87E+01. Sample per second: 10976\n",
      "SLIM_BPR_Recommender: Epoch 472 of 795. Elapsed time 6.71 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 1.87E+01. Sample per second: 12698\n",
      "SLIM_BPR_Recommender: Epoch 473 of 795. Elapsed time 6.73 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.83E+01. Sample per second: 15729\n",
      "SLIM_BPR_Recommender: Epoch 474 of 795. Elapsed time 6.74 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 1.85E+01. Sample per second: 8195\n",
      "SLIM_BPR_Recommender: Epoch 475 of 795. Elapsed time 6.75 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 1.84E+01. Sample per second: 9237\n",
      "SLIM_BPR_Recommender: Epoch 476 of 795. Elapsed time 6.77 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 1.81E+01. Sample per second: 10669\n",
      "SLIM_BPR_Recommender: Epoch 477 of 795. Elapsed time 6.78 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 1.89E+01. Sample per second: 12704\n",
      "SLIM_BPR_Recommender: Epoch 478 of 795. Elapsed time 6.79 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.91E+01. Sample per second: 15639\n",
      "SLIM_BPR_Recommender: Epoch 479 of 795. Elapsed time 6.81 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 1.89E+01. Sample per second: 8190\n",
      "SLIM_BPR_Recommender: Epoch 480 of 795. Elapsed time 6.82 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.85E+01. Sample per second: 9360\n",
      "SLIM_BPR_Recommender: Epoch 481 of 795. Elapsed time 6.83 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.83E+01. Sample per second: 10550\n",
      "SLIM_BPR_Recommender: Epoch 482 of 795. Elapsed time 6.85 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 1.94E+01. Sample per second: 12003\n",
      "SLIM_BPR_Recommender: Epoch 483 of 795. Elapsed time 6.86 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.91E+01. Sample per second: 14487\n",
      "SLIM_BPR_Recommender: Epoch 484 of 795. Elapsed time 6.87 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.87E+01. Sample per second: 7841\n",
      "SLIM_BPR_Recommender: Epoch 485 of 795. Elapsed time 6.89 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.91E+01. Sample per second: 8863\n",
      "SLIM_BPR_Recommender: Epoch 486 of 795. Elapsed time 6.90 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 1.89E+01. Sample per second: 10228\n",
      "SLIM_BPR_Recommender: Epoch 487 of 795. Elapsed time 6.91 min\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 1.88E+01. Sample per second: 11803\n",
      "SLIM_BPR_Recommender: Epoch 488 of 795. Elapsed time 6.93 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.92E+01. Sample per second: 14413\n",
      "SLIM_BPR_Recommender: Epoch 489 of 795. Elapsed time 6.94 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.92E+01. Sample per second: 7827\n",
      "SLIM_BPR_Recommender: Epoch 490 of 795. Elapsed time 6.95 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 1.88E+01. Sample per second: 8688\n",
      "SLIM_BPR_Recommender: Epoch 491 of 795. Elapsed time 6.97 min\n",
      "Processed 13650 (100.0%) in 1.37 sec. BPR loss is 1.93E+01. Sample per second: 9943\n",
      "SLIM_BPR_Recommender: Epoch 492 of 795. Elapsed time 6.98 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.91E+01. Sample per second: 11599\n",
      "SLIM_BPR_Recommender: Epoch 493 of 795. Elapsed time 6.99 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 1.85E+01. Sample per second: 13231\n",
      "SLIM_BPR_Recommender: Epoch 494 of 795. Elapsed time 7.01 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.85E+01. Sample per second: 14559\n",
      "SLIM_BPR_Recommender: Epoch 495 of 795. Elapsed time 7.02 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 1.85E+01. Sample per second: 7645\n",
      "SLIM_BPR_Recommender: Epoch 496 of 795. Elapsed time 7.04 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.92E+01. Sample per second: 8570\n",
      "SLIM_BPR_Recommender: Epoch 497 of 795. Elapsed time 7.05 min\n",
      "Processed 13650 (100.0%) in 1.45 sec. BPR loss is 1.92E+01. Sample per second: 9440\n",
      "SLIM_BPR_Recommender: Epoch 498 of 795. Elapsed time 7.07 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.88E+01. Sample per second: 10849\n",
      "SLIM_BPR_Recommender: Epoch 499 of 795. Elapsed time 7.08 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 1.93E+01. Sample per second: 12492\n",
      "SLIM_BPR_Recommender: Epoch 500 of 795. Elapsed time 7.09 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 1.89E+01. Sample per second: 14747\n",
      "SLIM_BPR_Recommender: Epoch 501 of 795. Elapsed time 7.11 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.91E+01. Sample per second: 7793\n",
      "SLIM_BPR_Recommender: Epoch 502 of 795. Elapsed time 7.12 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.87E+01. Sample per second: 8605\n",
      "SLIM_BPR_Recommender: Epoch 503 of 795. Elapsed time 7.13 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.97E+01. Sample per second: 9645\n",
      "SLIM_BPR_Recommender: Epoch 504 of 795. Elapsed time 7.15 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.94E+01. Sample per second: 10985\n",
      "SLIM_BPR_Recommender: Epoch 505 of 795. Elapsed time 7.16 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 1.88E+01. Sample per second: 12702\n",
      "SLIM_BPR_Recommender: Epoch 506 of 795. Elapsed time 7.18 min\n",
      "Processed 13650 (100.0%) in 0.89 sec. BPR loss is 1.96E+01. Sample per second: 15347\n",
      "SLIM_BPR_Recommender: Epoch 507 of 795. Elapsed time 7.19 min\n",
      "Processed 13650 (100.0%) in 1.69 sec. BPR loss is 1.86E+01. Sample per second: 8068\n",
      "SLIM_BPR_Recommender: Epoch 508 of 795. Elapsed time 7.20 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.89E+01. Sample per second: 8331\n",
      "SLIM_BPR_Recommender: Epoch 509 of 795. Elapsed time 7.22 min\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 1.92E+01. Sample per second: 9297\n",
      "SLIM_BPR_Recommender: Epoch 510 of 795. Elapsed time 7.23 min\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 1.89E+01. Sample per second: 10449\n",
      "SLIM_BPR_Recommender: Epoch 511 of 795. Elapsed time 7.25 min\n",
      "Processed 13650 (100.0%) in 1.12 sec. BPR loss is 1.97E+01. Sample per second: 12155\n",
      "SLIM_BPR_Recommender: Epoch 512 of 795. Elapsed time 7.26 min\n",
      "Processed 13650 (100.0%) in 0.94 sec. BPR loss is 1.95E+01. Sample per second: 14571\n",
      "SLIM_BPR_Recommender: Epoch 513 of 795. Elapsed time 7.27 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.95E+01. Sample per second: 7950\n",
      "SLIM_BPR_Recommender: Epoch 514 of 795. Elapsed time 7.29 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.91E+01. Sample per second: 8879\n",
      "SLIM_BPR_Recommender: Epoch 515 of 795. Elapsed time 7.30 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 1.85E+01. Sample per second: 10018\n",
      "SLIM_BPR_Recommender: Epoch 516 of 795. Elapsed time 7.31 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.91E+01. Sample per second: 11541\n",
      "SLIM_BPR_Recommender: Epoch 517 of 795. Elapsed time 7.33 min\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 1.85E+01. Sample per second: 13709\n",
      "SLIM_BPR_Recommender: Epoch 518 of 795. Elapsed time 7.34 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 1.97E+01. Sample per second: 7611\n",
      "SLIM_BPR_Recommender: Epoch 519 of 795. Elapsed time 7.35 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 1.88E+01. Sample per second: 8539\n",
      "SLIM_BPR_Recommender: Epoch 520 of 795. Elapsed time 7.37 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 1.92E+01. Sample per second: 9745\n",
      "SLIM_BPR_Recommender: Epoch 521 of 795. Elapsed time 7.38 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.96E+01. Sample per second: 11009\n",
      "SLIM_BPR_Recommender: Epoch 522 of 795. Elapsed time 7.40 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 1.94E+01. Sample per second: 12905\n",
      "SLIM_BPR_Recommender: Epoch 523 of 795. Elapsed time 7.41 min\n",
      "Processed 13650 (100.0%) in 0.90 sec. BPR loss is 1.96E+01. Sample per second: 15246\n",
      "SLIM_BPR_Recommender: Epoch 524 of 795. Elapsed time 7.42 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.93E+01. Sample per second: 7952\n",
      "SLIM_BPR_Recommender: Epoch 525 of 795. Elapsed time 7.44 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.93E+01. Sample per second: 8850\n",
      "SLIM_BPR_Recommender: Epoch 526 of 795. Elapsed time 7.45 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 1.97E+01. Sample per second: 9718\n",
      "SLIM_BPR_Recommender: Epoch 527 of 795. Elapsed time 7.47 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.83E+01. Sample per second: 11044\n",
      "SLIM_BPR_Recommender: Epoch 528 of 795. Elapsed time 7.48 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 1.92E+01. Sample per second: 12788\n",
      "SLIM_BPR_Recommender: Epoch 529 of 795. Elapsed time 7.49 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.97E+01. Sample per second: 15435\n",
      "SLIM_BPR_Recommender: Epoch 530 of 795. Elapsed time 7.51 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 1.87E+01. Sample per second: 7929\n",
      "SLIM_BPR_Recommender: Epoch 531 of 795. Elapsed time 7.52 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.93E+01. Sample per second: 8835\n",
      "SLIM_BPR_Recommender: Epoch 532 of 795. Elapsed time 7.53 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 1.96E+01. Sample per second: 10256\n",
      "SLIM_BPR_Recommender: Epoch 533 of 795. Elapsed time 7.55 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.93E+01. Sample per second: 11561\n",
      "SLIM_BPR_Recommender: Epoch 534 of 795. Elapsed time 7.56 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 1.84E+01. Sample per second: 13885\n",
      "SLIM_BPR_Recommender: Epoch 535 of 795. Elapsed time 7.57 min\n",
      "Processed 13650 (100.0%) in 1.84 sec. BPR loss is 1.90E+01. Sample per second: 7431\n",
      "SLIM_BPR_Recommender: Epoch 536 of 795. Elapsed time 7.59 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 1.94E+01. Sample per second: 8108\n",
      "SLIM_BPR_Recommender: Epoch 537 of 795. Elapsed time 7.60 min\n",
      "Processed 13650 (100.0%) in 1.53 sec. BPR loss is 1.93E+01. Sample per second: 8894\n",
      "SLIM_BPR_Recommender: Epoch 538 of 795. Elapsed time 7.62 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 1.96E+01. Sample per second: 10007\n",
      "SLIM_BPR_Recommender: Epoch 539 of 795. Elapsed time 7.63 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 1.95E+01. Sample per second: 11500\n",
      "SLIM_BPR_Recommender: Epoch 540 of 795. Elapsed time 7.64 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 1.90E+01. Sample per second: 13391\n",
      "SLIM_BPR_Recommender: Epoch 541 of 795. Elapsed time 7.66 min\n",
      "Processed 13650 (100.0%) in 0.84 sec. BPR loss is 1.97E+01. Sample per second: 16260\n",
      "SLIM_BPR_Recommender: Epoch 542 of 795. Elapsed time 7.67 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.94E+01. Sample per second: 8276\n",
      "SLIM_BPR_Recommender: Epoch 543 of 795. Elapsed time 7.69 min\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 1.97E+01. Sample per second: 9311\n",
      "SLIM_BPR_Recommender: Epoch 544 of 795. Elapsed time 7.70 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.92E+01. Sample per second: 10362\n",
      "SLIM_BPR_Recommender: Epoch 545 of 795. Elapsed time 7.71 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 1.89E+01. Sample per second: 11898\n",
      "SLIM_BPR_Recommender: Epoch 546 of 795. Elapsed time 7.73 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 1.88E+01. Sample per second: 14053\n",
      "SLIM_BPR_Recommender: Epoch 547 of 795. Elapsed time 7.74 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 1.92E+01. Sample per second: 7669\n",
      "SLIM_BPR_Recommender: Epoch 548 of 795. Elapsed time 7.75 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.93E+01. Sample per second: 7767\n",
      "SLIM_BPR_Recommender: Epoch 549 of 795. Elapsed time 7.77 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 1.95E+01. Sample per second: 8518\n",
      "SLIM_BPR_Recommender: Epoch 550 of 795. Elapsed time 7.79 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 1.91E+01. Sample per second: 9632\n",
      "SLIM_BPR_Recommender: Epoch 551 of 795. Elapsed time 7.80 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 1.89E+01. Sample per second: 11071\n",
      "SLIM_BPR_Recommender: Epoch 552 of 795. Elapsed time 7.81 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.96E+01. Sample per second: 12998\n",
      "SLIM_BPR_Recommender: Epoch 553 of 795. Elapsed time 7.83 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.95E+01. Sample per second: 15622\n",
      "SLIM_BPR_Recommender: Epoch 554 of 795. Elapsed time 7.84 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 1.94E+01. Sample per second: 7959\n",
      "SLIM_BPR_Recommender: Epoch 555 of 795. Elapsed time 7.85 min\n",
      "Processed 13650 (100.0%) in 1.53 sec. BPR loss is 2.05E+01. Sample per second: 8904\n",
      "SLIM_BPR_Recommender: Epoch 556 of 795. Elapsed time 7.87 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 1.94E+01. Sample per second: 10184\n",
      "SLIM_BPR_Recommender: Epoch 557 of 795. Elapsed time 7.88 min\n",
      "Processed 13650 (100.0%) in 1.20 sec. BPR loss is 2.01E+01. Sample per second: 11387\n",
      "SLIM_BPR_Recommender: Epoch 558 of 795. Elapsed time 7.90 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 1.99E+01. Sample per second: 13157\n",
      "SLIM_BPR_Recommender: Epoch 559 of 795. Elapsed time 7.91 min\n",
      "Processed 13650 (100.0%) in 0.83 sec. BPR loss is 1.98E+01. Sample per second: 16367\n",
      "SLIM_BPR_Recommender: Epoch 560 of 795. Elapsed time 7.92 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.93E+01. Sample per second: 8285\n",
      "SLIM_BPR_Recommender: Epoch 561 of 795. Elapsed time 7.94 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 1.98E+01. Sample per second: 9179\n",
      "SLIM_BPR_Recommender: Epoch 562 of 795. Elapsed time 7.95 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.98E+01. Sample per second: 10371\n",
      "SLIM_BPR_Recommender: Epoch 563 of 795. Elapsed time 7.96 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 1.95E+01. Sample per second: 12095\n",
      "SLIM_BPR_Recommender: Epoch 564 of 795. Elapsed time 7.98 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.97E+01. Sample per second: 14377\n",
      "SLIM_BPR_Recommender: Epoch 565 of 795. Elapsed time 7.99 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 1.94E+01. Sample per second: 7743\n",
      "SLIM_BPR_Recommender: Epoch 566 of 795. Elapsed time 8.00 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.98E+01. Sample per second: 8558\n",
      "SLIM_BPR_Recommender: Epoch 567 of 795. Elapsed time 8.02 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 1.93E+01. Sample per second: 9671\n",
      "SLIM_BPR_Recommender: Epoch 568 of 795. Elapsed time 8.03 min\n",
      "Processed 13650 (100.0%) in 1.22 sec. BPR loss is 1.89E+01. Sample per second: 11192\n",
      "SLIM_BPR_Recommender: Epoch 569 of 795. Elapsed time 8.05 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.99E+01. Sample per second: 13038\n",
      "SLIM_BPR_Recommender: Epoch 570 of 795. Elapsed time 8.06 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 1.95E+01. Sample per second: 15508\n",
      "SLIM_BPR_Recommender: Epoch 571 of 795. Elapsed time 8.07 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 2.02E+01. Sample per second: 7837\n",
      "SLIM_BPR_Recommender: Epoch 572 of 795. Elapsed time 8.09 min\n",
      "Processed 13650 (100.0%) in 1.56 sec. BPR loss is 1.99E+01. Sample per second: 8736\n",
      "SLIM_BPR_Recommender: Epoch 573 of 795. Elapsed time 8.10 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 2.04E+01. Sample per second: 9830\n",
      "SLIM_BPR_Recommender: Epoch 574 of 795. Elapsed time 8.11 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 1.97E+01. Sample per second: 10596\n",
      "SLIM_BPR_Recommender: Epoch 575 of 795. Elapsed time 8.13 min\n",
      "Processed 13650 (100.0%) in 1.11 sec. BPR loss is 1.98E+01. Sample per second: 12337\n",
      "SLIM_BPR_Recommender: Epoch 576 of 795. Elapsed time 8.14 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 1.96E+01. Sample per second: 14389\n",
      "SLIM_BPR_Recommender: Epoch 577 of 795. Elapsed time 8.16 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 1.91E+01. Sample per second: 7725\n",
      "SLIM_BPR_Recommender: Epoch 578 of 795. Elapsed time 8.17 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 2.02E+01. Sample per second: 8550\n",
      "SLIM_BPR_Recommender: Epoch 579 of 795. Elapsed time 8.19 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 1.99E+01. Sample per second: 9560\n",
      "SLIM_BPR_Recommender: Epoch 580 of 795. Elapsed time 8.20 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 1.96E+01. Sample per second: 10960\n",
      "SLIM_BPR_Recommender: Epoch 581 of 795. Elapsed time 8.21 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 2.05E+01. Sample per second: 12506\n",
      "SLIM_BPR_Recommender: Epoch 582 of 795. Elapsed time 8.23 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 1.95E+01. Sample per second: 14867\n",
      "SLIM_BPR_Recommender: Epoch 583 of 795. Elapsed time 8.24 min\n",
      "Processed 13650 (100.0%) in 1.75 sec. BPR loss is 1.99E+01. Sample per second: 7815\n",
      "SLIM_BPR_Recommender: Epoch 584 of 795. Elapsed time 8.25 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 1.89E+01. Sample per second: 8603\n",
      "SLIM_BPR_Recommender: Epoch 585 of 795. Elapsed time 8.27 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 1.94E+01. Sample per second: 9480\n",
      "SLIM_BPR_Recommender: Epoch 586 of 795. Elapsed time 8.28 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 2.06E+01. Sample per second: 10573\n",
      "SLIM_BPR_Recommender: Epoch 587 of 795. Elapsed time 8.30 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 2.03E+01. Sample per second: 11674\n",
      "SLIM_BPR_Recommender: Epoch 588 of 795. Elapsed time 8.31 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 1.97E+01. Sample per second: 13025\n",
      "SLIM_BPR_Recommender: Epoch 589 of 795. Elapsed time 8.33 min\n",
      "Processed 13650 (100.0%) in 0.85 sec. BPR loss is 1.96E+01. Sample per second: 16072\n",
      "SLIM_BPR_Recommender: Epoch 590 of 795. Elapsed time 8.34 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 1.97E+01. Sample per second: 8254\n",
      "SLIM_BPR_Recommender: Epoch 591 of 795. Elapsed time 8.35 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 2.02E+01. Sample per second: 9353\n",
      "SLIM_BPR_Recommender: Epoch 592 of 795. Elapsed time 8.37 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 2.02E+01. Sample per second: 10624\n",
      "SLIM_BPR_Recommender: Epoch 593 of 795. Elapsed time 8.38 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 2.00E+01. Sample per second: 12496\n",
      "SLIM_BPR_Recommender: Epoch 594 of 795. Elapsed time 8.39 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 1.98E+01. Sample per second: 15063\n",
      "SLIM_BPR_Recommender: Epoch 595 of 795. Elapsed time 8.41 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 1.99E+01. Sample per second: 7829\n",
      "SLIM_BPR_Recommender: Epoch 596 of 795. Elapsed time 8.42 min\n",
      "Processed 13650 (100.0%) in 1.58 sec. BPR loss is 2.07E+01. Sample per second: 8657\n",
      "SLIM_BPR_Recommender: Epoch 597 of 795. Elapsed time 8.43 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 1.96E+01. Sample per second: 9802\n",
      "SLIM_BPR_Recommender: Epoch 598 of 795. Elapsed time 8.45 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 2.02E+01. Sample per second: 11083\n",
      "SLIM_BPR_Recommender: Epoch 599 of 795. Elapsed time 8.46 min\n",
      "Processed 13650 (100.0%) in 1.07 sec. BPR loss is 2.02E+01. Sample per second: 12756\n",
      "SLIM_BPR_Recommender: Epoch 600 of 795. Elapsed time 8.48 min\n",
      "Processed 13650 (100.0%) in 0.90 sec. BPR loss is 2.09E+01. Sample per second: 15204\n",
      "SLIM_BPR_Recommender: Epoch 601 of 795. Elapsed time 8.49 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 2.00E+01. Sample per second: 7760\n",
      "SLIM_BPR_Recommender: Epoch 602 of 795. Elapsed time 8.50 min\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 1.99E+01. Sample per second: 8449\n",
      "SLIM_BPR_Recommender: Epoch 603 of 795. Elapsed time 8.52 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.01E+01. Sample per second: 9067\n",
      "SLIM_BPR_Recommender: Epoch 604 of 795. Elapsed time 8.53 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 1.98E+01. Sample per second: 10149\n",
      "SLIM_BPR_Recommender: Epoch 605 of 795. Elapsed time 8.55 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 1.99E+01. Sample per second: 11549\n",
      "SLIM_BPR_Recommender: Epoch 606 of 795. Elapsed time 8.56 min\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 1.99E+01. Sample per second: 13658\n",
      "SLIM_BPR_Recommender: Epoch 607 of 795. Elapsed time 8.58 min\n",
      "Processed 13650 (100.0%) in 0.82 sec. BPR loss is 1.93E+01. Sample per second: 16649\n",
      "SLIM_BPR_Recommender: Epoch 608 of 795. Elapsed time 8.59 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 2.00E+01. Sample per second: 8179\n",
      "SLIM_BPR_Recommender: Epoch 609 of 795. Elapsed time 8.60 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.05E+01. Sample per second: 9062\n",
      "SLIM_BPR_Recommender: Epoch 610 of 795. Elapsed time 8.62 min\n",
      "Processed 13650 (100.0%) in 1.32 sec. BPR loss is 1.99E+01. Sample per second: 10324\n",
      "SLIM_BPR_Recommender: Epoch 611 of 795. Elapsed time 8.63 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 2.02E+01. Sample per second: 11911\n",
      "SLIM_BPR_Recommender: Epoch 612 of 795. Elapsed time 8.64 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 2.04E+01. Sample per second: 13884\n",
      "SLIM_BPR_Recommender: Epoch 613 of 795. Elapsed time 8.66 min\n",
      "Processed 13650 (100.0%) in 1.82 sec. BPR loss is 2.09E+01. Sample per second: 7509\n",
      "SLIM_BPR_Recommender: Epoch 614 of 795. Elapsed time 8.67 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 1.99E+01. Sample per second: 8135\n",
      "SLIM_BPR_Recommender: Epoch 615 of 795. Elapsed time 8.69 min\n",
      "Processed 13650 (100.0%) in 1.54 sec. BPR loss is 1.98E+01. Sample per second: 8864\n",
      "SLIM_BPR_Recommender: Epoch 616 of 795. Elapsed time 8.70 min\n",
      "Processed 13650 (100.0%) in 1.42 sec. BPR loss is 2.02E+01. Sample per second: 9622\n",
      "SLIM_BPR_Recommender: Epoch 617 of 795. Elapsed time 8.72 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 1.99E+01. Sample per second: 10819\n",
      "SLIM_BPR_Recommender: Epoch 618 of 795. Elapsed time 8.73 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 2.01E+01. Sample per second: 12427\n",
      "SLIM_BPR_Recommender: Epoch 619 of 795. Elapsed time 8.74 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 2.01E+01. Sample per second: 15524\n",
      "SLIM_BPR_Recommender: Epoch 620 of 795. Elapsed time 8.76 min\n",
      "Processed 13650 (100.0%) in 1.69 sec. BPR loss is 1.96E+01. Sample per second: 8093\n",
      "SLIM_BPR_Recommender: Epoch 621 of 795. Elapsed time 8.77 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.05E+01. Sample per second: 9176\n",
      "SLIM_BPR_Recommender: Epoch 622 of 795. Elapsed time 8.78 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 2.07E+01. Sample per second: 10624\n",
      "SLIM_BPR_Recommender: Epoch 623 of 795. Elapsed time 8.80 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 2.02E+01. Sample per second: 12635\n",
      "SLIM_BPR_Recommender: Epoch 624 of 795. Elapsed time 8.81 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 2.01E+01. Sample per second: 15892\n",
      "SLIM_BPR_Recommender: Epoch 625 of 795. Elapsed time 8.82 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 2.10E+01. Sample per second: 8253\n",
      "SLIM_BPR_Recommender: Epoch 626 of 795. Elapsed time 8.84 min\n",
      "Processed 13650 (100.0%) in 1.45 sec. BPR loss is 2.02E+01. Sample per second: 9400\n",
      "SLIM_BPR_Recommender: Epoch 627 of 795. Elapsed time 8.85 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 2.00E+01. Sample per second: 10149\n",
      "SLIM_BPR_Recommender: Epoch 628 of 795. Elapsed time 8.86 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 1.96E+01. Sample per second: 10722\n",
      "SLIM_BPR_Recommender: Epoch 629 of 795. Elapsed time 8.88 min\n",
      "Processed 13650 (100.0%) in 1.15 sec. BPR loss is 2.02E+01. Sample per second: 11848\n",
      "SLIM_BPR_Recommender: Epoch 630 of 795. Elapsed time 8.89 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 2.02E+01. Sample per second: 13216\n",
      "SLIM_BPR_Recommender: Epoch 631 of 795. Elapsed time 8.91 min\n",
      "Processed 13650 (100.0%) in 0.86 sec. BPR loss is 1.99E+01. Sample per second: 15916\n",
      "SLIM_BPR_Recommender: Epoch 632 of 795. Elapsed time 8.92 min\n",
      "Processed 13650 (100.0%) in 1.71 sec. BPR loss is 2.05E+01. Sample per second: 7962\n",
      "SLIM_BPR_Recommender: Epoch 633 of 795. Elapsed time 8.94 min\n",
      "Processed 13650 (100.0%) in 1.55 sec. BPR loss is 2.02E+01. Sample per second: 8804\n",
      "SLIM_BPR_Recommender: Epoch 634 of 795. Elapsed time 8.95 min\n",
      "Processed 13650 (100.0%) in 1.39 sec. BPR loss is 2.03E+01. Sample per second: 9800\n",
      "SLIM_BPR_Recommender: Epoch 635 of 795. Elapsed time 8.96 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 2.00E+01. Sample per second: 11047\n",
      "SLIM_BPR_Recommender: Epoch 636 of 795. Elapsed time 8.98 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 2.04E+01. Sample per second: 12371\n",
      "SLIM_BPR_Recommender: Epoch 637 of 795. Elapsed time 8.99 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 2.09E+01. Sample per second: 14275\n",
      "SLIM_BPR_Recommender: Epoch 638 of 795. Elapsed time 9.01 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 2.00E+01. Sample per second: 7646\n",
      "SLIM_BPR_Recommender: Epoch 639 of 795. Elapsed time 9.02 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 1.99E+01. Sample per second: 8318\n",
      "SLIM_BPR_Recommender: Epoch 640 of 795. Elapsed time 9.04 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 2.06E+01. Sample per second: 8391\n",
      "SLIM_BPR_Recommender: Epoch 641 of 795. Elapsed time 9.05 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 2.02E+01. Sample per second: 8667\n",
      "SLIM_BPR_Recommender: Epoch 642 of 795. Elapsed time 9.07 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 1.99E+01. Sample per second: 9333\n",
      "SLIM_BPR_Recommender: Epoch 643 of 795. Elapsed time 9.08 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 2.02E+01. Sample per second: 10085\n",
      "SLIM_BPR_Recommender: Epoch 644 of 795. Elapsed time 9.10 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 2.08E+01. Sample per second: 11052\n",
      "SLIM_BPR_Recommender: Epoch 645 of 795. Elapsed time 9.11 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 2.09E+01. Sample per second: 11282\n",
      "SLIM_BPR_Recommender: Epoch 646 of 795. Elapsed time 9.13 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.09E+01. Sample per second: 9145\n",
      "SLIM_BPR_Recommender: Epoch 647 of 795. Elapsed time 9.15 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 2.10E+01. Sample per second: 10164\n",
      "SLIM_BPR_Recommender: Epoch 648 of 795. Elapsed time 9.16 min\n",
      "Processed 13650 (100.0%) in 1.25 sec. BPR loss is 2.10E+01. Sample per second: 10919\n",
      "SLIM_BPR_Recommender: Epoch 649 of 795. Elapsed time 9.18 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 2.05E+01. Sample per second: 12605\n",
      "SLIM_BPR_Recommender: Epoch 650 of 795. Elapsed time 9.19 min\n",
      "Processed 13650 (100.0%) in 0.88 sec. BPR loss is 2.12E+01. Sample per second: 15539\n",
      "SLIM_BPR_Recommender: Epoch 651 of 795. Elapsed time 9.21 min\n",
      "Processed 13650 (100.0%) in 1.70 sec. BPR loss is 2.10E+01. Sample per second: 8009\n",
      "SLIM_BPR_Recommender: Epoch 652 of 795. Elapsed time 9.22 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 2.05E+01. Sample per second: 8572\n",
      "SLIM_BPR_Recommender: Epoch 653 of 795. Elapsed time 9.23 min\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 2.04E+01. Sample per second: 9123\n",
      "SLIM_BPR_Recommender: Epoch 654 of 795. Elapsed time 9.25 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 2.06E+01. Sample per second: 9752\n",
      "SLIM_BPR_Recommender: Epoch 655 of 795. Elapsed time 9.27 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 2.05E+01. Sample per second: 10816\n",
      "SLIM_BPR_Recommender: Epoch 656 of 795. Elapsed time 9.28 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 2.08E+01. Sample per second: 12073\n",
      "SLIM_BPR_Recommender: Epoch 657 of 795. Elapsed time 9.29 min\n",
      "Processed 13650 (100.0%) in 0.99 sec. BPR loss is 2.08E+01. Sample per second: 13791\n",
      "SLIM_BPR_Recommender: Epoch 658 of 795. Elapsed time 9.31 min\n",
      "Processed 13650 (100.0%) in 1.84 sec. BPR loss is 2.07E+01. Sample per second: 7411\n",
      "SLIM_BPR_Recommender: Epoch 659 of 795. Elapsed time 9.32 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 2.08E+01. Sample per second: 8150\n",
      "SLIM_BPR_Recommender: Epoch 660 of 795. Elapsed time 9.34 min\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 2.06E+01. Sample per second: 9093\n",
      "SLIM_BPR_Recommender: Epoch 661 of 795. Elapsed time 9.35 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 2.09E+01. Sample per second: 9916\n",
      "SLIM_BPR_Recommender: Epoch 662 of 795. Elapsed time 9.36 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 2.04E+01. Sample per second: 10775\n",
      "SLIM_BPR_Recommender: Epoch 663 of 795. Elapsed time 9.38 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 2.06E+01. Sample per second: 12061\n",
      "SLIM_BPR_Recommender: Epoch 664 of 795. Elapsed time 9.39 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 2.02E+01. Sample per second: 13922\n",
      "SLIM_BPR_Recommender: Epoch 665 of 795. Elapsed time 9.41 min\n",
      "Processed 13650 (100.0%) in 1.96 sec. BPR loss is 2.04E+01. Sample per second: 6981\n",
      "SLIM_BPR_Recommender: Epoch 666 of 795. Elapsed time 9.42 min\n",
      "Processed 13650 (100.0%) in 1.81 sec. BPR loss is 2.08E+01. Sample per second: 7522\n",
      "SLIM_BPR_Recommender: Epoch 667 of 795. Elapsed time 9.44 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 2.06E+01. Sample per second: 8261\n",
      "SLIM_BPR_Recommender: Epoch 668 of 795. Elapsed time 9.45 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 2.08E+01. Sample per second: 8510\n",
      "SLIM_BPR_Recommender: Epoch 669 of 795. Elapsed time 9.47 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 2.01E+01. Sample per second: 9237\n",
      "SLIM_BPR_Recommender: Epoch 670 of 795. Elapsed time 9.48 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 2.10E+01. Sample per second: 10565\n",
      "SLIM_BPR_Recommender: Epoch 671 of 795. Elapsed time 9.50 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 2.05E+01. Sample per second: 12499\n",
      "SLIM_BPR_Recommender: Epoch 672 of 795. Elapsed time 9.51 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 2.09E+01. Sample per second: 14746\n",
      "SLIM_BPR_Recommender: Epoch 673 of 795. Elapsed time 9.52 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 2.11E+01. Sample per second: 7749\n",
      "SLIM_BPR_Recommender: Epoch 674 of 795. Elapsed time 9.54 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 2.09E+01. Sample per second: 8561\n",
      "SLIM_BPR_Recommender: Epoch 675 of 795. Elapsed time 9.55 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 2.12E+01. Sample per second: 9646\n",
      "SLIM_BPR_Recommender: Epoch 676 of 795. Elapsed time 9.57 min\n",
      "Processed 13650 (100.0%) in 1.23 sec. BPR loss is 2.08E+01. Sample per second: 11138\n",
      "SLIM_BPR_Recommender: Epoch 677 of 795. Elapsed time 9.58 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 2.03E+01. Sample per second: 13299\n",
      "SLIM_BPR_Recommender: Epoch 678 of 795. Elapsed time 9.59 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 1.98E+01. Sample per second: 15696\n",
      "SLIM_BPR_Recommender: Epoch 679 of 795. Elapsed time 9.61 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 2.01E+01. Sample per second: 8130\n",
      "SLIM_BPR_Recommender: Epoch 680 of 795. Elapsed time 9.62 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.06E+01. Sample per second: 9033\n",
      "SLIM_BPR_Recommender: Epoch 681 of 795. Elapsed time 9.63 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 2.08E+01. Sample per second: 10224\n",
      "SLIM_BPR_Recommender: Epoch 682 of 795. Elapsed time 9.65 min\n",
      "Processed 13650 (100.0%) in 1.18 sec. BPR loss is 2.08E+01. Sample per second: 11571\n",
      "SLIM_BPR_Recommender: Epoch 683 of 795. Elapsed time 9.66 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 2.02E+01. Sample per second: 13515\n",
      "SLIM_BPR_Recommender: Epoch 684 of 795. Elapsed time 9.68 min\n",
      "Processed 13650 (100.0%) in 0.82 sec. BPR loss is 2.00E+01. Sample per second: 16651\n",
      "SLIM_BPR_Recommender: Epoch 685 of 795. Elapsed time 9.69 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 2.15E+01. Sample per second: 8259\n",
      "SLIM_BPR_Recommender: Epoch 686 of 795. Elapsed time 9.70 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.02E+01. Sample per second: 9166\n",
      "SLIM_BPR_Recommender: Epoch 687 of 795. Elapsed time 9.72 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 2.13E+01. Sample per second: 10234\n",
      "SLIM_BPR_Recommender: Epoch 688 of 795. Elapsed time 9.73 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 1.98E+01. Sample per second: 11492\n",
      "SLIM_BPR_Recommender: Epoch 689 of 795. Elapsed time 9.74 min\n",
      "Processed 13650 (100.0%) in 1.05 sec. BPR loss is 2.07E+01. Sample per second: 12963\n",
      "SLIM_BPR_Recommender: Epoch 690 of 795. Elapsed time 9.76 min\n",
      "Processed 13650 (100.0%) in 0.89 sec. BPR loss is 2.11E+01. Sample per second: 15344\n",
      "SLIM_BPR_Recommender: Epoch 691 of 795. Elapsed time 9.77 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 2.06E+01. Sample per second: 7719\n",
      "SLIM_BPR_Recommender: Epoch 692 of 795. Elapsed time 9.79 min\n",
      "Processed 13650 (100.0%) in 1.64 sec. BPR loss is 2.06E+01. Sample per second: 8299\n",
      "SLIM_BPR_Recommender: Epoch 693 of 795. Elapsed time 9.80 min\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 2.02E+01. Sample per second: 9094\n",
      "SLIM_BPR_Recommender: Epoch 694 of 795. Elapsed time 9.82 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 2.11E+01. Sample per second: 9874\n",
      "SLIM_BPR_Recommender: Epoch 695 of 795. Elapsed time 9.83 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 2.12E+01. Sample per second: 10722\n",
      "SLIM_BPR_Recommender: Epoch 696 of 795. Elapsed time 9.85 min\n",
      "Processed 13650 (100.0%) in 1.13 sec. BPR loss is 2.09E+01. Sample per second: 12088\n",
      "SLIM_BPR_Recommender: Epoch 697 of 795. Elapsed time 9.86 min\n",
      "Processed 13650 (100.0%) in 1.00 sec. BPR loss is 2.08E+01. Sample per second: 13696\n",
      "SLIM_BPR_Recommender: Epoch 698 of 795. Elapsed time 9.88 min\n",
      "Processed 13650 (100.0%) in 1.86 sec. BPR loss is 2.09E+01. Sample per second: 7332\n",
      "SLIM_BPR_Recommender: Epoch 699 of 795. Elapsed time 9.89 min\n",
      "Processed 13650 (100.0%) in 1.72 sec. BPR loss is 2.07E+01. Sample per second: 7927\n",
      "SLIM_BPR_Recommender: Epoch 700 of 795. Elapsed time 9.90 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 2.06E+01. Sample per second: 8698\n",
      "SLIM_BPR_Recommender: Epoch 701 of 795. Elapsed time 9.92 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 2.15E+01. Sample per second: 9766\n",
      "SLIM_BPR_Recommender: Epoch 702 of 795. Elapsed time 9.93 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 2.08E+01. Sample per second: 11281\n",
      "SLIM_BPR_Recommender: Epoch 703 of 795. Elapsed time 9.95 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 2.13E+01. Sample per second: 13368\n",
      "SLIM_BPR_Recommender: Epoch 704 of 795. Elapsed time 9.96 min\n",
      "Processed 13650 (100.0%) in 1.02 sec. BPR loss is 2.05E+01. Sample per second: 13365\n",
      "SLIM_BPR_Recommender: Epoch 705 of 795. Elapsed time 9.98 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 2.07E+01. Sample per second: 15612\n",
      "SLIM_BPR_Recommender: Epoch 706 of 795. Elapsed time 9.99 min\n",
      "Processed 13650 (100.0%) in 1.74 sec. BPR loss is 2.07E+01. Sample per second: 7849\n",
      "SLIM_BPR_Recommender: Epoch 707 of 795. Elapsed time 10.00 min\n",
      "Processed 13650 (100.0%) in 1.67 sec. BPR loss is 2.04E+01. Sample per second: 8174\n",
      "SLIM_BPR_Recommender: Epoch 708 of 795. Elapsed time 10.02 min\n",
      "Processed 13650 (100.0%) in 1.59 sec. BPR loss is 2.10E+01. Sample per second: 8588\n",
      "SLIM_BPR_Recommender: Epoch 709 of 795. Elapsed time 10.03 min\n",
      "Processed 13650 (100.0%) in 1.46 sec. BPR loss is 2.08E+01. Sample per second: 9371\n",
      "SLIM_BPR_Recommender: Epoch 710 of 795. Elapsed time 10.05 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 2.09E+01. Sample per second: 10082\n",
      "SLIM_BPR_Recommender: Epoch 711 of 795. Elapsed time 10.06 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 2.12E+01. Sample per second: 11640\n",
      "SLIM_BPR_Recommender: Epoch 712 of 795. Elapsed time 10.08 min\n",
      "Processed 13650 (100.0%) in 0.98 sec. BPR loss is 2.10E+01. Sample per second: 13940\n",
      "SLIM_BPR_Recommender: Epoch 713 of 795. Elapsed time 10.09 min\n",
      "Processed 13650 (100.0%) in 1.81 sec. BPR loss is 2.10E+01. Sample per second: 7550\n",
      "SLIM_BPR_Recommender: Epoch 714 of 795. Elapsed time 10.11 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 2.12E+01. Sample per second: 8376\n",
      "SLIM_BPR_Recommender: Epoch 715 of 795. Elapsed time 10.12 min\n",
      "Processed 13650 (100.0%) in 1.50 sec. BPR loss is 2.12E+01. Sample per second: 9092\n",
      "SLIM_BPR_Recommender: Epoch 716 of 795. Elapsed time 10.13 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 2.11E+01. Sample per second: 9671\n",
      "SLIM_BPR_Recommender: Epoch 717 of 795. Elapsed time 10.15 min\n",
      "Processed 13650 (100.0%) in 1.29 sec. BPR loss is 2.09E+01. Sample per second: 10608\n",
      "SLIM_BPR_Recommender: Epoch 718 of 795. Elapsed time 10.16 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 2.09E+01. Sample per second: 11615\n",
      "SLIM_BPR_Recommender: Epoch 719 of 795. Elapsed time 10.18 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 2.15E+01. Sample per second: 12928\n",
      "SLIM_BPR_Recommender: Epoch 720 of 795. Elapsed time 10.19 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 2.12E+01. Sample per second: 14680\n",
      "SLIM_BPR_Recommender: Epoch 721 of 795. Elapsed time 10.21 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 2.15E+01. Sample per second: 7607\n",
      "SLIM_BPR_Recommender: Epoch 722 of 795. Elapsed time 10.22 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 2.05E+01. Sample per second: 8519\n",
      "SLIM_BPR_Recommender: Epoch 723 of 795. Elapsed time 10.24 min\n",
      "Processed 13650 (100.0%) in 1.44 sec. BPR loss is 2.15E+01. Sample per second: 9474\n",
      "SLIM_BPR_Recommender: Epoch 724 of 795. Elapsed time 10.25 min\n",
      "Processed 13650 (100.0%) in 1.28 sec. BPR loss is 2.06E+01. Sample per second: 10656\n",
      "SLIM_BPR_Recommender: Epoch 725 of 795. Elapsed time 10.26 min\n",
      "Processed 13650 (100.0%) in 1.11 sec. BPR loss is 2.03E+01. Sample per second: 12296\n",
      "SLIM_BPR_Recommender: Epoch 726 of 795. Elapsed time 10.28 min\n",
      "Processed 13650 (100.0%) in 0.93 sec. BPR loss is 2.06E+01. Sample per second: 14626\n",
      "SLIM_BPR_Recommender: Epoch 727 of 795. Elapsed time 10.29 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 2.09E+01. Sample per second: 7776\n",
      "SLIM_BPR_Recommender: Epoch 728 of 795. Elapsed time 10.30 min\n",
      "Processed 13650 (100.0%) in 1.58 sec. BPR loss is 2.16E+01. Sample per second: 8620\n",
      "SLIM_BPR_Recommender: Epoch 729 of 795. Elapsed time 10.32 min\n",
      "Processed 13650 (100.0%) in 1.47 sec. BPR loss is 2.19E+01. Sample per second: 9271\n",
      "SLIM_BPR_Recommender: Epoch 730 of 795. Elapsed time 10.33 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 2.06E+01. Sample per second: 10258\n",
      "SLIM_BPR_Recommender: Epoch 731 of 795. Elapsed time 10.35 min\n",
      "Processed 13650 (100.0%) in 1.14 sec. BPR loss is 2.12E+01. Sample per second: 11954\n",
      "SLIM_BPR_Recommender: Epoch 732 of 795. Elapsed time 10.36 min\n",
      "Processed 13650 (100.0%) in 0.96 sec. BPR loss is 2.08E+01. Sample per second: 14243\n",
      "SLIM_BPR_Recommender: Epoch 733 of 795. Elapsed time 10.37 min\n",
      "Processed 13650 (100.0%) in 1.78 sec. BPR loss is 2.07E+01. Sample per second: 7686\n",
      "SLIM_BPR_Recommender: Epoch 734 of 795. Elapsed time 10.39 min\n",
      "Processed 13650 (100.0%) in 1.60 sec. BPR loss is 2.08E+01. Sample per second: 8536\n",
      "SLIM_BPR_Recommender: Epoch 735 of 795. Elapsed time 10.40 min\n",
      "Processed 13650 (100.0%) in 1.43 sec. BPR loss is 2.10E+01. Sample per second: 9558\n",
      "SLIM_BPR_Recommender: Epoch 736 of 795. Elapsed time 10.42 min\n",
      "Processed 13650 (100.0%) in 1.26 sec. BPR loss is 2.12E+01. Sample per second: 10860\n",
      "SLIM_BPR_Recommender: Epoch 737 of 795. Elapsed time 10.43 min\n",
      "Processed 13650 (100.0%) in 1.08 sec. BPR loss is 2.10E+01. Sample per second: 12679\n",
      "SLIM_BPR_Recommender: Epoch 738 of 795. Elapsed time 10.44 min\n",
      "Processed 13650 (100.0%) in 0.91 sec. BPR loss is 2.04E+01. Sample per second: 15068\n",
      "SLIM_BPR_Recommender: Epoch 739 of 795. Elapsed time 10.46 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 2.13E+01. Sample per second: 7737\n",
      "SLIM_BPR_Recommender: Epoch 740 of 795. Elapsed time 10.47 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 2.11E+01. Sample per second: 8292\n",
      "SLIM_BPR_Recommender: Epoch 741 of 795. Elapsed time 10.49 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 2.07E+01. Sample per second: 9232\n",
      "SLIM_BPR_Recommender: Epoch 742 of 795. Elapsed time 10.50 min\n",
      "Processed 13650 (100.0%) in 1.41 sec. BPR loss is 2.15E+01. Sample per second: 9689\n",
      "SLIM_BPR_Recommender: Epoch 743 of 795. Elapsed time 10.52 min\n",
      "Processed 13650 (100.0%) in 1.33 sec. BPR loss is 2.13E+01. Sample per second: 10230\n",
      "SLIM_BPR_Recommender: Epoch 744 of 795. Elapsed time 10.53 min\n",
      "Processed 13650 (100.0%) in 1.24 sec. BPR loss is 2.10E+01. Sample per second: 11017\n",
      "SLIM_BPR_Recommender: Epoch 745 of 795. Elapsed time 10.55 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 2.18E+01. Sample per second: 12401\n",
      "SLIM_BPR_Recommender: Epoch 746 of 795. Elapsed time 10.56 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 2.13E+01. Sample per second: 14863\n",
      "SLIM_BPR_Recommender: Epoch 747 of 795. Elapsed time 10.57 min\n",
      "Processed 13650 (100.0%) in 1.76 sec. BPR loss is 2.09E+01. Sample per second: 7733\n",
      "SLIM_BPR_Recommender: Epoch 748 of 795. Elapsed time 10.59 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 2.15E+01. Sample per second: 8393\n",
      "SLIM_BPR_Recommender: Epoch 749 of 795. Elapsed time 10.60 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.20E+01. Sample per second: 9164\n",
      "SLIM_BPR_Recommender: Epoch 750 of 795. Elapsed time 10.62 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 2.08E+01. Sample per second: 10207\n",
      "SLIM_BPR_Recommender: Epoch 751 of 795. Elapsed time 10.63 min\n",
      "Processed 13650 (100.0%) in 1.21 sec. BPR loss is 2.13E+01. Sample per second: 11320\n",
      "SLIM_BPR_Recommender: Epoch 752 of 795. Elapsed time 10.65 min\n",
      "Processed 13650 (100.0%) in 1.06 sec. BPR loss is 2.18E+01. Sample per second: 12814\n",
      "SLIM_BPR_Recommender: Epoch 753 of 795. Elapsed time 10.66 min\n",
      "Processed 13650 (100.0%) in 0.95 sec. BPR loss is 2.13E+01. Sample per second: 14318\n",
      "SLIM_BPR_Recommender: Epoch 754 of 795. Elapsed time 10.67 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 2.10E+01. Sample per second: 7693\n",
      "SLIM_BPR_Recommender: Epoch 755 of 795. Elapsed time 10.69 min\n",
      "Processed 13650 (100.0%) in 1.65 sec. BPR loss is 2.08E+01. Sample per second: 8275\n",
      "SLIM_BPR_Recommender: Epoch 756 of 795. Elapsed time 10.70 min\n",
      "Processed 13650 (100.0%) in 1.55 sec. BPR loss is 2.10E+01. Sample per second: 8813\n",
      "SLIM_BPR_Recommender: Epoch 757 of 795. Elapsed time 10.72 min\n",
      "Processed 13650 (100.0%) in 1.38 sec. BPR loss is 2.11E+01. Sample per second: 9901\n",
      "SLIM_BPR_Recommender: Epoch 758 of 795. Elapsed time 10.73 min\n",
      "Processed 13650 (100.0%) in 1.22 sec. BPR loss is 2.16E+01. Sample per second: 11214\n",
      "SLIM_BPR_Recommender: Epoch 759 of 795. Elapsed time 10.75 min\n",
      "Processed 13650 (100.0%) in 1.03 sec. BPR loss is 2.11E+01. Sample per second: 13245\n",
      "SLIM_BPR_Recommender: Epoch 760 of 795. Elapsed time 10.76 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 2.19E+01. Sample per second: 15757\n",
      "SLIM_BPR_Recommender: Epoch 761 of 795. Elapsed time 10.77 min\n",
      "Processed 13650 (100.0%) in 1.69 sec. BPR loss is 2.16E+01. Sample per second: 8080\n",
      "SLIM_BPR_Recommender: Epoch 762 of 795. Elapsed time 10.79 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.10E+01. Sample per second: 9030\n",
      "SLIM_BPR_Recommender: Epoch 763 of 795. Elapsed time 10.80 min\n",
      "Processed 13650 (100.0%) in 1.36 sec. BPR loss is 2.08E+01. Sample per second: 10050\n",
      "SLIM_BPR_Recommender: Epoch 764 of 795. Elapsed time 10.81 min\n",
      "Processed 13650 (100.0%) in 1.16 sec. BPR loss is 2.15E+01. Sample per second: 11757\n",
      "SLIM_BPR_Recommender: Epoch 765 of 795. Elapsed time 10.83 min\n",
      "Processed 13650 (100.0%) in 0.97 sec. BPR loss is 2.23E+01. Sample per second: 14080\n",
      "SLIM_BPR_Recommender: Epoch 766 of 795. Elapsed time 10.84 min\n",
      "Processed 13650 (100.0%) in 1.77 sec. BPR loss is 2.14E+01. Sample per second: 7694\n",
      "SLIM_BPR_Recommender: Epoch 767 of 795. Elapsed time 10.85 min\n",
      "Processed 13650 (100.0%) in 1.63 sec. BPR loss is 2.13E+01. Sample per second: 8385\n",
      "SLIM_BPR_Recommender: Epoch 768 of 795. Elapsed time 10.87 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.17E+01. Sample per second: 9060\n",
      "SLIM_BPR_Recommender: Epoch 769 of 795. Elapsed time 10.88 min\n",
      "Processed 13650 (100.0%) in 1.34 sec. BPR loss is 2.13E+01. Sample per second: 10180\n",
      "SLIM_BPR_Recommender: Epoch 770 of 795. Elapsed time 10.90 min\n",
      "Processed 13650 (100.0%) in 1.19 sec. BPR loss is 2.24E+01. Sample per second: 11427\n",
      "SLIM_BPR_Recommender: Epoch 771 of 795. Elapsed time 10.91 min\n",
      "Processed 13650 (100.0%) in 1.04 sec. BPR loss is 2.17E+01. Sample per second: 13092\n",
      "SLIM_BPR_Recommender: Epoch 772 of 795. Elapsed time 10.93 min\n",
      "Processed 13650 (100.0%) in 0.87 sec. BPR loss is 2.09E+01. Sample per second: 15775\n",
      "SLIM_BPR_Recommender: Epoch 773 of 795. Elapsed time 10.94 min\n",
      "Processed 13650 (100.0%) in 1.68 sec. BPR loss is 2.12E+01. Sample per second: 8128\n",
      "SLIM_BPR_Recommender: Epoch 774 of 795. Elapsed time 10.95 min\n",
      "Processed 13650 (100.0%) in 1.51 sec. BPR loss is 2.17E+01. Sample per second: 9048\n",
      "SLIM_BPR_Recommender: Epoch 775 of 795. Elapsed time 10.97 min\n",
      "Processed 13650 (100.0%) in 1.30 sec. BPR loss is 2.08E+01. Sample per second: 10478\n",
      "SLIM_BPR_Recommender: Epoch 776 of 795. Elapsed time 10.98 min\n",
      "Processed 13650 (100.0%) in 1.10 sec. BPR loss is 2.21E+01. Sample per second: 12380\n",
      "SLIM_BPR_Recommender: Epoch 777 of 795. Elapsed time 10.99 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 2.12E+01. Sample per second: 14831\n",
      "SLIM_BPR_Recommender: Epoch 778 of 795. Elapsed time 11.01 min\n",
      "Processed 13650 (100.0%) in 1.79 sec. BPR loss is 2.16E+01. Sample per second: 7643\n",
      "SLIM_BPR_Recommender: Epoch 779 of 795. Elapsed time 11.02 min\n",
      "Processed 13650 (100.0%) in 1.62 sec. BPR loss is 2.18E+01. Sample per second: 8446\n",
      "SLIM_BPR_Recommender: Epoch 780 of 795. Elapsed time 11.04 min\n",
      "Processed 13650 (100.0%) in 1.49 sec. BPR loss is 2.17E+01. Sample per second: 9176\n",
      "SLIM_BPR_Recommender: Epoch 781 of 795. Elapsed time 11.05 min\n",
      "Processed 13650 (100.0%) in 1.40 sec. BPR loss is 2.13E+01. Sample per second: 9726\n",
      "SLIM_BPR_Recommender: Epoch 782 of 795. Elapsed time 11.07 min\n",
      "Processed 13650 (100.0%) in 1.27 sec. BPR loss is 2.16E+01. Sample per second: 10741\n",
      "SLIM_BPR_Recommender: Epoch 783 of 795. Elapsed time 11.08 min\n",
      "Processed 13650 (100.0%) in 1.09 sec. BPR loss is 2.24E+01. Sample per second: 12496\n",
      "SLIM_BPR_Recommender: Epoch 784 of 795. Elapsed time 11.09 min\n",
      "Processed 13650 (100.0%) in 0.92 sec. BPR loss is 2.20E+01. Sample per second: 14809\n",
      "SLIM_BPR_Recommender: Epoch 785 of 795. Elapsed time 11.11 min\n",
      "Processed 13650 (100.0%) in 1.73 sec. BPR loss is 2.12E+01. Sample per second: 7880\n",
      "SLIM_BPR_Recommender: Epoch 786 of 795. Elapsed time 11.12 min\n",
      "Processed 13650 (100.0%) in 1.57 sec. BPR loss is 2.15E+01. Sample per second: 8700\n",
      "SLIM_BPR_Recommender: Epoch 787 of 795. Elapsed time 11.13 min\n",
      "Processed 13650 (100.0%) in 1.37 sec. BPR loss is 2.17E+01. Sample per second: 9950\n",
      "SLIM_BPR_Recommender: Epoch 788 of 795. Elapsed time 11.15 min\n",
      "Processed 13650 (100.0%) in 1.17 sec. BPR loss is 2.22E+01. Sample per second: 11668\n",
      "SLIM_BPR_Recommender: Epoch 789 of 795. Elapsed time 11.16 min\n",
      "Processed 13650 (100.0%) in 1.01 sec. BPR loss is 2.20E+01. Sample per second: 13520\n",
      "SLIM_BPR_Recommender: Epoch 790 of 795. Elapsed time 11.18 min\n",
      "Processed 13650 (100.0%) in 0.85 sec. BPR loss is 2.16E+01. Sample per second: 16102\n",
      "SLIM_BPR_Recommender: Epoch 791 of 795. Elapsed time 11.19 min\n",
      "Processed 13650 (100.0%) in 1.66 sec. BPR loss is 2.20E+01. Sample per second: 8244\n",
      "SLIM_BPR_Recommender: Epoch 792 of 795. Elapsed time 11.20 min\n",
      "Processed 13650 (100.0%) in 1.48 sec. BPR loss is 2.20E+01. Sample per second: 9222\n",
      "SLIM_BPR_Recommender: Epoch 793 of 795. Elapsed time 11.22 min\n",
      "Processed 13650 (100.0%) in 1.35 sec. BPR loss is 2.11E+01. Sample per second: 10138\n",
      "SLIM_BPR_Recommender: Epoch 794 of 795. Elapsed time 11.23 min\n",
      "Processed 13650 (100.0%) in 1.31 sec. BPR loss is 2.11E+01. Sample per second: 10387\n",
      "SLIM_BPR_Recommender: Epoch 795 of 795. Elapsed time 11.25 min\n",
      "SLIM_BPR_Recommender: Terminating at epoch 795. Elapsed time 11.53 min\n",
      "Deallocating Cython objects\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.SLIM.Cython.SLIM_BPR_Cython import SLIM_BPR_Cython\n",
    "\n",
    "SLIM_BPR_Recommender = SLIM_BPR_Cython(urm_train_validation) \n",
    "SLIM_BPR_Recommender.fit(topK = 329, epochs = 795, symmetric = True, sgd_mode = 'sgd',\n",
    "                         lambda_i = 2.8500998459434748e-05, lambda_j =  0.000261455591654066,\n",
    "                         learning_rate = 0.000401116747319941)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4520656f",
   "metadata": {
    "papermill": {
     "duration": 0.577267,
     "end_time": "2022-01-07T14:05:50.449088",
     "exception": false,
     "start_time": "2022-01-07T14:05:49.871821",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**ITEM KNN CBF** MAP(locale) = 0.04 circa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "3a9f10aa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:05:51.620844Z",
     "iopub.status.busy": "2022-01-07T14:05:51.620211Z",
     "iopub.status.idle": "2022-01-07T14:06:00.822718Z",
     "shell.execute_reply": "2022-01-07T14:06:00.821982Z"
    },
    "papermill": {
     "duration": 9.790232,
     "end_time": "2022-01-07T14:06:00.822871",
     "exception": false,
     "start_time": "2022-01-07T14:05:51.032639",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Similarity column 18059 (100.0%), 2004.29 column/sec. Elapsed time 9.01 sec\n"
     ]
    }
   ],
   "source": [
    "from Recommenders.KNN.ItemKNNCBFRecommender import ItemKNNCBFRecommender\n",
    "\n",
    "ItemKNNCBFRecommender = ItemKNNCBFRecommender(urm_train_validation, icm_stacked_all ) \n",
    "ItemKNNCBFRecommender.fit(topK=36, shrink=715, similarity='cosine', normalize=True, feature_weighting = \"TF-IDF\",ICM_bias = 0.29068058416784676)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a574333d",
   "metadata": {
    "papermill": {
     "duration": 0.580995,
     "end_time": "2022-01-07T14:06:02.001332",
     "exception": false,
     "start_time": "2022-01-07T14:06:01.420337",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**HYBRIDATION**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "95955201",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:06:03.181304Z",
     "iopub.status.busy": "2022-01-07T14:06:03.180645Z",
     "iopub.status.idle": "2022-01-07T14:06:03.186566Z",
     "shell.execute_reply": "2022-01-07T14:06:03.187073Z"
    },
    "papermill": {
     "duration": 0.602148,
     "end_time": "2022-01-07T14:06:03.187267",
     "exception": false,
     "start_time": "2022-01-07T14:06:02.585119",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from Recommenders.BaseRecommender import BaseRecommender\n",
    "\n",
    "class ScoresHybridRecommender(BaseRecommender):\n",
    "    \"\"\" ScoresHybridRecommender\n",
    "    Hybrid of two prediction scores R = R1*alpha + R2*(1-alpha)\n",
    "\n",
    "    \"\"\"\n",
    "\n",
    "    RECOMMENDER_NAME = \"ScoresHybridRecommender\"\n",
    "\n",
    "    def __init__(self, urm_train, slimen, ials, userknncf, itemknncf, slimbpr, itemknncbf, lightfm, \n",
    "                rp3beta, p3alpha):\n",
    "        super(ScoresHybridRecommender, self).__init__(urm_train)\n",
    "\n",
    "        self.urm_train = sp.csr_matrix(urm_train)\n",
    "        self.slimen = slimen\n",
    "        self.ials = ials\n",
    "        self.userknncf = userknncf\n",
    "        self.itemknncf = itemknncf\n",
    "        self.slimbpr = slimbpr\n",
    "        self.itemknncbf = itemknncbf\n",
    "        self.lightfm = lightfm\n",
    "        self.rp3beta = rp3beta\n",
    "        self.p3alpha = p3alpha\n",
    "        \n",
    "    def fit(self, slimen_parm = 0.5, ials_param = 0.5, userknncf_param = 0.5, itemknncf_param = 0.5, slimbpr_param = 0.5,\n",
    "            itemknncbf_param = 0.5, lightfm_param = 0.5, rp3beta_param = 0.5, p3alpha_param = 0.5 ):\n",
    "        self.slimen_parm = slimen_parm\n",
    "        self.ials_param = ials_param\n",
    "        self.userknncf_param = userknncf_param\n",
    "        self.itemknncf_param = itemknncf_param\n",
    "        self.slimbpr_param = slimbpr_param\n",
    "        self.itemknncbf_param = itemknncbf_param\n",
    "        self.lightfm_param = lightfm_param\n",
    "        self.rp3beta_param = rp3beta_param\n",
    "        self.p3alpha_param = p3alpha_param\n",
    "        \n",
    "\n",
    "    def _compute_item_score(self, user_id_array, items_to_compute):\n",
    "        \n",
    "        # In a simple extension this could be a loop over a list of pretrained recommender objects\n",
    "        item_weights_1 = self.slimen._compute_item_score(user_id_array)\n",
    "        item_weights_2 = self.ials._compute_item_score(user_id_array)\n",
    "        item_weights_3 = self.userknncf._compute_item_score(user_id_array)\n",
    "        item_weights_4 = self.itemknncf._compute_item_score(user_id_array)\n",
    "        item_weights_5 = self.slimbpr._compute_item_score(user_id_array)\n",
    "        item_weights_6 = self.itemknncbf._compute_item_score(user_id_array)\n",
    "        item_weights_7 = self.lightfm._compute_item_score(user_id_array)\n",
    "        item_weights_8 = self.rp3beta._compute_item_score(user_id_array)\n",
    "        item_weights_9 = self.p3alpha._compute_item_score(user_id_array)\n",
    "        \n",
    "        \n",
    "        item_weights = item_weights_1*self.slimen_parm + item_weights_2*self.ials_param + item_weights_3*self.userknncf_param + item_weights_4*self.itemknncf_param + item_weights_5*self.slimbpr_param + item_weights_6*self.itemknncbf_param + item_weights_7*self.lightfm_param + item_weights_8*self.rp3beta_param + item_weights_9*self.p3alpha_param\n",
    "\n",
    "        return item_weights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "a5255d9f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:06:04.448449Z",
     "iopub.status.busy": "2022-01-07T14:06:04.447850Z",
     "iopub.status.idle": "2022-01-07T14:06:04.604844Z",
     "shell.execute_reply": "2022-01-07T14:06:04.604271Z"
    },
    "papermill": {
     "duration": 0.750713,
     "end_time": "2022-01-07T14:06:04.604984",
     "exception": false,
     "start_time": "2022-01-07T14:06:03.854271",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "recommender = ScoresHybridRecommender(urm_train_validation, SLIMElasticNetRecommender, IALSRecommender, UserKNNCFRecommender, \n",
    "                                                  ItemKNNCFRecommender, SLIM_BPR_Recommender, ItemKNNCBFRecommender,\n",
    "                                                  LightFMrecommender, RP3betaRecommender, P3alphaRecommender)\n",
    "recommender.fit(slimen_parm = 1.2, ials_param = 0.15, userknncf_param = 0.001, itemknncf_param = 0.001, \n",
    "                            slimbpr_param = 0.001, itemknncbf_param = 0.02, lightfm_param = 0.001, rp3beta_param = 0.05, p3alpha_param = 0.001)\n",
    "\n",
    "#result_df, _ = evaluator_validation.evaluateRecommender(recommender)\n",
    "#result_df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2ca7441",
   "metadata": {
    "papermill": {
     "duration": 0.586365,
     "end_time": "2022-01-07T14:06:05.783203",
     "exception": false,
     "start_time": "2022-01-07T14:06:05.196838",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**PREPARE SUBMISSION**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ce6f3987",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:06:07.011520Z",
     "iopub.status.busy": "2022-01-07T14:06:07.010626Z",
     "iopub.status.idle": "2022-01-07T14:06:07.019058Z",
     "shell.execute_reply": "2022-01-07T14:06:07.019667Z"
    },
    "papermill": {
     "duration": 0.648047,
     "end_time": "2022-01-07T14:06:07.019865",
     "exception": false,
     "start_time": "2022-01-07T14:06:06.371818",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def prepare_submission(users_to_recommend: np.array, recommender: object, urm_train):\n",
    "    \n",
    "    recommendation_length = 10\n",
    "    submission = []\n",
    "    for user_id in list(users_to_recommend):        \n",
    "        recommendations = recommender.recommend(user_id)\n",
    "        recommendations = recommendations[:10]\n",
    "                                    \n",
    "        \n",
    "        submission.append((user_id, [item_id for item_id in recommendations]))\n",
    "        \n",
    "    return submission"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "55caa153",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:06:08.279675Z",
     "iopub.status.busy": "2022-01-07T14:06:08.278991Z",
     "iopub.status.idle": "2022-01-07T14:06:08.301571Z",
     "shell.execute_reply": "2022-01-07T14:06:08.302059Z"
    },
    "papermill": {
     "duration": 0.655223,
     "end_time": "2022-01-07T14:06:08.302236",
     "exception": false,
     "start_time": "2022-01-07T14:06:07.647013",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "users_to_recommend = pd.read_csv(\n",
    "    \"../input/recommender-system-2021-challenge-polimi/data_target_users_test.csv\",\n",
    "    sep=\",\",\n",
    "    header=0,\n",
    "    dtype={\n",
    "        \"user_id\": np.int32\n",
    "    }\n",
    ")\n",
    "\n",
    "users_test = np.array(users_to_recommend['user_id'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2d14075b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:06:09.472709Z",
     "iopub.status.busy": "2022-01-07T14:06:09.472086Z",
     "iopub.status.idle": "2022-01-07T14:11:18.617115Z",
     "shell.execute_reply": "2022-01-07T14:11:18.618057Z"
    },
    "papermill": {
     "duration": 309.731805,
     "end_time": "2022-01-07T14:11:18.618383",
     "exception": false,
     "start_time": "2022-01-07T14:06:08.886578",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "submission = prepare_submission(users_to_recommend=users_test, \n",
    "                                recommender=recommender,\n",
    "                                urm_train=urm_train_validation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "1799ab3e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:11:19.841843Z",
     "iopub.status.busy": "2022-01-07T14:11:19.841183Z",
     "iopub.status.idle": "2022-01-07T14:11:19.842540Z",
     "shell.execute_reply": "2022-01-07T14:11:19.843338Z"
    },
    "papermill": {
     "duration": 0.585892,
     "end_time": "2022-01-07T14:11:19.843565",
     "exception": false,
     "start_time": "2022-01-07T14:11:19.257673",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import csv\n",
    "def write_submission(submissions):\n",
    "    header = ['user_id', 'item_list']\n",
    "    with open(\"./submission_07_01_final.csv\", \"w\") as f:\n",
    "        writer = csv.writer(f)\n",
    "        writer.writerow(header)\n",
    "        for user_id, items in submissions:\n",
    "            rec_items = ' '.join([str(item) for item in items])\n",
    "            row = [user_id, rec_items]\n",
    "            #f.write(f\"{user_id},{' '.join([str(item) for item in items])}\\n\")\n",
    "            writer.writerow(row)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9a4a93d9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-01-07T14:11:21.020141Z",
     "iopub.status.busy": "2022-01-07T14:11:21.019505Z",
     "iopub.status.idle": "2022-01-07T14:11:21.084862Z",
     "shell.execute_reply": "2022-01-07T14:11:21.084352Z"
    },
    "papermill": {
     "duration": 0.652988,
     "end_time": "2022-01-07T14:11:21.085004",
     "exception": false,
     "start_time": "2022-01-07T14:11:20.432016",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "write_submission(submission)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37843ac1",
   "metadata": {
    "papermill": {
     "duration": 0.589549,
     "end_time": "2022-01-07T14:11:22.260177",
     "exception": false,
     "start_time": "2022-01-07T14:11:21.670628",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 14446.976535,
   "end_time": "2022-01-07T14:11:23.878748",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2022-01-07T10:10:36.902213",
   "version": "2.3.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
